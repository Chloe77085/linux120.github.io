<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-peripherals-and-interfaces" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">外设与接口 | Linux 1.2.0</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://linux120.github.io/linux120.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://linux120.github.io/linux120.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://linux120.github.io/linux120.github.io/docs/peripherals-and-interfaces"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="外设与接口 | Linux 1.2.0"><meta data-rh="true" name="description" content="魔方派3外设与接口"><meta data-rh="true" property="og:description" content="魔方派3外设与接口"><link data-rh="true" rel="icon" href="/linux120.github.io/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linux120.github.io/linux120.github.io/docs/peripherals-and-interfaces"><link data-rh="true" rel="alternate" href="https://linux120.github.io/linux120.github.io/docs/peripherals-and-interfaces" hreflang="en"><link data-rh="true" rel="alternate" href="https://linux120.github.io/linux120.github.io/docs/peripherals-and-interfaces" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"外设与接口","item":"https://linux120.github.io/linux120.github.io/docs/peripherals-and-interfaces"}]}</script><link rel="alternate" type="application/rss+xml" href="/linux120.github.io/blog/rss.xml" title="Linux 1.2.0 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/linux120.github.io/blog/atom.xml" title="Linux 1.2.0 Atom Feed"><link rel="stylesheet" href="/linux120.github.io/assets/css/styles.b5462dde.css">
<script src="/linux120.github.io/assets/js/runtime~main.267ab752.js" defer="defer"></script>
<script src="/linux120.github.io/assets/js/main.622d3578.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/linux120.github.io/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/linux120.github.io/"><div class="navbar__logo"><img src="/linux120.github.io/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/linux120.github.io/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/linux120.github.io/docs/peripheral-compatibility-list">Tutorial</a><a class="navbar__item navbar__link" href="/linux120.github.io/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/peripheral-compatibility-list">外设兼容列表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/revision-history">文档更新说明</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/linux120.github.io/docs/quick-start/">快速入门</a><button aria-label="Expand sidebar category &#x27;快速入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/linux120.github.io/docs/peripherals-and-interfaces">外设与接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/linux-kernel">Linux 内核</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/qualcomm-ai-hub">Qualcomm AI Hub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/ai-developer-workflow">AI 开发者工作流程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/qualcomm-im-sdk">Qualcomm IM SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/lvgl-user-guide">LVGL 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/qt5-user-guide">QT5 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/tools-and-libraries-porting-guide">工具&amp;库移植指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/ros-user-guide">ROS 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/yocto-project-user-guide">Yocto 工程编译指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/user-guide-to-rubikpi-config">rubikpi_config 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/gitHub-operation-guide">GitHub操作指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/linux120.github.io/docs/set-up-development-environment">开发环境搭建</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/linux120.github.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">外设与接口</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>外设与接口</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="硬件资源图">硬件资源图<a href="#硬件资源图" class="hash-link" aria-label="Direct link to 硬件资源图" title="Direct link to 硬件资源图">​</a></h2>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-98-20dc27f46f7587e5dc5caa94aa151a5e.jpg" width="1000" height="422" class="img_ev3q"></p>
<table><thead><tr><th>序号</th><th>接口</th><th>序号</th><th>接口</th></tr></thead><tbody><tr><td>1</td><td>RTC 电池接口</td><td>10</td><td>电源 Type-C 接口</td></tr><tr><td>2</td><td>Micro USB (UART 调试)</td><td>11</td><td>PWR 按键</td></tr><tr><td>3</td><td>TurboX C6490P SOM</td><td>12</td><td>EDL 按键</td></tr><tr><td>4</td><td>3.5mm 耳机接口</td><td>13</td><td>摄像头接口 2</td></tr><tr><td>5</td><td>USB Type-C with DP (USB 3.1)</td><td>14</td><td>摄像头接口 1</td></tr><tr><td>6</td><td>USB Type-A (USB 2.0)</td><td>15</td><td>Wi-Fi/蓝牙模块</td></tr><tr><td>7</td><td>2 x USB Type-A (USB 3.0)</td><td>16</td><td>风扇接口</td></tr><tr><td>8</td><td>1000M 以太网</td><td>17</td><td>40-pin 连接器</td></tr><tr><td>9</td><td>HDMI OUT</td><td>18</td><td>M.2 Key M 接口</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="40-pin-连接器">40 pin 连接器<a href="#40-pin-连接器" class="hash-link" aria-label="Direct link to 40 pin 连接器" title="Direct link to 40 pin 连接器">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpio">GPIO<a href="#gpio" class="hash-link" aria-label="Direct link to GPIO" title="Direct link to GPIO">​</a></h3>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 来对 GPIO 进行控制和编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布">引脚分布<a href="#引脚分布" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-93-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<p>下表是 40-pin连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-92-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令控制">使用 shell 命令控制<a href="#使用-shell-命令控制" class="hash-link" aria-label="Direct link to 使用 shell 命令控制" title="Direct link to 使用 shell 命令控制">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面的步骤控制 GPIO。</p>
<ul>
<li>
<p>使用 WiringRP 相关命令</p>
<ul>
<li>
<p>查看 GPIO 状态</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio readall</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-102-3eec48065a6bcceabe0640e9469ce951.jpg" width="750" height="483" class="img_ev3q"></p>
<ul>
<li>
<p>设置 GPIO 模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio mode 15 in             # 将15号引脚模式置为输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio pins                   # 查看更改之后的状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio mode 15 out            # 将15号引脚模式置为输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio pins                   # 查看更改之后的状态</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置引脚电平</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio write 15 1             # 将15号引脚置为高电平</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio read 15                # 读取更改后引脚状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio write 15 0             # 将15号引脚置为低电平</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio read 15                # 读取更改后引脚状态</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>操作 <em>/sys/class/gpio</em> 下相关节点</p>
<p>GPIO 子系统的编号如下表。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-265-dd4b7eb7fbad5f1d5781f3e96373a5e1.jpg" width="875" height="886" class="img_ev3q"></p>
<ul>
<li>进入 /sys/class/gpio 目录：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/class/gpio</span><br></span></code></pre></div></div>
<ul>
<li>将要控制的 GPIO 导出，如控制 13 号引脚 GPIO_24：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 559 &gt; export</span><br></span></code></pre></div></div>
<ul>
<li>进入到 gpio559 目录设置 GPIO 属性：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd gpio559</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-241-b44227cb09fde2fdfd10700b17018fe3.jpg" width="638" height="172" class="img_ev3q"></p>
<ul>
<li>direction（方向）：<!-- -->
<ul>
<li>输入：in</li>
<li>输出：out</li>
</ul>
</li>
<li>value（值）：<!-- -->
<ul>
<li>低电平：0</li>
<li>高电平：1</li>
</ul>
</li>
<li>edge （中断边沿）：<!-- -->
<ul>
<li>上升沿触发：rising</li>
<li>下降沿触发：falling</li>
<li>双边沿触发：both</li>
<li>禁用中断：none</li>
</ul>
</li>
</ul>
<p>如设置 13 号引脚输出高电平：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo out &gt; direction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; value</span><br></span></code></pre></div></div>
<p>取消导出 13 号引脚到用户空间：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 559 &gt; unexport</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-控制">使用 WiringRP (C) 控制<a href="#使用-wiringrp-c-控制" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) 控制" title="Direct link to 使用 WiringRP (C) 控制">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>以下代码示例，将 13 号引脚设置为输出， 15 号引脚设置为输入，循环检测 15 号引脚的电平状态：</li>
</ul>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pinMode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pinMode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> INPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">digitalRead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// mS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LOW</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">digitalRead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1900</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<ul>
<li>
<p>在 RUBIK Pi 3 中编译程序</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc gpio.c -o gpio -lwiringPi</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155538-3-8999a3f48867f5dacf81a22aff194792.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./gpio</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCADGARQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDCt7SwudHQada211diFjMsk7pMrDOSi5CsAOe5q3Z/YptJ8PWd7ZLOtzLLGJPMZWjzIBkYOD17g9Kwo9c1GK2FvFMiIE8sMsKBwvTG/G79agTUbtBaBZcCzYvB8o+Qk5z055HetOpu07EsWnxSXtxbyX9vbCFioafdhsHHG1TVjw/qMWl3V00k9xCZYDEk1uoZkJYHcASOwPfvWVLI80ryyHLuxZj6k1YsdQubBna2aMbwAweJJAfwYGkttSpK5a8QQ3SaijXN496Z4kkimfO50I4yDyD7VQiY2t0rSwK5jbmOUHB9iODUs2o3k9+t9LOzXKsGVzjgjpgdBj0pJr+6uNRa/nkElyz72Z0Ugn3XGPwximgNzWy95rOkk28ErzWcP7pj5UZJB44IwPxFbXiqMQ6NeiOyskVp0hVlust5cSgAgbzyCcYx7kd65K613Ubx4HnkhLW5BiK28aFcdBwoyB6HiqtzfXN1GkdxLvVHdwMAfMxyx49aTQktUV6cEcxmQI2wHBbHAP1ptWU1C7TTpNPSYi1kcSPHgYLDoc9aZRoeHB9ma81VuljATGf+mrfKn8yfwp1pBZWuhpqV3Zi8knuGhVHkZVQKASTtIJJz69qqNfRLoCafCriR5zLOxAwcDCAfTLH8at6DqsOnwSJPdXcas4byo7eOVGx3+c/KfcCjqS7l+507TbC7152sVnjsnjWGJ5HAG44OSCCfzqOOK00/xDpc1va5ivY4pVjeVw0BZsHDKQexxnsaZ/wk7CbWbmNDHPfujRgosiqA2SGDcHj2rEur66vLv7XcTM8/GH6Yx0xjpj2pR6XE03c1bfT4bzxbdWs/mGGOWZ2UMSzhNx25POTjrTL6CyudCGp2lp9jdLnyGjWRnVwVyCN2TkY5+oqrca1qNzdxXctxi4hO5JERUbPqSoGT9ajv9VvdRCLdzBljyVRUVFBPU4UAZ96STskVre5ToooqhhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAG1Ba6bL4YvbhI5mvIDFmR2wq7mIIUDr06n8hWLWxZapp9tpFxYy6fPI9xtMki3QUZUkjA2HHX1rHo6iQUUUUDCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDoIPDDTWsRN0Vu5ovNSLySUwQWVS+cBiASBiufrrrbW7JXtdQe/lR7eBVexCNiSVEKK2fu4xjrz1rkScnNLqyY3tqFFFFMoKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKALS6betp76gLd/skbBWlPAyew9fwqrXUabY6rdeEtRP2e7mjbyfI+VmBVWbO32HtXL0dbCTuFFFFAwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKK76zlt0nsNG/e+RPaoxiCr5Tq0ZZ3bvuDdD2xXAnqcUdbCTugooooGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAGhHrepRWP2JLoiHaUA2ruCnqobGQPYHFZ9bUFrpsvhi9uEjma8gMWZHbCruYghQOvTqfyFYtHUSCiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAbFlqmn22kXFjLp88j3G0ySLdBRlSSMDYcdfWseugg8MNNaxE3RW7mi81IvJJTBBZVL5wGIBIGK5+jqJW6BRRRQMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAOuttbsle11B7+VHt4FV7EI2JJUQorZ+7jGOvPWuRJyc1aXTb1tPfUBbv9kjYK0p4GT2Hr+FVaOokrIKKKKBhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB1Gm2Oq3XhLUT9nu5o28nyPlZgVVmzt9h7Vy9FFHUSQUUUUDCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDvrOW3Sew0b975E9qjGIKvlOrRlndu+4N0PbFcCepxWhHrepRWP2JLoiHaUA2ruCnqobGQPYHFZ9Lq2TFWQUUUUygooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA2oLXTZfDF7cJHM15AYsyO2FXcxBCgdenU/kKxa2LLVNPttIuLGXT55HuNpkkW6CjKkkYGw46+tY9HUSCiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAdBB4Yaa1iJuit3NF5qReSSmCCyqXzgMQCQMVz9ddba3ZK9rqD38qPbwKr2IRsSSohRWz93GMdeetciTk5pdWTG9tQoooplBRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVbubBrfTrO8MgK3W/CgcrtOKKKBFSiiigYUUUUAFFFFAGl4b/wCRm0r/AK/If/QxR/wkGt/9BnUf/Ap/8aKKBdR3iOR5tUWWV2eR7S2ZmY5LEwR5JPc1l0UUAtgooooGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB//9k=" width="276" height="198" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-控制">使用 WiringRP-Python 控制<a href="#使用-wiringrp-python-控制" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python 控制" title="Direct link to 使用 WiringRP-Python 控制">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>下方截取代码是使用 WiringRP 库操作 GPIO 的示例，其中将 13 号引脚设置为输出，15 号引脚设置为输入，循环检测 15 号引脚的电平状态。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> wiringpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>gpio.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155538-2-8999a3f48867f5dacf81a22aff194792.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 gpio.py </span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="287" height="160" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序控制">使用 Python 程序控制<a href="#使用-python-程序控制" class="hash-link" aria-label="Direct link to 使用 Python 程序控制" title="Direct link to 使用 Python 程序控制">​</a></h4>
<ul>
<li>
<p>使用 Python 的 periphery 库控制 GPIO，需先在 RUBIK Pi 3 中使用下面命令安装 python-periphery：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install python-periphery </span><br></span></code></pre></div></div>
</li>
<li>
<p>下方截取代码是使用 periphery 库操作 GPIO 的示例，其中将 13 号引脚设置为输出，15 号引脚设置为输入，循环检测 15 号引脚的电平状态。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> periphery </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GPIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">559</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">560</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;in&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> KeyboardInterrupt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> IOError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>gpio.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155538-1-8999a3f48867f5dacf81a22aff194792.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 gpio.py </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-110-c06a6e2da81a44494996e4eae822f9f1.jpg" width="277" height="161" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序控制">使用 C 语言程序控制<a href="#使用-c-语言程序控制" class="hash-link" aria-label="Direct link to 使用 C 语言程序控制" title="Direct link to 使用 C 语言程序控制">​</a></h4>
<ul>
<li>
<p>以下代码示例将 13 号引脚设置为输出，15 号引脚设置为输入，循环检测 15 号引脚的电平状态：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> out_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">559</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> in_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">560</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> export_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/export&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> direction_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/direction&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO direction file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/direction&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    direction_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO direction file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;in&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> value_in_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> value_out_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> cat_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_in_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_in_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cat %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value_in_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">value_out_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO value file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> unexport_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/unexport&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译，具体可参考 <a href="/linux120.github.io/docs/set-up-development-environment#%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">交叉编译工具使用方法</a>章节：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc gpio.c -o gpio --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
<p>若使用了交叉编译，需将 gpio 传输到 RUBIK Pi 3 中，如使用 ADB 传输：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc gpio.c -o gpio</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155538-8999a3f48867f5dacf81a22aff194792.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./gpio</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCADGARQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDCt7SwudHQada211diFjMsk7pMrDOSi5CsAOe5q3Z/YptJ8PWd7ZLOtzLLGJPMZWjzIBkYOD17g9Kwo9c1GK2FvFMiIE8sMsKBwvTG/G79agTUbtBaBZcCzYvB8o+Qk5z055HetOpu07EsWnxSXtxbyX9vbCFioafdhsHHG1TVjw/qMWl3V00k9xCZYDEk1uoZkJYHcASOwPfvWVLI80ryyHLuxZj6k1YsdQubBna2aMbwAweJJAfwYGkttSpK5a8QQ3SaijXN496Z4kkimfO50I4yDyD7VQiY2t0rSwK5jbmOUHB9iODUs2o3k9+t9LOzXKsGVzjgjpgdBj0pJr+6uNRa/nkElyz72Z0Ugn3XGPwximgNzWy95rOkk28ErzWcP7pj5UZJB44IwPxFbXiqMQ6NeiOyskVp0hVlust5cSgAgbzyCcYx7kd65K613Ubx4HnkhLW5BiK28aFcdBwoyB6HiqtzfXN1GkdxLvVHdwMAfMxyx49aTQktUV6cEcxmQI2wHBbHAP1ptWU1C7TTpNPSYi1kcSPHgYLDoc9aZRoeHB9ma81VuljATGf+mrfKn8yfwp1pBZWuhpqV3Zi8knuGhVHkZVQKASTtIJJz69qqNfRLoCafCriR5zLOxAwcDCAfTLH8at6DqsOnwSJPdXcas4byo7eOVGx3+c/KfcCjqS7l+507TbC7152sVnjsnjWGJ5HAG44OSCCfzqOOK00/xDpc1va5ivY4pVjeVw0BZsHDKQexxnsaZ/wk7CbWbmNDHPfujRgosiqA2SGDcHj2rEur66vLv7XcTM8/GH6Yx0xjpj2pR6XE03c1bfT4bzxbdWs/mGGOWZ2UMSzhNx25POTjrTL6CyudCGp2lp9jdLnyGjWRnVwVyCN2TkY5+oqrca1qNzdxXctxi4hO5JERUbPqSoGT9ajv9VvdRCLdzBljyVRUVFBPU4UAZ96STskVre5ToooqhhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAG1Ba6bL4YvbhI5mvIDFmR2wq7mIIUDr06n8hWLWxZapp9tpFxYy6fPI9xtMki3QUZUkjA2HHX1rHo6iQUUUUDCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDoIPDDTWsRN0Vu5ovNSLySUwQWVS+cBiASBiufrrrbW7JXtdQe/lR7eBVexCNiSVEKK2fu4xjrz1rkScnNLqyY3tqFFFFMoKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKALS6betp76gLd/skbBWlPAyew9fwqrXUabY6rdeEtRP2e7mjbyfI+VmBVWbO32HtXL0dbCTuFFFFAwooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKK76zlt0nsNG/e+RPaoxiCr5Tq0ZZ3bvuDdD2xXAnqcUdbCTugooooGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAGhHrepRWP2JLoiHaUA2ruCnqobGQPYHFZ9bUFrpsvhi9uEjma8gMWZHbCruYghQOvTqfyFYtHUSCiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAbFlqmn22kXFjLp88j3G0ySLdBRlSSMDYcdfWseugg8MNNaxE3RW7mi81IvJJTBBZVL5wGIBIGK5+jqJW6BRRRQMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAOuttbsle11B7+VHt4FV7EI2JJUQorZ+7jGOvPWuRJyc1aXTb1tPfUBbv9kjYK0p4GT2Hr+FVaOokrIKKKKBhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB1Gm2Oq3XhLUT9nu5o28nyPlZgVVmzt9h7Vy9FFHUSQUUUUDCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDvrOW3Sew0b975E9qjGIKvlOrRlndu+4N0PbFcCepxWhHrepRWP2JLoiHaUA2ruCnqobGQPYHFZ9Lq2TFWQUUUUygooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA2oLXTZfDF7cJHM15AYsyO2FXcxBCgdenU/kKxa2LLVNPttIuLGXT55HuNpkkW6CjKkkYGw46+tY9HUSCiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAdBB4Yaa1iJuit3NF5qReSSmCCyqXzgMQCQMVz9ddba3ZK9rqD38qPbwKr2IRsSSohRWz93GMdeetciTk5pdWTG9tQoooplBRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVbubBrfTrO8MgK3W/CgcrtOKKKBFSiiigYUUUUAFFFFAGl4b/wCRm0r/AK/If/QxR/wkGt/9BnUf/Ap/8aKKBdR3iOR5tUWWV2eR7S2ZmY5LEwR5JPc1l0UUAtgooooGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB//9k=" width="276" height="198" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="i2c">I2C<a href="#i2c" class="hash-link" aria-label="Direct link to I2C" title="Direct link to I2C">​</a></h3>
<p>I2C 是飞利浦公司在 20 世纪 80 年代开发的一种双向 2 线制总线，用于实现高效的 IC 间控制总线。总线上的每个设备都有其唯一的地址（由飞利浦公司领导的 I2C 总机构注册）。I2C 核心支持多控制器模式，以及 10 位目标地址和 10 位可扩展地址。关于 I2C 的更多信息，请参阅 <a href="https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf%E3%80%82" target="_blank" rel="noopener noreferrer">https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf。</a></p>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi ）。推荐使用 WiringRP 对 I2C 进行控制和编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-1">引脚分布<a href="#引脚分布-1" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-107-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>3 号引脚和 5 号引脚默认已设置配为 I2C1。</p></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-106-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令测试">使用 shell 命令测试<a href="#使用-shell-命令测试" class="hash-link" aria-label="Direct link to 使用 shell 命令测试" title="Direct link to 使用 shell 命令测试">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面步骤控制 I2C 总线。</p>
<ul>
<li>
<p>使用 WiringRP 相关命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./gpio -x ads1115:100:10 aread 100     #通过 I2C 总线读取 ADS1115 设备的模拟信号值</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用 i2cdetect 工具</p>
<ul>
<li>
<p>查看 I2C1 接口上的设备：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cdetect -a -y -r 1</span><br></span></code></pre></div></div>
</li>
<li>
<p>读取地址为 0x38 设备的全部寄存器：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cdump -f -y 1 0x38</span><br></span></code></pre></div></div>
</li>
<li>
<p>向地址为 0x38 设备的 0x01 寄存器地址写入 0xaa：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cset -f -y 1 0x38 0x01 0xaa</span><br></span></code></pre></div></div>
</li>
<li>
<p>读取地址为 0x38 的设备，寄存器地址为0x01处的数值：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cget -f -y 1 0x38 0x01</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-i2c-通信">使用 WiringRP (C) I2C 通信<a href="#使用-wiringrp-c-i2c-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) I2C 通信" title="Direct link to 使用 WiringRP (C) I2C 通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPiI2C.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">I2C_ADDRESS</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">0x38</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wiringPiI2CSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_ADDRESS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">wiringPiI2CWriteReg8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译程序</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc i2c.c -o i2c -lwiringPi</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155532-2-fe85f70c432e3f563d1efc4644170b7a.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令运行程序：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./i2c</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-i2c-通信">使用 WiringRP-Python I2C 通信<a href="#使用-wiringrp-python-i2c-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python I2C 通信" title="Direct link to 使用 WiringRP-Python I2C 通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，使用 I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi as wpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSetup()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd=wpi.wiringPiI2CSetup(0x38, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiI2CWriteReg8 (fd, 0x01, 0xaa)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将<em> i2c.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155532-3-fe85f70c432e3f563d1efc4644170b7a.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 i2c.py </span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-i2c-通信">使用 Python 程序 I2C 通信<a href="#使用-python-程序-i2c-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 I2C 通信" title="Direct link to 使用 Python 程序 I2C 通信">​</a></h4>
<ul>
<li>
<p>使用 Python 的 smbus 库控制 I2C，需先在 RUBIK Pi 3 中使用下面命令安装 smbus 库：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install smbus</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例，使用 I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> smbus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i2c_bus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> smbus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SMBus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;i2cdetect addr : &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> address </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x7F</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                i2c_bus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write_i2c_block_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;0x{:02X},&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> OSError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i2c_bus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            i2c_bus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>i2c.py </em>传输到 RUBIK Pi 3中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155532-1-fe85f70c432e3f563d1efc4644170b7a.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 i2c.py </span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="231" height="58" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-i2c-通信">使用 C 语言程序 I2C 通信<a href="#使用-c-语言程序-i2c-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 I2C 通信" title="Direct link to 使用 C 语言程序 I2C 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdint.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/i2c-dev.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">I2C_DEVICE_PATH</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;/dev/i2c-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">i2c_device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> I2C_DEVICE_PATH</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i2c_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open I2C device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_TENBIT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_RETRIES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;i2cdetect addr : &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x7f</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> x</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_SLAVE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set I2C slave address&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;0x%x,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\r\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译，具体可参考 <a href="/linux120.github.io/docs/set-up-development-environment#%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">交叉编译工具使用方法</a> 章节：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc i2c.c -o i2c --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
<p>若使用的交叉编译，需要将 <em>i2c </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc i2c.c -o i2c</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155532-fe85f70c432e3f563d1efc4644170b7a.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./i2c</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="234" height="58" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi">SPI<a href="#spi" class="hash-link" aria-label="Direct link to SPI" title="Direct link to SPI">​</a></h3>
<p>串行外设接口 (SPI) 是在全双工模式下工作的同步串行数据链路。SPI 又称为 4 线制串行总线。</p>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 对 SPI 进行控制和编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-2">引脚分布<a href="#引脚分布-2" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-120-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>19 号、21 号、23 号、24 号引脚默认已设置配为 SPI。</p></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-119-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-spi-通信">使用 WiringRP (C) SPI 通信<a href="#使用-wiringrp-c-spi-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) SPI 通信" title="Direct link to 使用 WiringRP (C) SPI 通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例使用 SPI 总线进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPiSPI.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> read_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wiringPiSPISetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Send and receive data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSPIDataRW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译程序</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc spi.c -o spi -lwiringPi</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155529-1-ebda72d74fd3eac3f07abfc02a5de947.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./spi</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="174" height="104" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-spi通信">使用 WiringRP-Python SPI通信<a href="#使用-wiringrp-python-spi通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python SPI通信" title="Direct link to 使用 WiringRP-Python SPI通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例使用 SPI 总线进行数据收发通信：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi as wpi                                                          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSetup()                                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSPISetup(0, 8000000)                                                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_buffer = bytes([72, 101, 108, 108, 111])                                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;tx_buffer:\n\r &quot;, tx_buffer)                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">retlen, rx_buffer = wpi.wiringPiSPIDataRW(0, tx_buffer)                         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;rx_buffer:\n\r &quot;, rx_buffer)                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><br></span></code></pre></div></div>
</li>
<li>
<p>将<em> spi.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155529-3-ebda72d74fd3eac3f07abfc02a5de947.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> python3 spi.py </span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="266" height="107" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-spi-通信">使用 Python 程序 SPI 通信<a href="#使用-python-程序-spi-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 SPI 通信" title="Direct link to 使用 Python 程序 SPI 通信">​</a></h4>
<ul>
<li>
<p>使用 Python 的 spidev 库进行 SPI 通信，需先在 RUBIK Pi 3 中使用下面命令安装spidev 库：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install spidev</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例使用 SPI 总线进行数据收发通信：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">char</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> char </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spidev</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SpiDev</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max_speed_hz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xfer2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tx_buffer:\n\r&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;rx_buffer:\n\r&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> spi</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>spi.py </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155529-2-ebda72d74fd3eac3f07abfc02a5de947.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> python3 spi.py </span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="204" height="89" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-spi-通信">使用 C 语言程序 SPI 通信<a href="#使用-c-语言程序-spi-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 SPI 通信" title="Direct link to 使用 C 语言程序 SPI 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例使用 SPI 总线进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdint.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/spi/spidev.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">SPI_DEVICE_PATH</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;/dev/spidev12.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> spi_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Open the SPI device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPI_DEVICE_PATH</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open SPI device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Configure SPI mode and bits per word</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> mode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SPI_MODE_0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_MODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set SPI mode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_BITS_PER_WORD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">bits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set SPI bits per word&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Perform SPI transfer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">spi_ioc_transfer</span><span class="token plain"> transfer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">rx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delay_usecs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">speed_hz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// SPI speed in Hz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bits_per_word </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SPI_IOC_MESSAGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">transfer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to perform SPI transfer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">/* Print tx_buffer and rx_buffer*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rrx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Close the SPI device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译，具体可参考 <a href="/linux120.github.io/docs/set-up-development-environment#%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">交叉编译工具使用方法</a>章节：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc spi.c -o spi --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
<p>若使用交叉编译，需要将 spi 传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">o spi</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155529-ebda72d74fd3eac3f07abfc02a5de947.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./spi</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCABoAK4DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDkrbSZLyKe7e5t7W3jl8syTlsFjk4AUE9Kt6VptvcabrCy3FqrQGIR3Lltg+cgkEAnn6UzSNQt7CScy3l9AzPykMSSRyL6MrED+dNm1WzaDWIre2aBL14zDGuNqBWyc+n4VZur2KGo2E2nXZt5yjHaHVozlXUjIIPoRRplqt5qlraSFlWaZUYjggEgGrWoaqZbuyubF5YZLa2ji39CGUYJGD0qs9219fifVri4lDcPIDufGOMZprceti1rtlb2MwhisNQtXDHm7cHevYgBF/rWVWvqOoWbaRBplibmSOOVpTLcAKQSANqgE4HGetU71tPaC1FjHOkojxcGQghn9Vx2pIZcvNMsofD8N/bXbzzNP5UnybUX5d2Bnk/XitKx8M2Etjb3FxqsI3xyzPs3gBFGBjKdd2Qf0zVF7vSf+EbGnpNem4Evn5MCBN20DbnfnHvj8KvHxWiacbeG2h3raJAha0iI3bsvnjofTuecZofW39af5k66HLkYJAIOO470lKTkknHPoMVa01tPSeQ6nHPJEY2CCEgEP2Jz2plleCJ5544YhueRgqj1JOBWxd6VHc6/cWGmeXHFbIQ8judvyD53PU9c9Kb4aUQ3c+puPk0+FpRnvIflQf8AfRB/Cqel3KW+oC4nubuAjJEttguG/EjI/GgnuSxaQ1xqkNhaXlpcPMMiRGbYOp5yoPb0outHe3jhnF5azWssnl/aImYojejDbuHHPT6Vu6bf2d/4t0xoI5CUR1mmeNY3mO1uSq8A4496x76+sE0gabpouWRp/PkknCqcgYAABPHJ5zSDW43xDZwWV1bLbJEsclskgaORnD5zlvmAIzjpisqtbUb2wvtOtCftKXtvAsG3apjYKTznOeh6YrJp9xrZBRRRQMKKKKACiiigDVstDv8AVEvJ7S3lkS3yfljZt5yBtGB15zj0qjLZXcPm+bazp5BAl3RkeWT03emfetbQ5ELaraNcxwPc25SJpZNilg6nBJ4HANP0V49Jvbu4vriCeGJPLkt0lVxdFuijrkDqW7YpEJuxhSwywlRNE8ZdQy71Iyp6Ee1XNEsF1PVoLJ3ZBLnlRk8An+lSeImWXV5LmO6W5juAJUYEZVT0UgdCOmPapPCs0dv4itJZpUiRS2XdtoXKkDntQtUU9ijPYXtvNHDPZ3EUsn3EeJlZvoCOajNtOFlYwSBYmCyHYcIT0B9DwfyrpPtSadYWMF9exXU6agtx+6lEvlRjr8wyMk9ge1GpJDbaXrRF9ZzfbLqOSARTqzMoZiSVHI6jrRf+vu/r5CuVn8MT22kLfX4vYWdGcItkzKgBwN7ZG3P48Ulj4YuJ9KGoXS3kUTsRGIrNpSVAzuPIwvPX61X1i5WXS9IRJw7JbMsih8lT5jHB9OMUT3KnwpZwrOPNW6lLIH+YKVTBI9ODQ+v9dQV9CjBY3d0sj2lrPPHH9544iwA98dKba2V3esVs7We4ZeoijLkflXVaZfQnRtNFn/Z/n2ZYut1dvAVfdkMMOobIx6njFZi34bRNYbzY4Z7i7icRxvjI+fO0dSBkfpQ9ATbMf7Hdfa/sn2ab7Tnb5Ow78+m3rUTAqxVgQQcEHtV/RmmbWbdo9QWylLcXMjYCcdSf0qncbvtMu6UStvOZAc7znr+NMZHRRRQMKKKKACiiigAooooAKKKKAHzf65/941LDZzT2dzdJt8q22+Zk8/McDFRTf65/941u6DctaaDrUyRwyECD5Zow6/fPY8UdCehk2N/JYlzHFbSb8Z8+3SXH03A4qeS5udYkjthDYRtkkFIorcHju2APzNdFBp+ny6y87W6qTpqXaQRw+YvmEDOI8jIHJ25rG8QS2EotWtInScKwmY2ot1fnghASM9QcUutmCd9jPuNPubbUDYToqXAYKVMi4BPT5s4xz1zRf6fdadMsV2iqzoJF2yK4KnoQVJHatHxfHIPEFzIUYIwj2tjg/Ivena/EzrpMhVhEbCIF8cDkg801sgTMKiuzvbOE3Oq2DabBDY2ls0kFwsWHyANjF/4t3ofXiuMpJjTuFFdfa6Fa6ppthOMRTTQeVCqADzZldi271+UD8SKS5WGCC7vdM022uXk1GSEq0AkWJBjaAvQZ559qb3sLmucjVmwsLjUbjyLURmQjIDyrHnnHBYgE89K6R7SzsdZ1ww2sDi1tRJHHKokWNyUyMHrgsRzWLZ3bXXiCymkjgiPnxgiKJY1+8OwAFEdWkDejaM+aKSCeSGVdskbFWGc4IODUps5hpy3xC+S0piHPO4AHp9CK3bexWbxtcxXluWUzTskTggSsNxVffJxRq081x4St2ntYbZxfuuyKERD7i9h3qU/duN/FY52SGWJUaWJ0Ei7kLKRuHTI9RTK2NddnstHDRSIEswuXQqG+djkZ6jBHIrHqgWwUUUUDCiiigAooooAfN/rn/wB40LNKkTxJI6xyY3qGIDY6ZHetaxsrF7G/v7/7QyQTJGscDqpJbdzkg/3fSk0rTrPWL+aytTPFNIM2nmMGGRyVfA7jPIxijyJTVjN+1XPmxy/aJfMiAVH3nKAdAD2xTp7m91GZTcT3F1LjCl3Z2x6DNSatb29pqElratKyw/I7ScbnH3iBjgZ6A81e8H4/4Sez3Zxl84/3DS31G9FczJr27ngjgnup5IY/uRvISq/QHgUG9uzafZDdT/Zgc+T5h2Z/3elbCaVp17FaXNi10kL3iWsyTMpYbuQykADpnjHFV5NLgSz1eYPJusbhIoxkYILMDnjr8oo/r8v8wuig99eSWq2sl3O9un3YmkJQfQdKr112o6lbWPh2wt7Bb6AXNu7YW4TaxLsDvGz5unqOMUlpqFrpnhK3ltkvoZZp3V3huEUswVep2HK8/d+vND6iT2OYS6uY/K8u4lXyWLR7XI2E9SPQ8DpS217d2ju9rdTwM4wxjkKlvrjrXQaf4etprG1ur+Vs3hLArdQxCJd2NxDnLcgnAx9ap22mWEVtqNzfSTTx2c6wr9mdV8zO75skHj5f1phdMyFnmTzNksi+aNsmGI3jOcH15qPp0q7bDTJNVUXBuYdPLfMQQ0ijH0wefaqkvliVxEWMe47Sw5I7ZoKJri/vLl43ubueZo/uGSQsV+melLdahe3oUXl5cXAT7ollZ8fTJqtRQIklnmmWNZZZHWNdqBmJCj0HoKjoooGFFFFABRRRQAUUUUAXDfSxWl3YqqeVPKrsSDuBXOMfmaba381pbXEMARTcKFaXB3he6g54B7/SoJv9c/8AvGtjRLC3vdI1VppIIXjEWyabOEy3PQE8/SgnRIgeQ65cGa8vLK0lSNVZ5RIDMRxuO0N83TJ4p0R/sO8gvrPULG8lRjhIxIQOCOdyrxz2NNbQrxdRezZoRsjEzTb/AN2IyAQ+fTkds02ay/sqa3nnW2v7aYEoUd/LfHBHG1gQfpQAXWtTzxwxQQ29nDDJ5qx26kDf/eJJJJ/Gpb7X5r21ngNnZw/aXWSaSJGDSMM4JyxA6noBSa/BbWHiOaKC2X7PGyEQlmIIKgkZznHPrS+Ibe2insns7Zbdbi0jlaNGZgGOc43En9aXT+v66ArXKN1fS3VvawSKgW1jMaFQckFi3P4mh76V9NisCqeVFK0qkA7ssADn24FXrjw9dwQysZrZ54E8ya2SQmWNfUjGOMjOCcVkUxqxp22tSRWUdpcWdpeRREmL7QhJjzyQCpBxnsc1WS/lSwuLJUjEVxIsjcHIK5wBz0+Y0+bSrqKOGQJ5iSwrPujBIRSxX5uOORirf/CO3CS3C3F1Z28cExgMsrkK7jqF4yfyxQLQoadePp99FdxxxSvEchJV3KfqKglcyyvIQql2LEKMAZ9BWlFoV299dWkzw27Wib5nlY7VXIGcgHPUdPWnafBa2+uQWs62upQzMqEo8gUbiOQRtOR78ULVoG0rsyaK0pdNe48QT6fYoBid0QFuFUE8knsAOtXNR023s/DUEqT2tzK946maAkjaEHy8gd8/nSvpcfWxg0Vo6pYw2dtp0kTOWurbzX3EcHcw446cVnUwCiiigYUUUUAFFFFAD5v9c/8AvGrtnfRQaPqNm6uZLry9hAGBtbJzVKb/AFz/AO8adbWtxdy+VaW8s8mM7IkLH8hQLodBbeJYre9jdBcpE1hHaSPEwWRCoHzKc+o79RWbrWofbpYtt/f3aIDg3mMqT6AMfanabos93d3drNDcR3EFu8qxeWd7MMYGOvOaz7i2ntZjDdQSQyDqkiFSPwNLqJJdDR169sNSn+22/wBpW5kC+bG6rsXCgfKQcnp3Ap1/f2N3ZWcg+0pfWsKQ7dqmNgpPOc56HpisccmtLVNI/swukuoWcs6MFaGLzCwP4qB+tPYLLY0bjW9OM19qFvDci/vomjdH2+VGWGGIOcnvgYGM1zlFaI0W8/sd9UcIluhXAZvnYMcAgenucUrWHsa2meJra0sbC0mt5JFQtHdEY+eLLFQvPUFifwFVv7Wsb+2lt9WW5VftT3MckAVj8/3lIJHoOah07wzq+o2yXFvaSCN5ERGaNsNuz8wIH3Rjk1mXMElrcy28ylZImKsCCOR7Hmh7iSXQ6VZb/Un1S9g0e/eG+thBAYYGdQFZQMt34TBx3rGFlqWkXFve3mnXUKRyqQZoWQMQc4yR14NLqn/IP0b/AK82/wDR81EH/Is33/X5b/8AoE9NaahbSxdOq6dba+dRs0upYpzJ58coVSA4IIUgn1PJqDUL3Tv7Gi07TjdOFuGnZp0VcZUDAwTnpWPRStpYdtbl7Ubm3uLexSA3BaCDy5PN24ByT8uO3PfmqNFFMAooooGFFFFABRRRQA+b/XP/ALxrX8OTSobqJTZtDMgWWO4uBBvGcja2Rgg+/wCBoooRL2L0bWNjqmpi1vgyPpzhWaYNiQgfIH43Y6AiqGqXUc2laKzyJPLFG6yKXywAkJAbuOKKKXb+u4W/r5IpXU8F3cxfZrOCyHC4V2K5z1JYmtrV5BLpE76rcadPqDSqYHtTGXI53bynGOnXnNFFD2DqYktnHHpkF4LyB3ldlNup+dMdyPQ1raXabvDOoqbqyR7kxNGj3casQrHPBOR+NFFD2YX2NLQ7/SbLSrLzXk86MT3LAXKD5wu1Rjb1PYfjzXITtG07tCrrGT8odgzAe5AGfyooo63CKsXtU/5B+jf9ebf+j5qIP+RZvv8Ar8t//QJ6KKYzNooooGFFFFABRRRQAUUUUAFFFFAH/9k=" width="174" height="104" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uart">UART<a href="#uart" class="hash-link" aria-label="Direct link to UART" title="Direct link to UART">​</a></h3>
<a id="UART"></a>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 对 UART 进行控制和编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-3">引脚分布<a href="#引脚分布-3" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和开源开发板的40-pin连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-114-0feea997254dd8c83455c76190d30f83.jpg" width="1000" height="634" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>8 号和 10 号引脚默认已设置配为 UART，设备节点为 <em>/dev/ttyHS2</em>。</p></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-115-21fe4b787a7212f3363ba770cf072c16.jpg" width="1000" height="422" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令测试-1">使用 shell 命令测试<a href="#使用-shell-命令测试-1" class="hash-link" aria-label="Direct link to 使用 shell 命令测试" title="Direct link to 使用 shell 命令测试">​</a></h4>
<p>在 RUBIK Pi 3 中 使用下面命令控制串口通信</p>
<ul>
<li>
<p>使用 stty 工具配置串口，如下将串口的输入速率和输出速率都设置为 115200，并关闭回显：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyHS2 ispeed 115200 ospeed 115200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyHS2 -echo</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 上开启两个终端，将 8 号引脚和 10 号引脚使用杜邦线短接，分别执行下面命令，接收端会回显发送端的内容：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;hello world!&quot; &gt; /dev/ttyHS2  # 发送端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /dev/ttyHS2 # 接收端</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155526-1-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-uart通信">使用 WiringRP (C) UART通信<a href="#使用-wiringrp-c-uart通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) UART通信" title="Direct link to 使用 WiringRP (C) UART通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例使用 UART 进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;errno.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringSerial.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> count </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> nextTime </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">serialOpen</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unable to open serial device: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strerror</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errno</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stdout</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unable to start wiringPi: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strerror</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errno</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> count</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">serialPutchar</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">serialGetchar</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc uart.c -o uart</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155526-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./uart</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="170" height="71" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-uart-通信">使用 WiringRP-Python UART 通信<a href="#使用-wiringrp-python-uart-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python UART 通信" title="Direct link to 使用 WiringRP-Python UART 通信">​</a></h4>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例使用 UART 进行数据收发通信：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serial = wiringpi.serialOpen(&#x27;/dev/ttyHS2&#x27;, 115200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi.serialPuts(serial, &quot;hello world&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">received_data = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = wiringpi.serialGetchar(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">received_data.append(chr(c))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cnt = wiringpi.serialDataAvail(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in range(cnt):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c = wiringpi.serialGetchar(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    received_data.append(chr(c))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Received:&quot;, received_data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi.serialClose(serial)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>uart.py </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155526-4-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
</ul>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 uart.py </span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="598" height="55" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-uart-通信">使用 Python 程序 UART 通信<a href="#使用-python-程序-uart-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 UART 通信" title="Direct link to 使用 Python 程序 UART 通信">​</a></h4>
<ul>
<li>
<p>使用 Python 的 serial 库进行 UART 通信，需先在 RUBIK Pi 3 中使用下面命令安装 serial 库：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install pyserial</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例使用 UART 进行数据收发通信：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> serial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Serial</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    baudrate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bytesize</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EIGHTBITS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stopbits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">STOPBITS_ONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parity</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PARITY_NONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> uart3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uart3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;Hello World!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> uart3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Raw data:\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_strings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;utf-8&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Read {:d} bytes, printed as string:\n {:s}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_strings</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>uart.py </em>传输到  RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155526-2-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
</ul>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 uart.py </span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="330" height="100" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-uart-通信">使用 C 语言程序 UART 通信<a href="#使用-c-语言程序-uart-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 UART 通信" title="Direct link to 使用 C 语言程序 UART 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例使用 UART 进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;termios.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> serial_port_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> serial_port</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_port</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS%d&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">serial_port_num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> serial_fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    serial_fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_port</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> O_NOCTTY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open serial port&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">termios</span><span class="token plain"> tty</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcgetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error from tcgetattr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cfsetospeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B9600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cfsetispeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B9600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">PARENB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSTOPB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSIZE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> CS8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcsetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCSANOW</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error from tcsetattr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ssize_t</span><span class="token plain"> bytes_written </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bytes_written </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error writing to serial port&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> bytes_read </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bytes_read </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bytes_read</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rrx_buffer: \n %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;No data received.\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译，具体可参考<a href="/linux120.github.io/docs/set-up-development-environment#%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">交叉编译工具使用方法</a>章节：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc uart.c -o uart --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
<p>若使用交叉编译，需要将 <em>uart </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc uart.c -o uart</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155526-3-cfec1adfaf28d1698db4fcbcddccaaf4.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./uart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="165" height="88" class="img_ev3q"></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usb">USB<a href="#usb" class="hash-link" aria-label="Direct link to USB" title="Direct link to USB">​</a></h2>
<p>RUBIK Pi 3 拥有 4 个 USB 口：</p>
<ul>
<li>
<p>两个 USB 3.0 口，只能作为主机模式使用，如下图 7。</p>
</li>
<li>
<p>一个 USB 2.0 口，可以作为主机或设备模式使用，如下图 6。</p>
</li>
<li>
<p>一个 USB 3.1 Gen 1 口，可以作为主机或设备模式（ADB），以及 DP 显示使用，如下图 5。</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-123-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-20-type-a-接口">USB 2.0 Type-A 接口<a href="#usb-20-type-a-接口" class="hash-link" aria-label="Direct link to USB 2.0 Type-A 接口" title="Direct link to USB 2.0 Type-A 接口">​</a></h3>
<p>USB 2.0 接口默认为主机模式，作为设备模式时需要手动执行命令切换，如下为一种切换方式，在 RUBIK Pi 3 中输入下面命令，将 RUBIK Pi 3 模拟为 U 盘：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/config/usb_gadget/  #在串口终端登录，执行下面命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir g1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd g1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir functions/mass_storage.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/zero of=/tmp/test.iso bs=1M count=2048  #创建大小为2G的U盘空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 /tmp/test.iso </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;/tmp/test.iso&quot; &gt; functions/mass_storage.0/lun.0/file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir configs/c.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ln -s functions/mass_storage.0/ configs/c.1/f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo device &gt; /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode  #将USB切换为device模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 8c00000.usb &gt; UDC #连接USB线，U盘被识别 可在U盘内写入和写出文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo host &gt; /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode  #拔掉USB线，切换为主机模式</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-31-type-c-接口">USB 3.1 Type-C 接口<a href="#usb-31-type-c-接口" class="hash-link" aria-label="Direct link to USB 3.1 Type-C 接口" title="Direct link to USB 3.1 Type-C 接口">​</a></h3>
<p>Type-C 接口可自动完成主机和设备模式的切换。</p>
<ul>
<li>
<p>当 Type-C 接入 PC 时自动切换为设备模式。</p>
</li>
<li>
<p>接入 OTG 线时自动切换为主机模式。</p>
</li>
<li>
<p>接入 DP 显示器时，自动输出 DP 视频信号。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-调试">USB 调试<a href="#usb-调试" class="hash-link" aria-label="Direct link to USB 调试" title="Direct link to USB 调试">​</a></h3>
<p>本节提供有关获取调试日志的各种方法的信息。调试方式有 <code>regdumps</code> 、调试 <code>ftraces</code> 、 <code>configfs</code> 节点等。在调试与进入/退出低功耗模式、SMMU 故障、无时钟访问相关的问题时，可通过上述日志查看事件和控制器状态的详细信息。</p>
<ul>
<li>
<p>USB 2.0 Type-A 设备路径：<em> /sys/devices/platform/soc@0/<strong>8c00000</strong>.usb/xhci-hcd.0.auto/usb1</em></p>
</li>
<li>
<p>USB 3.0 Type-A 设备路径：</p>
<ul>
<li>
<p><em>/sys/devices/platform/soc@0/<strong>1c00000</strong>.pci/pci0000:00/0000:00:00.0/0000:<strong>01:00.0</strong>/usb2</em></p>
</li>
<li>
<p><em>/sys/devices/platform/soc@0/<strong>1c00000</strong>.pci/pci0000:00/0000:00:00.0/0000:<strong>01:00.0</strong>/usb3</em></p>
</li>
</ul>
</li>
<li>
<p>USB 3.1 Type-C 设备路径：<em>/sys/devices/platform/soc@0/<strong>a600000</strong>.usb</em> </p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usb-跟踪">USB 跟踪<a href="#usb-跟踪" class="hash-link" aria-label="Direct link to USB 跟踪" title="Direct link to USB 跟踪">​</a></h4>
<p>使用 <code>debugfs</code> 跟踪可以更加深入地了解 USB 线上发生的每一个事务。如需查看跟踪列表，可运行以下命令。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>确保已挂载 <code>debugfs</code>。如果尚未挂载，可运行以下命令来挂载 <code>debugfs</code>:</p>
<p><code>mount -t debugfs none /sys/kernel/debug</code></p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/dwc3</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/gadget 协议栈/USB Type-C 连接器系统软件接口 (UCSI) 中的数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_alloc_request  dwc3_event              dwc3_gadget_generic_cmd  enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_complete_trb   dwc3_free_request       dwc3_gadget_giveback     filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ctrl_req       dwc3_gadget_ep_cmd      dwc3_prepare_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_dequeue     dwc3_gadget_ep_disable  dwc3_readl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_queue       dwc3_gadget_ep_enable   dwc3_writel</span><br></span></code></pre></div></div>
<p>要列出 xHCI/主机控制器驱动程序 (HCD) 中的跟踪数据，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/xhci-hcd</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/HCD 中数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                            xhci_handle_cmd_config_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter                            xhci_handle_cmd_disable_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_add_endpoint                 xhci_handle_cmd_reset_dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctrl_ctx             xhci_handle_cmd_reset_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctx                  xhci_handle_cmd_set_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_dev                    xhci_handle_cmd_set_deq_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_virt_device            xhci_handle_cmd_stop_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint           xhci_handle_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint_ctrl_ctx  xhci_handle_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_alloc_request            xhci_handle_port_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_free_request             xhci_handle_transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_gadget_ep_queue          xhci_hub_status_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_giveback_request         xhci_inc_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_event             xhci_inc_enq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_transfer          xhci_queue_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_queue_request            xhci_ring_alloc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_address                  xhci_ring_ep_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_cancel_urb               xhci_ring_expansion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_context_change           xhci_ring_free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_init                     xhci_ring_host_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_quirks                   xhci_setup_addressable_virt_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_reset_ep                 xhci_setup_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_ring_expansion           xhci_setup_device_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_discover_or_reset_device     xhci_stop_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_dev                     xhci_urb_dequeue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_virt_device             xhci_urb_enqueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_get_port_status              xhci_urb_giveback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_handle_cmd_addr_dev</span><br></span></code></pre></div></div>
<p>请运行以下命令，以便列出 USB 视频类 (UVC) gadget 驱动程序的可用事件。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/gadget</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                      usb_gadget_activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter                      usb_gadget_clear_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_alloc_request        usb_gadget_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_clear_halt           usb_gadget_deactivate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_dequeue              usb_gadget_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_disable              usb_gadget_frame_number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_enable               usb_gadget_giveback_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_flush           usb_gadget_set_remote_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_status          usb_gadget_set_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_free_request         usb_gadget_vbus_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_queue                usb_gadget_vbus_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_halt             usb_gadget_vbus_draw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_maxpacket_limit  usb_gadget_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_wedge</span><br></span></code></pre></div></div>
<p>如需列出 UCSI 驱动程序中的可用事件，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/ucsi</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable  ucsi_connector_change  ucsi_register_port  ucsi_run_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter  ucsi_register_altmode  ucsi_reset_ppm</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usb-寄存器打印">USB 寄存器打印<a href="#usb-寄存器打印" class="hash-link" aria-label="Direct link to USB 寄存器打印" title="Direct link to USB 寄存器打印">​</a></h4>
<p>USB <code>debugfs</code> 提供以下信息，下面以 Type-C 接口为例。</p>
<ul>
<li>
<p>工作模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/mode # Type-C 接口</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>USB 2.0 Type-A 的工作模式<code>cat /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode</code></p></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">device</span><br></span></code></pre></div></div>
</li>
<li>
<p>设备模式下所有端点的状态和传输环形缓冲区 (TRB) 队列。</p>
</li>
<li>
<p>当前链路状态。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/link_state</span><br></span></code></pre></div></div>
<p>示例输出 </p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Sleep</span><br></span></code></pre></div></div>
</li>
<li>
<p>列出处理器 (LSP) dump。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/lsp_dump</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[0] = 0x40000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[1] = 0x00003a80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[2] = 0x38200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[3] = 0x00802000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[4] = 0x126f1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[5] = 0x3a800018</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[6] = 0x00000a80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[7] = 0xfc03f14a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[8] = 0x0b803fff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[9] = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[10] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[11] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[12] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[13] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[14] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[15] = 0x000000f8</span><br></span></code></pre></div></div>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/usb/a600000.usb</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ep0in    ep11out  ep14in   ep1out  ep4in   ep6out  ep9in       regdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep0out   ep12in   ep14out  ep2in   ep4out  ep7in   ep9out      testmode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep10in   ep12out  ep15in   ep2out  ep5in   ep7out  link_state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep10out  ep13in   ep15out  ep3in   ep5out  ep8in   lsp_dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep11in   ep13out  ep1in    ep3out  ep6in   ep8out  mode</span><br></span></code></pre></div></div>
<p><code>regdump</code> 命令提供以下寄存器的寄存器空间的当前状态： </p>
<ul>
<li>
<p>设备模式的寄存器，例如 DCTL、DSTS 和 DCFG</p>
</li>
<li>
<p>全局寄存器，例如 GCTL 和 GSTS</p>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/debug/usb/a600000.usb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat regdump</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GSBUSCFG0 = 0x2222000e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSBUSCFG1 = 0x00001700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GTXTHRCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GRXTHRCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GCTL = 0x00102000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVTEN = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSTS = 0x7e800000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL1 = 0x810c1802</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSNPSID = 0x5533330a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GGPIO = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUID = 0x00060500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL = 0x0d00c010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GBUSERRADDR0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GBUSERRADDR1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GHWPARAMS0 = 0x4020400a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGFIFOSPACE = 0x00420000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLTSSM = 0x41090658</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGBMU = 0x20300000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_HS0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_HS1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_FS0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_FS1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL2 = 0x0198440d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VER_NUMBER = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VER_TYPE = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2PHYCFG(0) = 0x00002400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2I2CCTL(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2PHYACC(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB3PIPECTL(0) = 0x030e0002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GTXFIFOSIZ(0) = 0x00000042</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GRXFIFOSIZ(0) = 0x00000305</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTADRLO(0) = 0xfffff000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTADRHI(0) = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTSIZ(0) = 0x00001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTCOUNT(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GHWPARAMS8 = 0x000007ea</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL3 = 0x00010000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GFLADJ = 0x8c80c8a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DCFG = 0x00cc08b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DCTL = 0x8cf00a00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEVTEN = 0x00000257</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DSTS = 0x008a5200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DGCMDPAR = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DGCMD = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DALEPENA = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR2(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR1(0) = 0xffffe000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR0(0) = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMD(0) = 0x00000006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCTL = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OEVT = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OEVTEN = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OSTS = 0x00000000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="主机-sysfs-查询">主机 sysfs 查询<a href="#主机-sysfs-查询" class="hash-link" aria-label="Direct link to 主机 sysfs 查询" title="Direct link to 主机 sysfs 查询">​</a></h4>
<p>要查看总线详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsub</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 001 Device 002: ID 03f0:134a HP, Inc Optical Mouse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></span></code></pre></div></div>
<p>要列出当前目录的内容，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/bus/usb/devices/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1-0:1.0  1-1  1-1:1.0  2-0:1.0  usb1  usb2</span><br></span></code></pre></div></div>
<p>要查看有关 USB 设备的详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/devices</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 6.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 6.5.0-rc4 xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.0.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  2 Spd=1.5  MxCh= 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS= 8 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=03f0 ProdID=134a Rev= 1.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=PixArt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=HP USB Optical Mouse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=a0 MxPwr=100mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=03(HID  ) Sub=01 Prot=02 Driver=usbhid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=10ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=02 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=5000 MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.00 Cls=09(hub  ) Sub=00 Prot=03 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0003 Rev= 6.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 6.5.0-rc4 xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.0.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="相机串行接口csi">相机串行接口（CSI）<a href="#相机串行接口csi" class="hash-link" aria-label="Direct link to 相机串行接口（CSI）" title="Direct link to 相机串行接口（CSI）">​</a></h2>
<p>目前，RUBIK Pi 3与<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>中列出的相机模块兼容。下表列出了每个相机模块支持的分辨率。</p>
<table><thead><tr><th>分辨率</th><th>宽高比</th><th>IMX477</th><th>IMX708</th><th>IMX219</th></tr></thead><tbody><tr><td>4056 x 3040</td><td>4:3</td><td>是</td><td>否</td><td>否</td></tr><tr><td>4608 x 2592</td><td>16:9</td><td>否</td><td>是</td><td>否</td></tr><tr><td>3280 x 2464</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr><tr><td>1920 x 1080</td><td>16:9</td><td>是</td><td>否</td><td>否</td></tr><tr><td>1632 x 1224</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr></tbody></table>
<ul>
<li>
<p>HQ Camera（IMX477/M12 Mount）</p>
<p>在 <a href="/linux120.github.io/docs/qualcomm-im-sdk">RUBIK Pi 3 QIM</a> 官方演示中，IMX477 摄像头使用了 WS1053516 镜头。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155508-d8f6e66fed4ad19156dd150680d0494f.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>Camera Module 2 (IMX219)</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>目前 RUBIK Pi 3 暂时只支持标准版 Module 2 摄像头，不支持广角（Wide）、夜光（NoIR）版本。</p></div></div>
</li>
<li>
<p>Camera Module 3 (IMX708)</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>目前 RUBIK Pi 3 暂时只支持标准版 Module 3 摄像头，不支持广角（Wide）、夜光（NoIR）版本。当前软件版本暂不支持 Module 3 摄像头的 AF 自动对焦功能。</p></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头排线安装">摄像头排线安装<a href="#摄像头排线安装" class="hash-link" aria-label="Direct link to 摄像头排线安装" title="Direct link to 摄像头排线安装">​</a></h3>
<a id="cameracable"></a>
<p>RUBIK Pi 3 支持的摄像头 FPC 为 22 pin，0.5mm 间距，厚度 0.3±0.05mm。兼容的附件请参考<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>严禁在板子未断电的情况下插拔摄像头，否则非常容易烧坏摄像头模组。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155515-709f9580e8ce95ebbc7bb79228b62a36.jpg" width="1000" height="750" class="img_ev3q"></p>
<ol>
<li>
<p>向上拉开连接器的锁扣部分：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155519-db8183a9be1bbba68e5132d22017d18b.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>插入 FPC，注意接触面朝向板内：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155503-74b2a4642754226940b7e16ac07e696a.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
<li>
<p>按下锁扣，确认 FPC 稳定没有松动：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155500-130370946aa496911ecb03dcdc375a11.jpg" width="1000" height="750" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头使用方法">摄像头使用方法<a href="#摄像头使用方法" class="hash-link" aria-label="Direct link to 摄像头使用方法" title="Direct link to 摄像头使用方法">​</a></h3>
<p>在 RUBIK Pi 3 中可使用 <code>gstreamer</code> 命令对摄像头进行操作，操作前需输入下面命令对摄像头进行设置：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo multiCameraLogicalXMLFile=kodiak_dc.xml &gt; /var/cache/camera/camxoverridesettings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo enableNCSService=FALSE &gt;&gt; /var/cache/camera/camxoverridesettings.txt</span><br></span></code></pre></div></div>
<p>可使用下面的命令关闭或打开摄像头相关的日志，执行完命令后重启设备生效。</p>
<p>默认值：</p>
<ul>
<li>
<p><code>logWarningMask:0xFFFFFFFFFFFFFFFF</code></p>
</li>
<li>
<p><code>logCoreCfgMask:0xFFFFFFFFFFFFFFFF</code></p>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo logWarningMask=0x00 &gt;&gt; /var/cache/camera/camxoverridesettings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo logCoreCfgMask=0x00 &gt;&gt; /var/cache/camera/camxoverridesettings.txt</span><br></span></code></pre></div></div>
<p>可将摄像头插入下图 13 和 14 处。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-122-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>如下为实物连接图：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155452-0b5aceedff3518e98aa028798281a825.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>暂时无法支持两个 IMX708 4608x2592同时运行。</p></div></div>
<ul>
<li>
<p>在 RUBIK Pi 3 中使用下面命令测试单个摄像头全屏预览：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 name=camsrc ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! queue ! waylandsink fullscreen=true async=true</span><br></span></code></pre></div></div>
<p>预览结果如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/img_v3_02jm_58744e49-6711-40d8-b572-46153b40191g-b2fc175bb45164408dbe2fd250d13d61.jpg" width="1000" height="571" class="img_ev3q"></p>
</li>
<li>
<p>在 RUBIK Pi 3 中使用下面命令测试两摄像头并发预览：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 终端1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 name=camsrc ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! queue ! waylandsink sync=false x=0 y=0 width=960 height=540 enable-last-sample=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 终端2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=1 name=camsrc ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! queue ! waylandsink sync=false x=960 y=540 width=960 height=540 enable-last-sample=false</span><br></span></code></pre></div></div>
<p>预览结果如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/img_v3_02jm_41a56146-056d-450c-bc15-cfc3a9f7d2cg-020a1358bdff01cf24aa50b97031f26c.jpg" width="1000" height="580" class="img_ev3q"></p>
</li>
<li>
<p>在 RUBIK Pi 3 中使用下面命令测试两摄像头并发录像：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 终端1：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo multiCameraLogicalXMLFile=kodiak_dc.xml &gt; /var/cache/camera/camxoverridesettings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 name=camsrc video_0::type=preview ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc,interlace-mode=progressive,colorimetry=bt601 ! queue ! v4l2h264enc capture-io-mode=5 output-io-mode=5 ! queue ! h264parse ! mp4mux ! queue ! filesink location=&quot;/opt/mux0.mp4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 终端2：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=1 name=camsrc video_0::type=preview ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc,interlace-mode=progressive,colorimetry=bt601 ! queue ! v4l2h264enc capture-io-mode=5 output-io-mode=5 ! queue ! h264parse ! mp4mux ! queue ! filesink location=&quot;/opt/mux1.mp4&quot;</span><br></span></code></pre></div></div>
<p>录制完成后在 <em>/opt </em>目录下有录制的视频文件，如下图：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="363" height="73" class="img_ev3q"></p>
</li>
<li>
<p>在 RUBIK Pi 3 中使用下面命令测试两摄像头并发录像加预览：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 终端1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 name=camsrc video_0::type=preview ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc,interlace-mode=progressive,colorimetry=bt601 ! queue ! v4l2h264enc capture-io-mode=5 output-io-mode=5 ! queue ! h264parse ! mp4mux ! queue ! filesink location=&quot;/opt/mux0.mp4&quot; camsrc. ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! waylandsink sync=false x=0 y=0 width=960 height=540 enable-last-sample=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 终端2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=1 name=camsrc video_0::type=preview ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc,interlace-mode=progressive,colorimetry=bt601 ! queue ! v4l2h264enc capture-io-mode=5 output-io-mode=5 ! queue ! h264parse ! mp4mux ! queue ! filesink location=&quot;/opt/mux1.mp4&quot; camsrc. ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! waylandsink sync=false x=960 y=540 width=960 height=540 enable-last-sample=false</span><br></span></code></pre></div></div>
<p>录制完成后在 <em>/opt</em> 目录下有录制的视频文件：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="363" height="73" class="img_ev3q"></p>
<p>预览结果如下：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-139-020a1358bdff01cf24aa50b97031f26c.jpg" width="1000" height="580" class="img_ev3q"></p>
</li>
<li>
<p>在 RUBIK Pi 3 中使用下面命令测试摄像头拍照：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-pipeline-app -e qtiqmmfsrc name=camsrc camera=0  ! &quot;image/jpeg,width=1920,height=1080,framerate=30/1&quot; ! multifilesink location=/opt/0_frame%d.jpg max-files=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>执行上述命令后，会在终端输出如下 MENU，在 MENU 中输入 3，并按下 <strong>Enter </strong>执行拍照指令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##################################### MENU #####################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ============================== Pipeline Controls ==============================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (0) NULL                     : Set the pipeline into NULL state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (1) READY                    : Set the pipeline into READY state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (2) PAUSED                   : Set the pipeline into PAUSED state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (3) PLAYING                  : Set the pipeline into PLAYING state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ==================================== Other ====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (p) Plugin Mode              : Choose a plugin which to control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (q) Quit                     : Exit the application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Choose an option:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 按下CTRL+C结束拍照</span><br></span></code></pre></div></div>
<p>拍照完成后在<em> /opt</em> 目录下有对应的 jpg 文件：</p>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="351" height="79" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头故障排除">摄像头故障排除<a href="#摄像头故障排除" class="hash-link" aria-label="Direct link to 摄像头故障排除" title="Direct link to 摄像头故障排除">​</a></h3>
<p>如果摄像头无法显示或捕捉图像，请检查以下内容：</p>
<ol>
<li>
<p>检查摄像头模块连接。</p>
<p>请参阅 <a href="/linux120.github.io/docs/peripherals-and-interfaces#cameracable">摄像头排线安装</a>。</p>
</li>
<li>
<p>运行单流预览用例。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export XDG_RUNTIME_DIR=/dev/socket/weston</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WAYLAND_DISPLAY=wayland-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setprop persist.overlay.use_c2d_blit 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 name=camsrc ! video/x-raw\(memory:GBM\),format=NV12,width=1920,height=1080,framerate=30/1,compression=ubwc ! queue ! waylandsink sync=false x=1000 y=1000 width=960 height=540 enable-last-sample=false</span><br></span></code></pre></div></div>
</li>
<li>
<p> 使用以下命令收集日志。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">journalctl -f &gt; /opt/log.txt</span><br></span></code></pre></div></div>
<p>在日志中搜索 &quot;probe success&quot; 。Probe success 意味着摄像头模块已通电并响应 I2C 控制。如果特定传感器没有 &quot;probe success&quot; 日志，则可能是柔性电缆连接或摄像头模块的问题。</p>
<p>以下日志指示探测到一个 IMX477：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[   80.645992] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 939: Probe success,slot:7,slave_addr:0x34,sensor_id:0x477, is always on: 0</span><br></span></code></pre></div></div>
</li>
<li>
<p>检查摄像头传感器驱动程序命令</p>
<p>使用 <code>journalctl -f &gt; /opt/log.txt</code>命令收集日志并搜索 &quot;cam_sensor_driver_cmd&quot;。 &quot;CAM_START_DEV Success&quot; 表示摄像头传感器流式传输开始。&quot;CAM_STOP_DEV Success&quot; 表示摄像头传感器流式传输停止。例如：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   81.172814] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1129: CAM_START_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   88.905241] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1157: CAM_STOP_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34</span><br></span></code></pre></div></div>
</li>
<li>
<p>检查传感器流式传输。</p>
<p>启用 CSID SOF/EOF IRQ 日志，随后执行摄像头出流命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mount -o rw,remount /usr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0x8 &gt; /sys/module/camera/parameters/debug_mdl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 3 &gt;/sys/kernel/debug/camera_ife/ife_csid_debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /sys/kernel/tracing/tracing_on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /sys/kernel/tracing/events/camera/cam_log_debug/enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 2 &gt; /sys/module/camera/parameters/debug_type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/tracing/trace_pipe &gt; trace.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>捕获的日志有助于提供有关 SOF 和 EOF 的详细信息。在日志 <em>trace.txt</em> 中搜索 &quot;irq_status_ipp&quot;。BIT12(0x1000)表示 SOF 数据包，BIT9(0x200)表示 EOF 数据包。日志如下所示：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;idle&gt;-0       [000] d.h1. 19287.546764: cam_log_debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0x1110 cam-server-25604     [000] dNH.. 19287.561705: cam_log_debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0xee8</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out">HDMI OUT<a href="#hdmi-out" class="hash-link" aria-label="Direct link to HDMI OUT" title="Direct link to HDMI OUT">​</a></h2>
<p>RUBIK Pi 3 的 HDMI 接口为下图 9。</p>
<p>RUBIK Pi 3 HDMI 参数信息：</p>
<ul>
<li>
<p>HDMI 1.4</p>
</li>
<li>
<p>3840 x 2160 分辨率 @ 30 fps</p>
</li>
<li>
<p>DSI 0 to HDMI (LT9611)</p>
</li>
<li>
<p>支持 CEC</p>
</li>
<li>
<p>支持分辨率自适应</p>
</li>
<li>
<p>支持热插拔</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-131-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>DP 和 HDMI 可同时接显示器，并发显示。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cec">CEC<a href="#cec" class="hash-link" aria-label="Direct link to CEC" title="Direct link to CEC">​</a></h3>
<p>HDMI CEC（Consumer Electronics  Control，消费者电子控制）是 HDMI 标准中的一项功能，旨在通过单一的 HDMI 连接线实现多设备之间的互联与统一控制。具体来说，CEC 允许连接的设备通过专用的 CEC 引脚进行通信，从而实现例如通过一个遥控器控制多台设备的功能。</p>
<p>RUBIK Pi 3 集成了 cec-client 工具，将 HDMI 线连接到电视后，可使用下面命令查看电视是否支持 CEC：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;scan&#x27; | cec-client -s -d 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>若支持 CEC 将会有如下输出:</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">opening a connection to the CEC adapter...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requesting CEC bus information ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC bus information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #0: TV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Sony</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    TV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      eng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #1: Recorder 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       1.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Pulse Eight</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    CECTester</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      eng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #4: Playback 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       3.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Sony</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    PlayStation 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.3a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      ???</span><br></span></code></pre></div></div>
<p>若电视支持 CEC 功能，可在 RUBIK Pi 3 中使用下面命令控制电视音量的加减：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;volup&#x27; | cec-client -t p -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;voldown&#x27; | cec-client -t p -s</span><br></span></code></pre></div></div>
<p>更多 cec-client 使用方法，可使用 <code>-h</code> 参数进行查看：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-134-b8e065a0549f141e5e08636bb673d487.jpg" width="727" height="509" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-触摸屏">HDMI OUT 触摸屏<a href="#hdmi-out-触摸屏" class="hash-link" aria-label="Direct link to HDMI OUT 触摸屏" title="Direct link to HDMI OUT 触摸屏">​</a></h3>
<p>RUBIK Pi 3 默认支持 1024*600P 分辨率的 HDMI OUT 触摸屏，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/img_v3_02h3_18251d67-83e7-498c-b056-5a11783ed13g-14723a76887da8746043fd7ac2a7a1a8.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>上图中使用的屏幕为 <a href="https://detail.tmall.com/item.htm?abbucket=12&amp;id=683025543197&amp;rn=92499216a472de3107f9541a1b160dc3&amp;spm=a1z10.5-b-s.w4011-25285306736.152.50aa1c712FMfOS&amp;skuId=5055110246880" target="_blank" rel="noopener noreferrer">7 寸 IPS 高清触摸屏幕</a>。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-调试">HDMI OUT 调试<a href="#hdmi-out-调试" class="hash-link" aria-label="Direct link to HDMI OUT 调试" title="Direct link to HDMI OUT 调试">​</a></h3>
<p>RUBIK Pi 3 使用的是 LT9611 这款 DSI-to-HDMI 桥接芯片。</p>
<p>下表列出 HDMI 桥接芯片所需的配置。</p>
<table><thead><tr><th>说明</th><th>DTSI 节点</th></tr></thead><tbody><tr><td>将 DSI-to-HDMI 桥接面板设置为 Primary</td><td><code>&amp;sde_dsi { qcom, dsi-default-panel = &lt;&amp;dsi_ext_bridge_1080p&gt;;</code></td></tr><tr><td>为桥接芯片配置基准电源条目</td><td><code>&amp;sde_dsi { vddio-supply = &lt;&amp;vreg_18c_ip62&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;;</code></td></tr><tr><td>为桥接芯片配置面板复位 GPIO</td><td><code>lt9611: lt,lt9611 { reset-options = &lt;&amp;tlmm 21 0&gt;;}</code></td></tr><tr><td>在外部桥接模式下配置 DSI 主机驱动程序以使用第三方 DSI-to-HDMI 桥接芯片</td><td><code>qcom,mdss-dsi-ext-bridge-mode;</code></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-lt9611-日志">获取 LT9611 日志<a href="#获取-lt9611-日志" class="hash-link" aria-label="Direct link to 获取 LT9611 日志" title="Direct link to 获取 LT9611 日志">​</a></h4>
<p>要获取 LT9611 日志，请运行以下命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep lt9611</span><br></span></code></pre></div></div>
<p>查看 log，出现下面的字样代表 HDMI OUT 可以正常运行。</p>
<p>这段日志记录了 LT9611 芯片的初始化和 HDMI 连接过程，从固件版本检测到 CEC 初始化，芯片启动正常。</p>
<ol>
<li>
<p>芯片的固件版本是 0xe2.17.02。这表示芯片初始化时，驱动成功读取了版本信息。</p>
</li>
<li>
<p>LT9611 的 CEC（消费电子控制）功能适配器成功注册。</p>
</li>
<li>
<p>CEC 初始化完成，表明 LT9611 的 CEC 模块已经可以正常工作。</p>
</li>
<li>
<p>芯片成功读取了 HPD（热插拔检测）状态，并且会有返回值，表示确认 HDMI 设备接入。</p>
</li>
<li>
<p>芯片检测到视频信号参数：水平分辨率 1920（像素），垂直分辨率 1080（像素），像素时钟频率 148500 kHz（148.5 MHz）。这对应的是 1080p 分辨率（全高清），60Hz 刷新率的典型配置。</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[    5.492765] lt9611 9-0039: LT9611 revision: 0xe2.17.02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.570258] lt9611 9-0039: CEC adapter registered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.582944] lt9611 9-0039: CEC init success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.233028] lt9611 9-0039: success to read hpd status: 13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.233044] lt9611_device_connect_status_notify: send msg[Hdmi Connection] ret[32]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.345015] lt9611 9-0039: hdisplay=1920, vdisplay=1080, clock=148500 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.836662] lt9611 9-0039: video check: hactive_a=1920, hactive_b=1920, vactive=1080, v_total=1125, h_total_sysclk=401, mipi_video_format=170</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dsi-日志">获取 DSI 日志<a href="#获取-dsi-日志" class="hash-link" aria-label="Direct link to 获取 DSI 日志" title="Direct link to 获取 DSI 日志">​</a></h4>
<p>我们也可以通过输出的 DSI 信息进行调试。DSI 指的是 Display Serial Interface（显示串行接口），通常与移动设备或嵌入式系统的显示驱动（如 MIPI DSI）相关。</p>
<p>这个命令用来查看与显示接口（DSI）相关的内核日志，通常用于调试显示驱动或硬件问题。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep dsi</span><br></span></code></pre></div></div>
<p>输出结果示例：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.811430] i2c 9-0039: Fixed dependency cycle(s) with /soc@0/qcom,dsi-display-primary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941131] dsi_phy ae94400.qcom,mdss_dsi_phy0: supply gdsc not found, using dummy regulator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941385] [drm:dsi_pll_init [msm_drm]] [msm-dsi-info]: DSI_PLL_0: DSI pll label = dsi_pll_5nm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941466] [drm:dsi_pll_init [msm_drm]] [msm-dsi-info]: DSI_PLL_0: PLL SSC enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941513] dsi_pll_init: PLL base=00000000625eaee4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941658] [drm:dsi_pll_clock_register_5nm [msm_drm]] [msm-dsi-info]: DSI_PLL_0: Registered clocks successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.941700] [drm:dsi_phy_driver_probe [msm_drm]] [msm-dsi-info]: DSI_0: Probe successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    4.973185] [drm:dsi_ctrl_dev_probe [msm_drm]] [msm-dsi-info]: dsi-ctrl-0: Probe successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.585113] [drm:dsi_display_bind [msm_drm]] [msm-dsi-info]: Successfully bind display panel &#x27;qcom,mdss_dsi_ext_bridge_1080p &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.585154] msm_drm ae00000.qcom,mdss_mdp0: bound soc@0:qcom,dsi-display-primary (ops dsi_display_comp_ops [msm_drm])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.345467] [drm:dsi_display_set_mode [msm_drm]] [msm-dsi-info]: mdp_transfer_time=0, hactive=1920, vactive=1080, fps=60, clk_rate=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.345740] [drm:dsi_ctrl_isr_configure [msm_drm]] [msm-dsi-info]: dsi-ctrl-0: IRQ 249 registered</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取显示面板信息">获取显示面板信息<a href="#获取显示面板信息" class="hash-link" aria-label="Direct link to 获取显示面板信息" title="Direct link to 获取显示面板信息">​</a></h4>
<p>若要查看选定的显示面板，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/qcom,mdss_dsi_ext_bridge_2k60/dump_info</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name = qcom,mdss_dsi_ext_bridge_2k60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Resolution = 2560(80|48|32|1)x1440(33|3|5|1)@60fps 0 Hz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CTRL_0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ctrl = dsi-ctrl-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                phy = dsi-phy-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Panel = ext video mode dsi bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Clock master = dsi-ctrl-0</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dsi-时钟信息">获取 DSI 时钟信息<a href="#获取-dsi-时钟信息" class="hash-link" aria-label="Direct link to 获取 DSI 时钟信息" title="Direct link to 获取 DSI 时钟信息">​</a></h4>
<p>若要检查 DSI 时钟信息，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/qcom,mdss_dsi_ext_bridge_2k60/dsi-ctrl-0/state_info</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Current State:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CTRL_ENGINE = ON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VIDEO_ENGINE = ON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        COMMAND_ENGINE = OFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Clock Info:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BYTE_CLK = 181274400, PIXEL_CLK = 241699200, ESC_CLK = 19200000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取调压器信息">获取调压器信息<a href="#获取调压器信息" class="hash-link" aria-label="Direct link to 获取调压器信息" title="Direct link to 获取调压器信息">​</a></h4>
<p>要检查调压器状态和电压，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/regulator/regulator_summary</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取接口信息">获取接口信息<a href="#获取接口信息" class="hash-link" aria-label="Direct link to 获取接口信息" title="Direct link to 获取接口信息">​</a></h4>
<p>要检索调试 dump 输出（显示接口编号、VSync 计数、欠载计数和接口模式），请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/dri/0/encoder*/status</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">intf:1    vsync:  359036     underrun:       0    mode: video</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intf:0    vsync:       0     underrun:       0    mode: video</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取常规-dpu-调试信息">获取常规 DPU 调试信息<a href="#获取常规-dpu-调试信息" class="hash-link" aria-label="Direct link to 获取常规 DPU 调试信息" title="Direct link to 获取常规 DPU 调试信息">​</a></h4>
<p>常见的 DPU 调试信息说明如下：</p>
<p>检查 DPU 时钟速率：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/clk/clk_summary | grep disp_cc</span><br></span></code></pre></div></div>
<p>将 DPU 设置为性能模式：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/debug/dri/0/debug/core_perf/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; perf_mode</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="displayport">DisplayPort<a href="#displayport" class="hash-link" aria-label="Direct link to DisplayPort" title="Direct link to DisplayPort">​</a></h2>
<p>RUBIK Pi 3 拥有 1 个 USB Type-C 接口的 DisplayPort (DP)，如下图 5。</p>
<p>DP 的参数如下：</p>
<ul>
<li>
<p>3840 × 2160 分辨率 @ 60 fps</p>
</li>
<li>
<p>单流传输 (Single stream transport)</p>
</li>
<li>
<p>DisplayPort 和 USB 3.0 的并发功能</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-132-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>DP 和 HDMI 可同时接显示器，并发显示。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dp-调试">DP 调试<a href="#dp-调试" class="hash-link" aria-label="Direct link to DP 调试" title="Direct link to DP 调试">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dp-日志">获取 DP 日志<a href="#获取-dp-日志" class="hash-link" aria-label="Direct link to 获取 DP 日志" title="Direct link to 获取 DP 日志">​</a></h4>
<p>输入下面命令开启日志打印权限。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 8 &gt; /proc/sys/kernel/printk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo ‘file dsi* +p’ &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>第一条命令中的<code>8</code>表示日志级别。Linux 内核用 0 到 8 表示日志的优先级，数值越小，优先级越高：</p>
<ul>
<li>
<p>0 (KERN_EMERG): 系统紧急情况（比如崩溃）。</p>
</li>
<li>
<p>1 (KERN_ALERT): 需要立即处理的问题。</p>
</li>
<li>
<p>2 (KERN_CRIT): 严重错误。</p>
</li>
<li>
<p>3 (KERN_ERR): 一般错误。</p>
</li>
<li>
<p>4 (KERN_WARNING): 警告。</p>
</li>
<li>
<p>5 (KERN_NOTICE): 正常但值得注意的事件。</p>
</li>
<li>
<p>6 (KERN_INFO): 信息性消息。</p>
</li>
<li>
<p>7 (KERN_DEBUG): 调试信息。</p>
</li>
<li>
<p>8: 比调试还低的级别，可以打出全部级别。</p>
</li>
</ul>
</blockquote></div></div>
<p>而<code>echo ‘file dsi* +p’ &gt; /sys/kernel/debug/dynamic_debug/control</code>则会显示</p>
<p>内核中所有文件名以 <em>dsi*</em> 开头的源文件（通常是 DSI 显示驱动相关的代码）里的调试信息。</p>
<p>这些调试信息会输出到内核日志，可以通过 <code>dmesg</code> 查看。通过下面的命令输出来调试 DP：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_display.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_aux.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_link.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_power.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_ctrl.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;file dp_parser.c +p&#x27; &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span></code></pre></div></div>
<p>打开全部的限制等级之后，我们就可以筛选 DP 的日志来进行进一步的验证，以下是 DP 正常启动之后，输出的日志：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hub 4-0:1.0: USB hub found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hub 4-0:1.0: 1 port detected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usb usb5: We don&#x27;t know the algorithms for LPM for this host, disabling LPM.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hub 5-0:1.0: USB hub found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hub 5-0:1.0: 1 port detected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_power_clk_enable][msm-dp-info][3216]core:on link:off strm0:off strm1:off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_display_host_init][msm-dp-info][3216][OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_display_host_ready][msm-dp-info][2912][OK]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_panel_read_sink_caps][msm-dp-info][2912]fec_en=0, dsc_en=0, widebus_en=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_link_process_request][msm-dp-info][2912]event: DP_LINK_STATUS_UPDATED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_power_clk_enable][msm-dp-info][2912]core:on link:on strm0:off strm1:off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_catalog_ctrl_fec_config][msm-dp-err][2912]no link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][2912]link training #1 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][2912]link training #2 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_link_process_request][msm-dp-info][2912]event: DP_LINK_STATUS_UPDATED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_catalog_ctrl_fec_config][msm-dp-err][2912]no link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][2912]link training #1 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][2912]link training #2 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_display_send_hpd_event][msm-dp-info][2912][name=DP-1]:[status=connected] [bpp=0] [pattern=0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_display_send_hpd_event][msm-dp-info][2912]uevent success: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lt9611 9-0039: success to read hpd status: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lt9611_device_connect_status_notify: send msg[Hdmi Disconnect] ret[32]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lt9611 9-0039: success to read hpd status: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lt9611_device_connect_status_notify: send msg[Hdmi Disconnect] ret[32]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_power_clk_enable][msm-dp-info][577 ]core:on link:on strm0:on strm1:off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_catalog_ctrl_fec_config][msm-dp-err][577 ]no link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][577 ]link training #1 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_ctrl_link_train][msm-dp-info][577 ]link training #2 successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_panel_resolution_info][msm-dp-info][577 ]DP RESOLUTION: active(back|front|width|low)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[drm:dp_panel_resolution_info][msm-dp-info][577 ]1920(148|88|44|0)x1080(36|4|5|0)@60fps 24bpp 148500Khz 10LR 2Ln</span><br></span></code></pre></div></div>
<p>以上正常启动流程的日志总结如下：</p>
<ol>
<li>
<p>USB 初始化: 系统启动时检测到两个单端口 USB HUB，禁用 USB 5 的 LPM。</p>
</li>
<li>
<p>DP 准备: DP 控制器初始化，读取显示器能力，准备建立连接。</p>
</li>
<li>
<p>DP 链接训练: 通过多次链接训练，DP 与显示器建立稳定连接。</p>
</li>
<li>
<p>DP 连接确认: 系统确认 DP-1 已连接，通知用户空间。</p>
</li>
<li>
<p>HDMI 断开: LT9611 检测到 HDMI 断开，可能是用户操作或接口切换。</p>
</li>
<li>
<p>DP 输出: HDMI 断开后，DP 启用视频流，输出 1080p@60Hz 的画面。</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wi-fi--蓝牙">Wi-Fi &amp; 蓝牙<a href="#wi-fi--蓝牙" class="hash-link" aria-label="Direct link to Wi-Fi &amp; 蓝牙" title="Direct link to Wi-Fi &amp; 蓝牙">​</a></h2>
<p>RUBIK Pi 3 上搭载了 AP6256 Wi-Fi 模块，支持 Wi-Fi 5 和蓝牙 5.2。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wi-fi">Wi-Fi<a href="#wi-fi" class="hash-link" aria-label="Direct link to Wi-Fi" title="Direct link to Wi-Fi">​</a></h3>
<p>Wi-Fi 是一种使用 IEEE 802.11 协议的无线网络技术。它允许智能手机、可穿戴设备、笔记本电脑、台式机和其他消费电子产品等电子设备在没有物理电缆的情况下连接到互联网。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作频段">工作频段<a href="#工作频段" class="hash-link" aria-label="Direct link to 工作频段" title="Direct link to 工作频段">​</a></h4>
<p> AP6256 Wi-Fi 模块支持 2.4 GHz、5 GHz 工作频段。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作模式">工作模式<a href="#工作模式" class="hash-link" aria-label="Direct link to 工作模式" title="Direct link to 工作模式">​</a></h4>
<p>Wi-Fi 软件在以下模式下运行：</p>
<table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td>STA 模式</td><td>在 STA 模式下，设备连接到 Wi-Fi 网络中的接入点，并与网络中的其他设备进行通信。此模式是 Wi-Fi 连接中的无线设备的标准模式。</td></tr><tr><td>热点模式</td><td>热点模式使设备能够使用蜂窝链路 (LTE) 向 Wi-Fi 客户端提供回程 (Internet) 连接。该设备通过其轻量级热点接口建立此连接。在热点模式下，设备可以与连接到同一热点的其他 Wi-Fi 客户端通信，与热点设备通信，共享设备的 WAN 连接。</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="sta-模式">STA 模式<a href="#sta-模式" class="hash-link" aria-label="Direct link to STA 模式" title="Direct link to STA 模式">​</a></h5>
<p>在 STA 模式（Station）下，设备可连接到一个已经存在的无线网络，以便访问网络资源或互联网。在 RUBIK Pi 3 中输入如下面命令进行连接：</p>
<ol>
<li>
<p>扫描附近 Wi-Fi：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iw wlan0 scan | grep SSID </span><br></span></code></pre></div></div>
</li>
<li>
<p>连接 Wi-Fi：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wpa_passphrase &lt;ssid&gt; &lt;passphrase&gt; &gt; /etc/wpa_supplicant.conf # 输入Wi-Fi账号和密码 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wifi # 连接Wi-Fi</span><br></span></code></pre></div></div>
<p>连接好 Wi-Fi 后，下次开机会自动进行连接。</p>
</li>
<li>
<p>如想切换 Wi-Fi 可修改 <em>/etc/wpa_supplicant.conf </em>文件，如下是一种修改方式：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ctrl_interface=/var/run/wpa_supplicant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update_config=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pmf=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssid=&quot;RUBIKPi&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        psk=&quot;123456789&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>
<p>ssid 为无线网络名称</p>
</li>
<li>
<p>psk 为无线网络密码</p>
</li>
</ul>
<p>按实际情况对文件进行修改。</p>
</li>
<li>
<p>修改完成后，输入下面命令进行连接：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">killall -9 wpa_supplicant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa_supplicant -Dnl80211 -iwlan0 -c/etc/wpa_supplicant.conf -B</span><br></span></code></pre></div></div>
</li>
</ol>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="热点模式">热点模式<a href="#热点模式" class="hash-link" aria-label="Direct link to 热点模式" title="Direct link to 热点模式">​</a></h5>
<p>无线接入热点模式即 AP 模式（Access Point），是一个无线网络的创建者，是网络的中心节点，一般家庭或办公室使用的无线网络路由器就是一个 AP，下面是 AP 的创建步骤：</p>
<ul>
<li>
<p>开启 AP</p>
<ul>
<li>
<p>创建或修改 <em>/opt/hostapd.conf </em> 文件：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ctrl_interface=/var/run/hostapd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver=nl80211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211n=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface=wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hw_mode=a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">channel=36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beacon_int=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtim_period=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssid=RUBIKPi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_algs=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ap_isolate=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ignore_broadcast_ssid=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa_key_mgmt=WPA-PSK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rsn_pairwise=CCMP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa_passphrase=123456789</span><br></span></code></pre></div></div>
</li>
<li>
<p>执行下面命令开启 AP：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hostapd -B /opt/hostapd.conf # 设置软件AP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 启动动态主机配置协议（DHCP）服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brctl addbr br0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brctl addif br0 wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig br0 192.168.225.1 netmask 255.255.255.0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">killall dnsmasq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnsmasq --conf-file=/etc/dnsmasq.conf --dhcp-leasefile=/var/run/dnsmasq.leases --addn-hosts=/data/hosts --pid-file=/var/run/dnsmasq.pid -i br0 -I lo -z --dhcp-range=br0,192.168.225.20,192.168.225.60,255.255.255.0,43200 --dhcp-hostsfile=/data/dhcp_hosts --dhcp-option-force=6,192.168.225.1 --dhcp-script=/bin/dnsmasq_script.sh</span><br></span></code></pre></div></div>
</li>
<li>
<p>若要与 hostapd_cli 建立连接，可使用下面命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hostapd_cli -i wlan1 -p /var/run/hostapd</span><br></span></code></pre></div></div>
</li>
</ul>
<p>在 <code>hostapd_cli</code> 控制台中监视 Wi-Fi STA 连接通知，例如 <code>AP-STA-CONNECTED</code>、 <code>EAPOL-4WAY-HS-COMPLETED</code>。</p>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rubikpi:~# hostapd_cli -i wlanl -p /var/run/hostapd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hostapd_cli v2.11-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (c) 2004-2022, Jouni Malinen &lt;j@wl.fi&gt; and contributors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This software may be distributed under the terms of the BSD License. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See README for more details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interactive mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &lt;3&gt;AP-STA-CONNECTED aa: a4: fd: 8b: ec: 90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;3&gt;EAPOL-4WAY-HS-COMPLETED aa: a4: fd: 8b:ec:90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; list_sta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aa: a4: fd: 8b:ec:90</span><br></span></code></pre></div></div>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若开启 AP 5G 模式前，未使用 STA 模式连接过 5G Wi-Fi，则需使用如下命令，查看环境中 5G channel 的配置。</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iw dev wlan0 scan</span><br></span></code></pre></div></div><p>在命令执行结果中通过 primary channel 字段确定当前已被激活 channel，如下所示，channel 字段为 36，将 36 写入 <em>/opt/hostapd.conf</em>  文件中的 channel 字段即可</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HT operation:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * primary channel: 36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * secondary channel offset: above</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * STA channel width: any</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * RIFS: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * HT protection: nonmember</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * non-GF present: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * OBSS non-GF present: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * dual beacon: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * dual CTS protection: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * STBC beacon: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * L-SIG TXOP Prot: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * PCO active: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 * PCO phase: 0</span><br></span></code></pre></div></div></div></div>
<blockquote>
</blockquote>
<ul>
<li>
<p>验证 AP</p>
<p>要验证连接状态，请从其他设备连接到 AP。 </p>
<p>例如，通过执行以下步骤从移动设备连接到 AP：</p>
<ol>
<li>
<p>在移动设备上，转到 Wi-Fi settings。</p>
</li>
<li>
<p>等待 Wi-Fi STA 检测到 AP。</p>
</li>
<li>
<p>选择 AP 并输入在 RUBIK Pi 3 设备上为 AP 配置的相应 <code>wpa_passphrase</code>，然后进行连接。 </p>
</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state=ENABLED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">phy=phyR freq=2412</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_non_erp=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_no_short_slot_time=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_no_short_preamble=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olbc=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht_no_gf=0 num_sta_no_ht=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht_20_mhz=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht40_intolerant=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olbc_ht=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_op_mode=0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hw_mode=g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country_code=US</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country3=0x20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cac_time_seconds=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cac_time_left_seconds=N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">channel=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edmg_enable=0 edmg_channel=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secondary_channel=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211n=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211ac=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211ax=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211be=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beacon_int=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtim_period=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_caps_info=000c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_mcs_bitmask=ffff0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supported_rates-02 04 0b 16 Oc 12 18 24 30 48 60 6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_txpower=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss[0]=wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bssid[0]=00:03:7f:95:8e:8e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssid [0]=QSoftAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta[0]=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; |</span><br></span></code></pre></div></div>
<ol start="4">
<li>要验证连接，在 RUBIK Pi 3 设备的终端 中 ping 移动设备的 IP 地址。</li>
</ol>
<p>以下输出表示 Wi-Fi 连接已成功建立，数据传输已开始： </p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ping 192.168.1.42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING 192.168.1.42 (192.168.1.42): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=0 ttl=64 time-11.175 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=1 ttl=64 time=14.528 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=2 ttl=64 time=29.735 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=3 ttl=64 time=223.822 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq-4 ttl=64 time-23.675 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.42 ping statistics ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7 packets transmitted, 5 packets received, 28% packet loss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">round-trip min/avg/max = 11.175/60.587/223.822 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1#</span><br></span></code></pre></div></div>
<p>也可以在连接设备的 Settings 中验证 Wi-Fi 连接状态。例如，要获取连接到 RUBIK Pi 3 AP 的移动设备的 IP 地址，执行以下步骤：</p>
<ol>
<li>
<p>导航至 Settings &gt; Wi-Fi。</p>
</li>
<li>
<p>验证 AP 的 SSID。</p>
</li>
</ol>
</li>
<li>
<p>关闭 AP：</p>
<p>要停止 AP，在终端 中执行以下操作：</p>
<ol>
<li>
<p>通过执行以下步骤停止 hostapd：</p>
<ul>
<li>
<p>要停止 hostapd 过程，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">killall hostapd</span><br></span></code></pre></div></div>
</li>
<li>
<p>要禁用接口，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig wlan1 down</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>运行以下命令删除 <code>ctrl_interface</code>：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf /var/run/hostapd/wlan1</span><br></span></code></pre></div></div>
</li>
</ol>
<p>Wi-Fi 热点成功停止。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="蓝牙">蓝牙<a href="#蓝牙" class="hash-link" aria-label="Direct link to 蓝牙" title="Direct link to 蓝牙">​</a></h3>
<p>蓝牙® 无线技术是一种短距离通信系统，可实现设备之间的无线数据交换。蓝牙技术的主要优势如下：</p>
<ul>
<li>
<p>替代便携式和固定式电子设备的线缆</p>
</li>
<li>
<p>提供稳健、节能且经济高效的解决方案</p>
</li>
<li>
<p>促进解决方案及其应用的灵活性。</p>
</li>
</ul>
<p>在 RUBIK Pi 3 中使用下面命令测试蓝牙 功能。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bluez-协议栈">BlueZ 协议栈<a href="#bluez-协议栈" class="hash-link" aria-label="Direct link to BlueZ 协议栈" title="Direct link to BlueZ 协议栈">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="通用访问配置文件gap">通用访问配置文件（GAP）<a href="#通用访问配置文件gap" class="hash-link" aria-label="Direct link to 通用访问配置文件（GAP）" title="Direct link to 通用访问配置文件（GAP）">​</a></h5>
<p>通用访问配置文件(Generic Access Profile, GAP)，保证不同的 Bluetooth 产品可以互相发现对方并建立连接，是所有其它蓝牙应用规范的基础。</p>
<p><code>bluetoothctl</code> 是 BlueZ 套件的一部分，BlueZ 是 Linux 上的官方蓝牙协议栈。通过 <code>bluetoothctl</code>，用户可以以交互式的方式管理蓝牙设备，适用于桌面和嵌入式系统。</p>
<ul>
<li>
<p>在终端输入如下命令启动 <code>bluetoothctl</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# bluetoothctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Agent registered        uetoothd...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Pairable: yes</span><br></span></code></pre></div></div>
<ul>
<li>进入 <code>bluetoothctl</code> 交互模式后，提示符会变为 <code>[bluetooth]#</code>，表示可以输入命令进行管理。</li>
</ul>
</li>
<li>
<p>输入 <code>help</code> 命令查看帮助信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# help</span><br></span></code></pre></div></div>
</li>
</ul>
<p>输出示例：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Menu main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">advertise                                         Advertise Options Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">monitor                                           Advertisement Monitor Options Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scan                                              Scan Options Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gatt                                              Generic Attribute Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">admin                                             Admin Policy Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">player                                            Media Player Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endpoint                                          Media Endpoint Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transport                                         Media Transport Submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available controllers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [ctrl]                                       Controller information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;ctrl&gt;                                     Select default controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">devices [Paired/Bonded/Trusted/Connected]         List available devices, with an optional property as the filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">system-alias &lt;name&gt;                               Set controller alias</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reset-alias                                       Reset controller alias</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power &lt;on/off&gt;                                    Set controller power</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pairable &lt;on/off&gt;                                 Set controller pairable mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">discoverable &lt;on/off&gt;                             Set controller discoverable mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">discoverable-timeout [value]                      Set discoverable timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agent &lt;on/off/capability&gt;                         Enable/disable agent with given capability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default-agent                                     Set agent as the default one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">advertise &lt;on/off/type&gt;                           Enable/disable advertising with given type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-alias &lt;alias&gt;                                 Set device alias</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scan &lt;on/off/bredr/le&gt;                            Scan for devices</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info [dev]                                        Device information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pair [dev]                                        Pair with device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cancel-pairing [dev]                              Cancel pairing with device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trust [dev]                                       Trust device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">untrust [dev]                                     Untrust device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block [dev]                                       Block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unblock [dev]                                     Unblock device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remove &lt;dev&gt;                                      Remove device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;dev&gt;                                     Connect device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disconnect [dev]                                  Disconnect device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu &lt;name&gt;                                       Select submenu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span></code></pre></div></div>
<ul>
<li>
<p>输入 <code>show</code> 命令查看当前蓝牙控制器状态</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# show</span><br></span></code></pre></div></div>
</li>
</ul>
<p>输出示例：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Controller 54:78:C9:D8:64:1F (public)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Name: rubikpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Alias: rubikpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Class: 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Powered: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Discoverable: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DiscoverableTimeout: 0x000000b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pairable: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Message Notification Se.. (00001133-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: A/V Remote Control        (0000110e-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: OBEX Object Push          (00001105-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Message Access Server     (00001132-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: PnP Information           (00001200-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: IrMC Sync                 (00001104-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Headset                   (00001108-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: A/V Remote Control Target (0000110c-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Generic Attribute Profile (00001801-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Phonebook Access Server   (0000112f-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Device Information        (0000180a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Audio Sink                (0000110b-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Generic Access Profile    (00001800-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Handsfree Audio Gateway   (0000111f-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Audio Source              (0000110a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: OBEX File Transfer        (00001106-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: Handsfree                 (0000111e-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Modalias: usb:v1D6Bp0246d0541</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Discovering: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Roles: central</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Roles: peripheral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Advertising Features:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActiveInstances: 0x00 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SupportedInstances: 0x05 (5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SupportedIncludes: tx-power</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SupportedIncludes: appearance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SupportedIncludes: local-name</span><br></span></code></pre></div></div>
<ul>
<li>打开蓝牙</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# power on</span><br></span></code></pre></div></div>
<ul>
<li>关闭蓝牙</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# power off </span><br></span></code></pre></div></div>
<ul>
<li>开始扫描设备</li>
</ul>
<a id="startscan"></a>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# scan on</span><br></span></code></pre></div></div>
<ul>
<li>停止扫描设备</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# scan off</span><br></span></code></pre></div></div>
<ul>
<li>配对设备</li>
</ul>
<a id="pairRMT"></a>
<p>在配对远程设备之前，<a href="/linux120.github.io/docs/peripherals-and-interfaces#startscan">运行蓝牙查询扫描</a>以确保远程设备可用。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# pair XX:XX:XX:XX:XX:XX</span><br></span></code></pre></div></div>
<blockquote>
<p>其中 <code>XX:XX:XX:XX:XX:XX</code> 为目标设备的 MAC 地址，目标设备 MAC 地址可通过 <code>scan on</code> 命令获取。</p>
</blockquote>
<ul>
<li>信任设备</li>
</ul>
<p>信任设备后，系统会自动接受来自该设备的连接请求。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# trust XX:XX:XX:XX:XX:XX</span><br></span></code></pre></div></div>
<ul>
<li>连接设备</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect XX:XX:XX:XX:XX:XX</span><br></span></code></pre></div></div>
<ul>
<li>断开设备</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# disconnect XX:XX:XX:XX:XX:XX</span><br></span></code></pre></div></div>
<ul>
<li>取消配对设备</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# remove XX:XX:XX:XX:XX:XX</span><br></span></code></pre></div></div>
<ul>
<li>列出已配对设备</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# devices</span><br></span></code></pre></div></div>
<ul>
<li>日至检查</li>
</ul>
<p>如果遇到问题，可以查看系统日志以获取更多信息。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo journalctl -u bluetooth</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="通用属性配置文件gatt">通用属性配置文件（GATT）<a href="#通用属性配置文件gatt" class="hash-link" aria-label="Direct link to 通用属性配置文件（GATT）" title="Direct link to 通用属性配置文件（GATT）">​</a></h5>
<p>GATT 是一个服务框架，它使用 ATT 来发现服务，并在对等设备上读取和写入特征值。</p>
<p>要执行低功耗蓝牙 GATT 服务器或客户端功能，必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>为低功耗蓝牙 GATT 功能设置设备</strong></li>
</ol>
<a id="SetforGATTDev"></a>
<ol>
<li>通过运行以下命令打开蓝牙测试应用程序</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<blockquote>
<p>用户可以通过 <strong>bluetoothctl</strong> 的主菜单选项执行一些 GATT 功能，例如连接和扫描。</p>
</blockquote>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# bluetoothctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Agent registered        uetoothd...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Pairable: yes</span><br></span></code></pre></div></div>
<ul>
<li>运行下面命令，启用蓝牙：</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">power on</span><br></span></code></pre></div></div>
<ul>
<li>运行以下命令转至 <strong>GATT submenu</strong>：</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">menu gatt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Menu gatt:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list-attributes [dev/local]                       List attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select-attribute &lt;attribute/UUID/local&gt; [attribute/UUID] Select attribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attribute-info [attribute/UUID]                   Select attribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read [offset]                                     Read attribute value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write &lt;data=xx xx ...&gt; [offset] [type]            Write attribute value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acquire-write                                     Acquire Write file descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">release-write                                     Release Write file descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acquire-notify                                    Acquire Notify file descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">release-notify                                    Release Notify file descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">notify &lt;on/off&gt;                                   Notify attribute value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clone [dev/attribute/UUID]                        Clone a device or attribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register-application [UUID ...]                   Register profile to connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unregister-application                            Unregister profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register-service &lt;UUID&gt; [handle]                  Register application service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unregister-service &lt;UUID/object&gt;                  Unregister application service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register-includes &lt;UUID&gt; [handle]                 Register as Included service in.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unregister-includes &lt;Service-UUID&gt; &lt;Inc-UUID&gt;     Unregister Included service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register-characteristic &lt;UUID&gt; &lt;Flags=read,write,notify...&gt; [handle] Register application characteristic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unregister-characteristic &lt;UUID/object&gt;           Unregister application characteristic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register-descriptor &lt;UUID&gt; &lt;Flags=read,write...&gt; [handle] Register application descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unregister-descriptor &lt;UUID/object&gt;               Unregister application descriptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">back                                              Return to main menu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span></code></pre></div></div>
<p><strong>2.</strong> <strong>执行低功耗蓝牙 GATT 服务器功能</strong></p>
<p>您可以使用 <strong>GATT submenu</strong> 选项和 <code>bluetoothctl</code> 命令执行低功耗蓝牙 GATT 服务器功能。</p>
<p>开始之前，请按照<a href="/linux120.github.io/docs/peripherals-and-interfaces#SetforGATTDev">为低功耗蓝牙 GATT 功能设置设备</a>中的说明设置设备。</p>
<p><strong>连接到远程设备</strong></p>
<p>要连接到远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要获取远程设备的蓝牙地址，请运行<a href="/linux120.github.io/docs/peripherals-and-interfaces#startBTGATTscan">蓝牙低功耗 GATT 扫描</a>。</p>
</blockquote></div></div>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>6D:38:AF:C6:B5:62</code> 连接到客户端，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 6D:38:AF:C6:B5:62</span><br></span></code></pre></div></div>
<p><strong>添加主要服务</strong></p>
<a id="addprimary"></a>
<p>要将主服务添加到 GATT 服务器，请从 <code>menu gatt</code> 菜单：运行以下命令</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-service &lt;UUID&gt; [handle]</span><br></span></code></pre></div></div>
<p>示例</p>
<p>如果服务的 UUID 为 <code>FF01</code> 且句柄为 <code>30</code>，则运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-service FF01 30</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0001/char0008]# register-service FF01 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Primary Service (Handle 0x001e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/app/service0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FF01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[/org/bluez/app/service0] Primary (yes/no): yes</span><br></span></code></pre></div></div>
<p><strong>添加一个特征</strong></p>
<p>要向服务器的服务添加特征，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-characteristic &lt;UUID&gt; &lt;Flags=read,write,notify...&gt; [handle]</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;Flags&gt;</code> 是特征的标志值。有关具体值的信息，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#flagvalue">标志值</a>。</p>
<p>示例</p>
<p>服务的 UUID 为 <code>FF02</code>，标志为 <code>read,write,notify</code>，句柄为 <code>31</code>。要添加特征，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-characteristic FF02 read,write,notify 31</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# register-characteristic FF02 read,write,notify 31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Characteristic (Handle 0x001f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/app/service0/chrc0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FF02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;egister-characteristic FF02 read,write,notify 31[/org/bluez/app/service0/chrc0] Enter value: 20</span><br></span></code></pre></div></div>
<p><strong>添加描述符号</strong></p>
<p>要将描述符添加到服务器中的特征，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-descriptor &lt;UUID&gt; &lt;Flags=read,write...&gt; [handle]</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;Flags&gt;</code> 是描述符的标志值。有关具体值的信息，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#flagvalue">标志值</a>。</p>
<p>示例</p>
<p>服务的 UUID 为 <code>FF03</code>，标志为 <code>read,write</code>，句柄为 <code>33</code>。要添加描述符，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-descriptor FF03 read,write 33</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# register-descriptor FF03 read,write 33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Descriptor (Handle 0x0021)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /org/bluez/app/service0/chrc0/desc0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FF03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;egister-descriptor FF03 read,write 33[/org/bluez/app/service0/chrc0/desc0] Enter value: 21</span><br></span></code></pre></div></div>
<p><strong>添加包含的服务</strong></p>
<p>开始之前，将所需服务添加为<a href="/linux120.github.io/docs/peripherals-and-interfaces#addprimary">主要服务</a>。</p>
<p>要将包含的服务添加到其他服务，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-includes &lt;UUID&gt; &lt;UUID&gt;</span><br></span></code></pre></div></div>
<p>示例</p>
<p>考虑两个主要服务，其 UUID 分别为 <code>FF01</code> 和 <code>1112</code>。要将服务 <code>1112</code> 添加为服务 <code>FF01</code> 中包含的服务，请运行以下命令：</p>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# register-includes FF01 1112</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Primary Service (Handle 0x001e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/app/service0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FF01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Primary Included Service (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/app/service1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        1112</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Unknown</span><br></span></code></pre></div></div>
<p><strong>注册申请</strong></p>
<p>要发布可用或添加到服务器的服务，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-application [UUID]</span><br></span></code></pre></div></div>
<p>示例</p>
<p>该服务的 UUID 是 <code>FF01</code>。要发布可用或添加到服务器的服务，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">register-application FF01</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MyDeviceB</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># register-application FF01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Secondary Service (Handle 0x0015)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /org/bluez/app/service2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1112</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001200</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111f</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001108</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001800</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001801</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000180a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001112</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Primary Service (Handle 0x0016)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /org/bluez/app/service1    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FF01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001200</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111f</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001108</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001800</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001801</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000180a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000ff01</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001112</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Application registered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001200</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111f</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001108</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001800</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001801</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000180a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000ff01</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span></code></pre></div></div>
<p><strong>开始广播</strong></p>
<p>要启动 GATT 广播，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">advertise on</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MyDeviceB</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># advertise on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E SupportedInstances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x0f (15)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E ActiveInstances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x01 (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Advertising object registered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Tx Power</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Appearance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Discoverable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> on</span><br></span></code></pre></div></div>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要断开客户端与 <code>&lt;bt_address&gt;</code> <code>6D:38:AF:C6:B5:62</code> 的连接，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect 6D:38:AF:C6:B5:62</span><br></span></code></pre></div></div>
<p><strong>标志值</strong></p>
<a id="flagvalue"></a>
<p><code>&lt;Flags&gt;</code> 的值可以为：</p>
<table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>broadcast</td><td>authenticated-signed-writes</td><td>encrypt-authenticated-read</td><td>encrypt-authenticated-notify</td></tr><tr><td>read</td><td>extended-properties</td><td>encrypt-authenticated-write</td><td>secure-notify</td></tr><tr><td>write</td><td>reliable-write</td><td>secure-read</td><td>encrypt-indicate</td></tr><tr><td>write-without-response</td><td>writable-auxiliaries</td><td>secure-write</td><td>encrypt-authenticated-indicate</td></tr><tr><td>notify</td><td>encrypt-read</td><td>authorize</td><td>secure-indicate</td></tr><tr><td>indicate</td><td>encrypt-write</td><td>encrypt-notify</td><td></td></tr></tbody></table>
<ol start="3">
<li><strong>执行低功耗蓝牙 GATT 客户端功能</strong></li>
</ol>
<p>您可以使用 <strong>GATT submenu</strong> 选项和 <code>bluetoothctl</code> 命令执行低功耗蓝牙 GATT 客户端功能。</p>
<p><strong>连接到远程设备</strong></p>
<p>要连接到远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要获取远程设备的蓝牙地址，请运行<a href="/linux120.github.io/docs/peripherals-and-interfaces#startBTGATTscan">蓝牙低功耗 GATT 扫描 </a>。</p>
</blockquote></div></div>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>6D:38:AF:C6:B5:62</code> 连接到服务器设备，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 6D:38:AF:C6:B5:62</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect 6D:38:AF:C6:B5:62</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 6D:38:AF:C6:B5:62</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 6D:38:AF:C6:B5:62 Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Primary Service (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00001801-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Generic Attribute Profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002a05-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service Changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b3a-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Server Supported Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b29-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client Supported Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0008</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b2a-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Database Hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 6D:38:AF:C6:B5:62 UUIDs: 00001800-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 6D:38:AF:C6:B5:62 UUIDs: 00001801-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 6D:38:AF:C6:B5:62 ServicesResolved: yes</span><br></span></code></pre></div></div>
<p><strong>启动低功耗蓝牙 GATT 扫描</strong></p>
<a id="startBTGATTscan"></a>
<p>请从 <code>bluetoothctl</code> 菜单中运行以下命令，以便启动低功耗蓝牙 GATT 扫描：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scan le</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要获取扫描结果，远程设备必须使用任何蓝牙低功耗应用程序进行公布。</p>
</blockquote></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MyDeviceB</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># scan le</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Discovery started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Controller 22</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">22:9B:2C:79:1E Discovering</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device F8</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">7D:76:9D:9B:6B RSSI</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-70</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">NEW</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">7A</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">EE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">AF</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">EF </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">TV</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> MyDeviceA (43)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">NEW</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 52</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">2F</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">07</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">6F</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">AA</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">93 52</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2F</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">07</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">6F</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">AA</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">93</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0075</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42 04 01 01 e7 a4 30 7a ee af ef a6 30 7a ee af B</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.. 0z</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.0z</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ee 01 3b 00 00 00 00 00                          </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF Modalias</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bluetooth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v04E8p8080d0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110c</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110e</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001112</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000111f</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001200</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0075</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42 04 01 01 e7 a4 30 7a ee af ef a6 30 7a ee af B</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.. 0z</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.0z</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ee 01 3b 00 00 00 00 00                          </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xff19</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 00 75 00 09 01 00 00 00 06 01 00 00 00 00 00 00 .u</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 00 00 00 00 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device F8</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">7D:76:9D:9B:6B RSSI</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">-60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0075</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42 04 01 20 e7 20 0d 00 02 01 2b 01 01 00 01 00 B .. </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.. </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 00 00 00 00 00 00 00 00                        </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xff19</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device A4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">30:7A:EE:AF:EF ManufacturerData Value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 00 75 00 09 01 00 00 00 06 01 00 00 00 00 00 00  .u</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 00 00 00 00 00 00 00 00                            </span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">NEW</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 4A</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">04</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">87</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">DF</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">CB</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">35 4A</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">04</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">87</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">DF</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">CB</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">35</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DEL</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 52</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">2F</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">07</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">6F</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">AA</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">93 52</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2F</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">07</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">6F</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">AA</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">93</span><br></span></code></pre></div></div>
<p><strong>停止蓝牙低功耗 GATT 扫描</strong></p>
<p>请从 <code>bluetoothctl</code> 菜单中运行以下命令，以便停止蓝牙低功耗 GATT 扫描：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scan off</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# scan off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Discovery stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device A4:30:7A:EE:AF:EF RSSI is nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device F8:7D:76:9D:9B:6B RSSI is nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:9B:2C:79:1E Discovering: no</span><br></span></code></pre></div></div>
<p><strong>获取属性列表</strong></p>
<p>要获取远程设备的属性列表，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">list-attributes &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的地址。</p>
<p>示例</p>
<p>要列出地址为 <code>6D:38:AF:C6:B5:62</code> 的远程设备的属性，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">list-attributes 6D:38:AF:C6:B5:62</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# list-attributes 6D:38:AF:C6:B5:62</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Primary Service (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00001801-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Generic Attribute Profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002a05-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service Changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b3a-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Server Supported Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b29-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client Supported Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic (Handle 0x0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /org/bluez/hci0/dev_6D_38_AF_C6_B5_62/service0001/char0008</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        00002b2a-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Database Hash</span><br></span></code></pre></div></div>
<p><strong>获取属性信息</strong></p>
<p>要获取属性的信息，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute-info &lt;attribute/UUID&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;attribute/UUID&gt;</code> UUID 或属性路径。</p>
<p>示例</p>
<p>要获取 UUID <code>00002b29-0000-1000-8000-00805f9b34fb</code> 的属性信息，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute-info 00002b29-0000-1000-8000-00805f9b34fb</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# attribute-info 00002b29-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic - Client Supported Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UUID: 00002b29-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Service: /org/bluez/hci0/dev_73_F4_3F_FA_0A_DF/service0001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Flags: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Flags: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MTU: 0x0205</span><br></span></code></pre></div></div>
<p><strong>选择一个属性</strong></p>
<a id="selectattr"></a>
<p>要使用 UUID 或路径选择属性，请从 <code>menu gatt</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select-attribute &lt;attribute/UUID&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;attribute/UUID&gt;</code> UUID 或属性路径。</p>
<p>示例</p>
<ul>
<li>要使用 UUID <code>00006677-0000-1000-8000-00805f9b34fb</code> 选择属性，请运行以下命令：</li>
</ul>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select-attribute 00006677-0000-1000-8000-00805f9b34fb</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Characteristic User Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# select-attribute 00006677-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;lect-attribute 00006677-0000-1000-8000-00805f9b34fb[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span></code></pre></div></div>
<p>要使用属性路径 <em>/org/bluez/hci0/dev_6C_5F_B9_ED_5B_48/service0001/char0002</em> 选择属性，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select-attribute /org/bluez/hci0/dev_6C_5F_B9_ED_5B_48/service0001/char0002</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0001/char0004]# ED_5B_48/service0001/char0002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0001/char0002]#</span><br></span></code></pre></div></div>
<p><strong>读取特征值</strong></p>
<p>要读取特征值，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令读取所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">read 0</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]#</span><br></span></code></pre></div></div>
<p><strong>写入特征值</strong></p>
<p>要写入特征值，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令将值写入所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;&lt;value&gt;&quot;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>value</code> 为待写入值。</p>
<p>示例</p>
<p>要将属性值写入 0x11，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;0x11&quot;</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# read 0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# write &quot;0x11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to write /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_64_8C_C7_03_C4_B0/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]#</span><br></span></code></pre></div></div>
<p><strong>读取描述符值</strong></p>
<p>要读取描述符值，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令读取所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">read 0</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# select-attribute 00006677-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;lect-attribute 00006677-0000-1000-8000-00805f9b34fb[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]# write &quot;0x11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to write /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0829/desc002c]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span></code></pre></div></div>
<p><strong>写入描述符值</strong></p>
<p>要写入描述符值，请从 menu gatt 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令将值写入所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;&lt;value&gt;&quot;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>value</code> 为待写入值。</p>
<p>示例</p>
<p>要将属性值写入 0x11，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;0x11&quot;</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# select-attribute 00006677-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;lect-attribute 00006677-0000-1000-8000-00805f9b34fb[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]# write &quot;0x11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to write /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0829/desc002c]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_55_B1_D2_67_7C_CD/service0028/char0029/desc002c Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029/desc002c]#</span><br></span></code></pre></div></div>
<p><strong>读取加密的特征值</strong></p>
<p>要读取加密的特征值，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令读取所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">read 0</span><br></span></code></pre></div></div>
<ol start="3">
<li>当提示确认读数时，输入 yes。</li>
</ol>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# read 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to read /org/bluez/hci0/dev_4F_A4_EC_0D_D2_F2/service0028/char0029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Device 60:A3:37:5A:35:5F 60-A3-37-5A-35-5F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Device 60:A3:37:5A:35:5F 60-A3-37-5A-35-5F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request confirmation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[agent] Confirm passkey 161326 (yes/no): yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_4F_A4_EC_0D_D2_F2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Address: D4:8A:39:78:27:41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 AddressType: public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Bonded: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Paired: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Class: 0x005a020c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Icon: phone</span><br></span></code></pre></div></div>
<p><strong>写入加密的特征值</strong></p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令将值写入所选属性：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;&lt;value&gt;&quot;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>value</code> 为待写入值。</p>
<p>示例</p>
<p>要将属性值写入 0x11，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">write &quot;0x11&quot;</span><br></span></code></pre></div></div>
<ol start="3">
<li>当提示确认写入时，输入 yes。</li>
</ol>
<p><strong>打开属性通知</strong></p>
<p>要打开某个属性的通知，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令启用属性通知：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">notify on</span><br></span></code></pre></div></div>
<p>如果属性发生任何更改，所有用户均会收到通知。</p>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# notify on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Notifying: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Notify started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  55                                            U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  88                                            .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  55 55                                         UU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 RSSI: -74</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  55                                            U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11                                            U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Value:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  66                                            f</span><br></span></code></pre></div></div>
<p><strong>关闭属性通知</strong></p>
<p>要关闭某个属性的通知，请从 <code>menu gatt</code> 菜单执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectattr">选择所需的属性</a>。</li>
<li>通过运行以下命令禁用该属性的通知：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">notify off</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB:/service0028/char0029]# notify off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Attribute /org/bluez/hci0/dev_44_38_FB_67_B2_E2/service0028/char0029 Notifying: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Notify stopped</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="基于-gatt-配置文件的-human-interface-device">基于 GATT 配置文件的 Human Interface Device<a href="#基于-gatt-配置文件的-human-interface-device" class="hash-link" aria-label="Direct link to 基于 GATT 配置文件的 Human Interface Device" title="Direct link to 基于 GATT 配置文件的 Human Interface Device">​</a></h5>
<p>HOGP(HID over GATT)是由 Bluetooth SIG 维护的蓝牙配置文件规范，通过低功耗蓝牙实现 HID 的配置文件并作为与计算器之间的接口，消除 HID 中对电线或物理连接的需求。</p>
<p>HOGP 定义低功耗蓝牙无线通信设备如何使用 GATT 通过低功耗蓝牙协议栈支持 HID 服务。</p>
<ol>
<li>
<p><strong>设置 HOGP 功能的设备</strong></p>
<ul>
<li>
<p><strong>前提条件</strong></p>
<ul>
<li>将 DUT 和远程设备放置在蓝牙附近。</li>
</ul>
</li>
<li>
<p>步骤</p>
</li>
</ul>
<ol>
<li>在终端通过运行以下命令打开蓝牙测试应用程序：</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<p>用户可以通过 bluetoothctl 的主菜单选项执行一些 GATT 功能，例如连接和扫描。</p>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# bluetoothctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Agent registered        uetoothd...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Pairable: yes</span><br></span></code></pre></div></div>
<ol start="2">
<li>运行以下命令，启用蓝牙：</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">power on</span><br></span></code></pre></div></div>
</li>
</ol>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# power on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Class: 0x007c0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing power on succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Powered: yes</span><br></span></code></pre></div></div>
<p>关于 HOGP 功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#performBTHOGP">执行蓝牙 HOGP 功能</a>。</p>
<ol start="2">
<li><strong>执行蓝牙 HOGP 功能</strong></li>
</ol>
<a id="performBTHOGP"></a>
<p>可以使用 <code>bluetoothctl</code> 选项和 evtest 工具执行 HOGP 功能。</p>
<p><strong>连接远程设备</strong></p>
<a id="conenctRMT"></a>
<p>要连接远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p><strong>参数</strong></p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p><strong>示例</strong></p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>30:73:00:41:22:49</code> 连接到已配对的远程设备，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 30:73:00:41:22:49</span><br></span></code></pre></div></div>
<p><strong>示例输出</strong></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bluetooth</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># connect 30:73:00:41:22:49</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">73</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">00</span><span class="token punctuation" style="color:#393A34">:</span><span class="token datetime number" style="color:#36acaa">41:22:49</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 Connected</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 Modalias</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> usb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v04E8p7021d0001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001124</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 UUIDs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 00001200</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 ServicesResolved</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Device 30</span><span class="token punctuation" style="color:#393A34">:</span><span class="token key atrule" style="color:#00a4db">73:00:41:22:49 WakeAllowed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span></code></pre></div></div>
<p><strong>验证 HOGP 功能</strong></p>
<p>evtest 工具是一个用于验证 HOGP 功能的开源工具。它监视和查询输入设备（例如鼠标或键盘）的设备事件。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>evtest 工具在用户编译时不可用。要验证 HOGP 功能，请从开源编译该工具并将其推送到 DUT（被测设备）。</p>
</blockquote></div></div>
<p>示例：</p>
<p>要验证蓝牙无线鼠标的功能，请执行以下操作：</p>
<ol>
<li>
<p>打开蓝牙无线鼠标。</p>
</li>
<li>
<p>在蓝牙无线鼠标的 DUT 上运行<a href="/linux120.github.io/docs/peripherals-and-interfaces#startBTGATTscan">低能耗扫描 </a>。</p>
</li>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#conenctRMT">将 DUT 连接</a>至蓝牙无线鼠标。</p>
</li>
<li>
<p>在 SSH 中运行 evtest 工具。</p>
</li>
<li>
<p>从屏幕上显示的已连接输入设备列表中选择蓝牙无线鼠标。</p>
</li>
<li>
<p>使用鼠标执行不同的操作，例如单击、滚动、拖动和移动。</p>
</li>
<li>
<p>验证屏幕上打印的每个操作的事件。</p>
</li>
</ol>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p><strong>参数</strong></p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p><strong>示例</strong></p>
<p>要断开与 <code>&lt;bt_address&gt;</code> <code>30:73:00:41:22:49</code> 配对的远程设备，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect 30:73:00:41:22:49</span><br></span></code></pre></div></div>
<p><strong>示例输出</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110b-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110c-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110e-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 ServicesResolved: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Bonded: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Paired: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 State: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0040 (64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 State: idle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0044 (68)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0040 (64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]#</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="高级音频分发配置文件">高级音频分发配置文件<a href="#高级音频分发配置文件" class="hash-link" aria-label="Direct link to 高级音频分发配置文件" title="Direct link to 高级音频分发配置文件">​</a></h5>
<p>A2DP 定义了如何通过蓝牙连接将多媒体音频从一台设备传输至另一台设备。这种机制也称为蓝牙音频流。</p>
<p>要执行 A2DP 的发送或接收功能，必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的 A2DP 功能</strong></li>
</ol>
<a id="SetA2DP"></a>
<p>前提条件</p>
<ul>
<li>将 DUT 和远程设备放置在蓝牙附近。</li>
</ul>
<p>步骤</p>
<ol>
<li>通过运行以下命令打开蓝牙测试应用程序：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# bluetoothctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Agent registered        uetoothd...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Controller 22:22:F1:C1:99:C0 Pairable: yes</span><br></span></code></pre></div></div>
<ol start="2">
<li>根据需要转至 Transport submenu 或 Player submenu。</li>
</ol>
<ul>
<li>请从 <code>bluetoothctl</code> 运行以下命令，以便转至 Transport submenu。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">menu transport</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# menu transport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu transport:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available transports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show &lt;transport&gt;                                  Transport information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">acquire &lt;transport&gt;                               Acquire Transport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">release &lt;transport&gt;                               Release Transport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;transport&gt; &lt;filename&gt;                       Send contents of a file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">receive &lt;transport&gt; [filename]                    Get/Set file to receive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volume &lt;transport&gt; [value]                        Get/Set transport volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">back                                              Return to main menu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span></code></pre></div></div>
<p>要在源中执行 <strong>Transport submenu</strong> 功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#BTADPsource">执行蓝牙 A2DP 发送功能</a>。
要在接收端中执行 <strong>Transport submenu</strong> 功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#BTADPsink">执行蓝牙 A2DP 接收端功能</a>。</p>
<ul>
<li>请从 bluetoothctl 运行以下命令，以便转至 Player submenu。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">menu player</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# menu player</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu player:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available players</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [player]                                     Player information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;player&gt;                                   Select default player</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">play [item]                                       Start playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pause                                             Pause playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop                                              Stop playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">next                                              Jump to next item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">previous                                          Jump to previous item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fast-forward                                      Fast forward playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rewind                                            Rewind playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">equalizer &lt;on/off&gt;                                Enable/Disable equalizer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">repeat &lt;singletrack/alltrack/group/off&gt;           Set repeat mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shuffle &lt;alltracks/group/off&gt;                     Set shuffle mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scan &lt;alltracks/group/off&gt;                        Set scan mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">change-folder &lt;item&gt;                              Change current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list-items [start] [end]                          List items of current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">search &lt;string&gt;                                   Search items containing string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">queue &lt;item&gt;                                      Add item to playlist queue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show-item &lt;item&gt;                                  Show item information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">back                                              Return to main menu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span></code></pre></div></div>
<p>要在接收端中执行 <strong>Player submenu</strong> 功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#BTADPsink">执行蓝牙 A2DP 接收端功能</a>。</p>
<ul>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#BTADPsource">执行蓝牙 A2DP 发送功能</a>
用户可以使用 <code>bluetoothctl</code> 菜单、 <code>menu transport</code> 子菜单和 <code>paplay</code> 命令执行蓝牙 A2DP 发送功能。</p>
</li>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#BTADPsink">执行蓝牙 A2DP 接收端功能</a>
用户可以使用 <code>bluetoothctl</code> 菜单、 <code>menu transport</code> 子菜单和 <code>menu player</code> 子菜单执行蓝牙 A2DP 接收端功能。</p>
</li>
</ul>
<ol start="2">
<li><strong>执行蓝牙 A2DP 发送功能</strong></li>
</ol>
<a id="BTADPsource"></a>
<p>用户可以使用 <code>bluetoothctl</code> 菜单、 <code>menu transport</code> 子菜单和 <code>paplay</code> 命令执行蓝牙 A2DP 发送功能。</p>
<p>开始之前，请设置设备并转至<a href="/linux120.github.io/docs/peripherals-and-interfaces#SetA2DP">设置设备的 A2DP 功能</a>中所述的所需菜单。</p>
<p><strong>连接远程设备</strong></p>
<p>要以 A2DP 发送端角色连接远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>17:1A:35:8D:A2:A4</code> 连接到已配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 17:1A:35:8D:A2:A4</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110b-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110c-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 UUIDs: 0000110e-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 ServicesResolved: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Bonded: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Paired: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 State: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0040 (64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 State: idle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0044 (68)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0040 (64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]#</span><br></span></code></pre></div></div>
<p><strong>列出可用的传输</strong></p>
<p>要列出可用的传输，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">list</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]# list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><br></span></code></pre></div></div>
<p><strong>获取有关 Codec 功能的信息</strong></p>
<p>要获取有关传输 codec 功能的信息，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show &lt;transport&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;transport&gt;</code> 为传输路径。</p>
<p>示例</p>
<p>要获取有关 <code>&lt;transport&gt;</code> <code>/org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</code> codec 功能的信息，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MySoundbar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># show /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">UUID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Codec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x00 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x21 (33)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x15 (21)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x02 (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x35 (53)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Device</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /org/bluez/hci0/dev_17_1A_35_8D_A2_A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">State</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> idle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Volume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x0040 (64)</span><br></span></code></pre></div></div>
<p><strong>设置绝对音量</strong></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>确保 DUT 和远程设备支持 <code>setabsvolume</code> 功能。</p>
</blockquote></div></div>
<p>要设置传输的绝对音量，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">volume &lt;transport&gt; [value]</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;transport&gt;</code> 为传输路径。</p>
</li>
<li>
<p><code>[value]</code> 是音量大小。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <code>&lt;transport&gt;</code> <code>/org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0</code> 的绝对音量设置为 <code>50</code>，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">volume /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 50</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]# volume /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing Volume succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 Volume: 0x0032 (50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]# volume /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd0 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing Volume succeeded</span><br></span></code></pre></div></div>
<p><strong>播放音频文件</strong></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ul>
<li>
<p>DUT 不支持音频播放器。使用 <code>paplay</code> 命令播放音乐。</p>
</li>
<li>
<p>仅支持 PCM 音频样本。</p>
</li>
</ul>
</blockquote></div></div>
<p>要播放 DUT 中的歌曲，请执行以下操作：</p>
<ol>
<li>
<p>运行 SSH。</p>
</li>
<li>
<p>通过运行以下命令播放 WAV 文件：</p>
</li>
</ol>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay &lt;audio_filepath&gt; -v</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;audio_filepath&gt;</code> 是 WAV 文件的文件路径。</p>
<p>示例</p>
<p>要播放 <em>/tmp/pcmtest.wav</em> 处的 WAV 文件，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay /tmp/pcmtest.wav -v</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.1</span><span class="token comment" style="color:#999988;font-style:italic"># paplay /tmp/pcmtest.wav -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opening a playback stream </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> sample specification </span><span class="token string" style="color:#e3116c">&#x27;s16le 2ch 44100Hz&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> channel </span><span class="token builtin">map</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;front-left,front-right&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection established</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Strean successfully created</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Buffer metrics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> maxlength</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4194304</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tlength</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">352800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prebuf</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">349276</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> minreq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3528</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using sample spec </span><span class="token string" style="color:#e3116c">&#x27;s16le 2ch 44100Hz&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> channel </span><span class="token builtin">map</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;front-left,front-right&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to device bluez_sink</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">20_19_D8_36_90_40</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a2dp_sink </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> suspended</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> no</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream started</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.427</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> Latency</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2042656</span><span class="token plain"> usec</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<p><strong>获取接收端列表</strong></p>
<p>要在连接多个设备时获取接收端列表，请在 SSH中运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pactl list sinks short</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# pactl list sinks short</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 low-latency0    module-pal-card.c    s16le 2ch 48000Hz    SUSPENDED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 deep-buffer0    module-pal-card.c    s16le 2ch 48000Hz    SUSPENDED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 offload0        module-pal-card.c    s16le 2ch 48000Hz    SUSPENDED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3 voip-rx0        module-pal-card.c    s16le 2ch 48000Hz    SUSPENDED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4 bluez_sink.20_19_D8_36_90_40.a2dp_sink    module-bluez5-device.c    s16le 2ch 44100Hz    SUSPENDED</span><br></span></code></pre></div></div>
<p><strong>在特定接收端上播放音频</strong></p>
<p>要在连接多个设备时在特定接收端上播放音频，请在 SSH中运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay &lt;audio_filepath&gt; --device=&lt;device_name&gt; -v</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;audio_filepath&gt;</code> 是 WAV 文件的文件路径。</p>
</li>
<li>
<p><code>&lt;device_name&gt;</code> 是接收端名称。</p>
</li>
</ul>
<p>示例</p>
<p>要在 <code>bluez_sink.20_19_D8_36_90_40.a2dp_sink</code> 接收端上播放 <em>pcmtest.wav</em>，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay pcmtest.wav --device=bluez_sink.20_19_D8_36_90_40.a2dp_sink -v</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.1</span><span class="token comment" style="color:#999988;font-style:italic"># paplay pcmtest.wav --device=bluez_sink.20_19_D8_36_90_40.a2dp_sink -v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opening a playback stream </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> sample specification </span><span class="token string" style="color:#e3116c">&#x27;s16le 2ch 44100Hz&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> channel map </span><span class="token string" style="color:#e3116c">&#x27;front-left,front-right&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection established</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream successfully created</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Buffer metrics: maxlength</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4194304</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tlength</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">352800</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prebuf</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">349276</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> minreq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3528</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Using</span><span class="token plain"> sample spec </span><span class="token string" style="color:#e3116c">&#x27;s16le 2ch 44100Hz&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> channel map </span><span class="token string" style="color:#e3116c">&#x27;front-left,front-right&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> device bluez_sink</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">20</span><span class="token plain">_19_D8_36_90_40</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a2dp_sink </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">index</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> suspended: </span><span class="token keyword" style="color:#00009f">no</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream started</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Time</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">2.925</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> Latency: </span><span class="token number" style="color:#36acaa">2062081</span><span class="token plain"> usec</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要断开与 <code>&lt;bt_address&gt;</code> <code>17:1A:35:8D:A2:A4</code> 配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect 17:1A:35:8D:A2:A4</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MySoundbar]# disconnect 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to disconnect from 17:1A:35:8D:A2:A4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transport /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1/fd2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_17_1A_35_8D_A2_A4/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 ServicesResolved: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successful disconnected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 17:1A:35:8D:A2:A4 Connected: no</span><br></span></code></pre></div></div>
<ul>
<li>执行蓝牙 A2DP 接收端功能</li>
</ul>
<a id="BTADPsink"></a>
<p>用户可以使用 <code>bluetoothctl</code> 菜单、 <code>menu transport</code> 子菜单和 <code>menu player</code> 子菜单执行蓝牙 A2DP 接收端功能。</p>
<p>开始之前，请设置设备并转至<a href="/linux120.github.io/docs/peripherals-and-interfaces#SetA2DP">设置设备的 A2DP 功能</a>中所述的所需菜单。</p>
<p><strong>连接远程设备</strong></p>
<p>要连接远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>D4:8A:39:78:27:41</code> 连接到已配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect D4:8A:39:78:27:41</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect D4:8A:39:78:27:41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to D4:8A:39:78:27:41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 ServicesResolved: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Repeat: off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Shuffle: off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Title: Not Provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 TrackNumber: 0x00000001 (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 NumberOfTracks: 0x00000001 (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Duration: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Album:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Artist:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Genre:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 Volume: 0x004d (77)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: pending</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: playing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: idle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]#</span><br></span></code></pre></div></div>
<p><strong>列出可用的传输</strong></p>
<p>要列出可用的传输，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">list</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</span><br></span></code></pre></div></div>
<p><strong>获取有关 codec 功能的信息</strong></p>
<p>要获取有关传输 codec 功能的信息，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show &lt;transport&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;transport&gt;</code> 为传输路径。</p>
<p>示例</p>
<p>要获取有关 <code>&lt;transport&gt;</code> <code>/org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</code> codec 功能的信息，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MyDeviceB</span><span class="token punctuation" style="color:#393A34">]</span><span class="token comment" style="color:#999988;font-style:italic"># show /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">UUID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0000110b</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">8000</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Codec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x00 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x21 (33)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x15 (21)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x02 (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x35 (53)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Device</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /org/bluez/hci0/dev_D4_8A_39_78_27_41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">State</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Volume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0x007f (127)</span><br></span></code></pre></div></div>
<p><strong>设置绝对音量</strong></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>确保 DUT 和远程设备支持 <code>setabsvolume</code> 功能。</p>
</blockquote></div></div>
<p>要设置传输的绝对音量，请从 <code>menu transport</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">volume &lt;transport&gt; [value]</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;transport&gt;</code> 为传输路径。</p>
</li>
<li>
<p><code>[value]</code> 是音量大小。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <code>&lt;transport&gt;</code> <code>/org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2</code> 的绝对音量设置为 <code>0</code>，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">volume /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 0</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;me /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing Volume succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 Volume: 0x0000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;me /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing Volume succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 Volume: 0x0064 (100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing Volume succeeded</span><br></span></code></pre></div></div>
<p><strong>播放音频文件</strong></p>
<p>要播放音频文件，请从 <code>menu player</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">play [item]</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# play</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to play</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Play successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: pending</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x000cc8b9 (837817)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: playing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x000cc932 (837938)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]#</span><br></span></code></pre></div></div>
<p><strong>暂停播放</strong></p>
<p>请从 <code>menu player</code> 子菜单运行以下命令，以便暂停播放：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pause</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# pause</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to pause</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pause successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x000cc888 (837768)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: paused</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x000cc888 (837768)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: idle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]#</span><br></span></code></pre></div></div>
<p><strong>停止播放</strong></p>
<p>请从 <code>menu player</code> 子菜单中运行以下命令，以便停止播放：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stop</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stop successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd2 State: idle</span><br></span></code></pre></div></div>
<p><strong>播放下一个音频文件</strong></p>
<p>要播放下一个音频文件，请从 <code>menu player</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">next</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to jump to next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Next successful</span><br></span></code></pre></div></div>
<p><strong>播放上一个音频文件</strong></p>
<p>要播放上一个音频文件，请从 <code>menu player</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">previous</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# previous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to jump to previous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Previous successful</span><br></span></code></pre></div></div>
<p><strong>快进播放</strong></p>
<p>要快进播放，请从 <code>menu player</code> 子菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fast-forward</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# fast-forward</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fast forward playback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FastForward successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Status: forward-seek</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 Position: 0x00000000 (0)</span><br></span></code></pre></div></div>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要断开与 <code>&lt;bt_address&gt;</code> <code>D4:8A:39:78:27:41</code> 配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect D4:8A:39:78:27:41</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceB]# disconnect D4:8A:39:78:27:41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to disconnect from D4:8A:39:78:27:41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Player /org/bluez/hci0/dev_D4_8A_39_78_27_41/player0 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transport /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1/fd1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_D4_8A_39_78_27_41/sep5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 ServicesResolved: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successful disconnected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device D4:8A:39:78:27:41 Connected: no</span><br></span></code></pre></div></div>
<p><strong>其他播放器功能</strong></p>
<p><code>menu player</code> 子菜单提供其他功能，使用户能够：</p>
<ul>
<li>
<p>随机播放曲目</p>
</li>
<li>
<p>快退音频文件</p>
</li>
<li>
<p>重复播放单个曲目、所有曲目或播放列表</p>
</li>
<li>
<p>打开或关闭均衡器</p>
</li>
<li>
<p>搜索曲目</p>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="免提配置文件">免提配置文件<a href="#免提配置文件" class="hash-link" aria-label="Direct link to 免提配置文件" title="Direct link to 免提配置文件">​</a></h5>
<p>HFP 定义音频网关设备如何连接至免提设备以实现远程控制和音频连接等功能。</p>
<p>要执行 HFP 客户端或音频网关功能，用户必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的 HFP 功能</strong></li>
</ol>
<a id="HFPinit"></a>
<p>前提条件</p>
<ul>
<li>将 DUT 和远程设备放置在蓝牙附近。</li>
</ul>
<p>根据需要配置 DUT 的 HFP <a href="/linux120.github.io/docs/peripherals-and-interfaces#configHFPclient">客户端</a>或<a href="/linux120.github.io/docs/peripherals-and-interfaces#ConfigHFPgtw">音频网关</a>功能。</p>
<p><strong>配置 DUT 的 HFP 客户端功能</strong></p>
<a id="configHFPclient"></a>
<p>在为 HFP 功能进行<a href="/linux120.github.io/docs/peripherals-and-interfaces#HFPinit">初始设备设置</a>后，请对 HFP 客户端执行以下操作：</p>
<ol>
<li>通过在 SSH 中运行以下命令来验证 ofono 服务的状态：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> systemctl status ofono</span><br></span></code></pre></div></div>
<ol start="2">
<li>在文本编辑器中打开 <em>/etc/pulse/</em> 目录中的脉冲配置文件 <em>system.pa</em>。</li>
<li>将 headset=ofono 添加至文件中的以下行：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> Load module bluetooth discover</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> load-module module-bluetooth-discover headset=ofono</span><br></span></code></pre></div></div>
<p>该文件必须如下所示：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ### Load module bluetooth discover</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> load-module module-bluetooth-discover headset=ofono</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ### Load module bluetooth policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> load-module module-bluetooth-policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sh-5.1#</span><br></span></code></pre></div></div>
<ol start="4">
<li>保存该文件。</li>
<li>通过运行以下命令重新加载守护进程：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> systemctl daemon-reload</span><br></span></code></pre></div></div>
<ol start="6">
<li>通过运行以下命令重新启动 PulseAudio：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart pulseaudio</span><br></span></code></pre></div></div>
<ol start="7">
<li>重新加载守护程序并重新启动 PulseAudio 后，<em>system.pa</em> 配置文件中的更改会在系统中反映。使用 DBUS 在 PulseAudio 和 ofono 之间建立连接。</li>
<li>通过在 SSH 中运行以下命令来运行 bluetoothctl：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<ol start="9">
<li>通过从 bluetoothctl 菜单运行以下命令来验证是否列出了免提客户端设备的 UUID：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Controller 22:22:9B:2C:79:1E (public)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name: qcm6490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Alias: qcm6490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Class: 0x002c0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Powered: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Discoverable: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DiscoverableTimeout: 0x000000b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pairable: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: A/V Remote Control        (e000110e-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: PnP Information           (e0001200-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Audio Source              (e000110a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Audio Sink                (e000110b-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: A/V Remote Control Target (0000110c-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Generic Access Profile    (e0001800-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Generic Attribute Profile (00001801-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Device Information        (0000180a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID: Handsfree                 (e000111e-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Modalias: usb:v1D6Bp0246d0541</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Discovering: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Roles: central</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Roles: peripheral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Advertising Features:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ActiveInstances: 0x00 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedInstances: 0x10 (16)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedIncludes: tx-power</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedIncludes: appearance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedIncludes: local-name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedSecondaryChannels: 1M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedSecondaryChannels: 2M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SupportedSecondaryChannels: Coded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]#</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>免提音频网关和耳机 UUID 未列出。仅列出从 PulseAudio 配置的免提客户端 UUID。</p></div></div>
<ol start="10">
<li>在 SSH 中运行以下命令打开 <em>ofono/test</em> 菜单：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ls -rt /usr/lib/ofono/test</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>ofono/test 应用程序仅在 <code>qcom-multimedia-test-image</code> 中可用。要在用户版本上运行 ofono/test 应用程序，用户必须对其进行编译。</p></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ls -rt /usr/lib/ofono/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unlock-pin                 set-ddr                     hangup-call</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-stk-menu              set-context-property        hangup-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-ss-control-cs         set-cbs-topics              hangup-active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-ss-control-cf         set-call-forwarding         get-tech-preference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-ss-control-cb         send-vcard                  get-serving-cell-info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-ss                    send-vcal                   get-operators</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-sms                   send-ussd                   get-icon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-smart-messaging       send-sms                    enter-pin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-serving-cell-info     scan-for-operators          enable-throttling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-push-notification     reset-pin                   enable-modem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-phonebook             remove-contexts             enable-gprs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-network-registration  release-and-swap            enable-cbs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-modem                 release-and-answer          display-icon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-message-waiting       reject-calls                disable-throttling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-gnss                  register-operator           disable-modem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-cbs                   register-auto               disable-gprs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-call-settings         receive-sms                 disable-call-forwarding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-call-forwarding       process-context-settings    dial-number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-call-barring          private-chat                deactivate-context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-advice-of-charge      online-modem                deactivate-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">swap-calls                 offline-modem               create-multiparty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-use-sms-reports        monitor-ofono               create-mms-context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-umts-band              lockdown-modem              create-internet-context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-tty                    lock-pin                    change-pin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-tech-preference        list-operators              cdma-set-credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-speaker-volume         list-modems                 cdma-list-call</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-sms-smsc               list-messages               cdma-hangup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-sms-bearer             list-contexts               cdma-dial-number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-sms-alphabet           list-calls                  cdma-connman-enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-roaming-allowed        list-applications           cdma-connman-disable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-msisdn                 list-allowed-access-points  cancel-ussd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-mms-details            initiate-ussd               cancel-sms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-mic-volume             ims-unregister              backtrace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-lte-property           ims-register                answer-calls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-gsm-band               hold-and-answer             activate-context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set-fast-dormancy          hangup-multiparty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1#</span><br></span></code></pre></div></div>
<p>关于 HFP 客户端功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#performHFPclient">执行蓝牙 HFP 客户端功能</a>。</p>
<p><strong>配置 DUT 的 HFP 音频网关功能</strong></p>
<a id="ConfigHFPgtw"></a>
<p>在为 HFP 功能进行<a href="/linux120.github.io/docs/peripherals-and-interfaces#HFPinit">初始设备设置</a>后，请对 HFP 音频网关执行以下操作：</p>
<ol>
<li>通过在 SSH 中运行以下命令来运行 <code>bluetoothctl</code>:</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<ol start="2">
<li>通过从 <code>bluetoothctl</code> 菜单运行以下命令来验证是否列出了免提音频网关和耳机的 UUID：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Controller 22:22:9B:2C:79:1E (public)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: qcm6490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Alias: qcm6490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Class: 0x006c0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Powered: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Discoverable: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DiscoverableTimeout: 0x000000b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Pairable: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: A/V Remote Control        (0000110a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: PnP Information           (00001200-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Handsfree Audio Gateway   (0000111f-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Audio Sink                (0000110b-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Headset                   (00001108-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: A/V Remote Control Target (0000110c-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Generic Access Profile    (00001800-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Audio Source              (0000110a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Generic Attribute Profile (00001801-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Device Information        (0000180a-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UUID: Handsfree                 (0000111e-0000-1000-8000-00805f9b34fb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Modalias: usb:v1D6Bp0246d0541</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Discovering: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Roles: central</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Roles: peripheral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Advertising Features:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ActiveInstances: 0x00 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedInstances: 0x10 (16)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedIncludes: tx-power</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedIncludes: appearance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedIncludes: local-name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedSecondaryChannels: 1M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedSecondaryChannels: 2M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SupportedSecondaryChannels: Coded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# |</span><br></span></code></pre></div></div>
<p>关于 HFP 音频网关功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#performHFPgtw">执行蓝牙 HFP 音频网关功能</a>。</p>
<ul>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#performHFPclient">执行蓝牙 HFP 客户端功能</a>
可以使用 <code>bluetoothctl</code> 菜单和 <code>ofono/test</code> 工具执行 HFP 客户端功能。</p>
</li>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#performHFPgtw">执行蓝牙 HFP 音频网关功能</a>
用户可以使用 <code>bluetoothctl</code> 菜单和 <code>paplay</code> 命令执行 HFP 音频网关功能。</p>
</li>
</ul>
<ol start="2">
<li><strong>执行蓝牙 HFP 客户端功能</strong></li>
</ol>
<a id="performHFPclient"></a>
<p>可以使用 <code>bluetoothctl</code> 菜单和 <code>ofono/test</code> 工具执行 HFP 客户端功能。</p>
<p>开始之前，请<a href="/linux120.github.io/docs/peripherals-and-interfaces#HFPinit">设置您的设备</a>，并且<a href="/linux120.github.io/docs/peripherals-and-interfaces#configHFPclient">配置 DUT 以实现 HFP 客户端功能</a>。</p>
<p><strong>连接远程设备</strong></p>
<p>要连接远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>F8:7D:76:9D:9B:6B</code> 连接到已配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect F8:7D:76:9D:9B:6B</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]# connect F8:7D:76:9D:9B:6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to F8:7D:76:9D:9B:6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(CHG) Device F8:7D:76:9D:9B:6B Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(NEW) Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(NEW) Endpoint /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transport /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/sep1/fd0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Item /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0/Filesystem /Filesystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW) Item /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0/NowPlaying /NowPlaying</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Type: Audio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Subtype: None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Status: stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Browsable: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Searchable: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Playlist: /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0/NowPlaying</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Name: Music</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Repeat: off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Shuffle: off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Folder /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device F8:7D:76:9D:9B:6B ServicesResolved: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Duration: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Genre:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/blwez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Title:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/blwez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Item: /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player@/NowPlaying/item18446749073709551615</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 TrackNumber: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Artist:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 NumberOfTracks: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG) Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Album:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Item /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0/NowPlaying/item18446744073709551615 &lt;unknown&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Player /org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/player0 Position: 0x00000000 (0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceA]#</span><br></span></code></pre></div></div>
<p><strong>拨打电话号码</strong></p>
<p>要拨打电话号码，请从 <code>ofono/test</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./dial-number &lt;phone_number&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;phone_number&gt;</code> 是您打算拨打的电话号码。</p>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ./dial-number 7123456789</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using modem /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/voicecall01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1#</span><br></span></code></pre></div></div>
<p><strong>接听来电</strong></p>
<p>要接听来电，请从 <code>ofono/test</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./answer-calls</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ./answer-calls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/voicecall01 ] incoming</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# |</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>如果您正在通话，则会听到回声。这是在软件中存在并具有 BlueZ 堆栈的已知行为。</p>
</blockquote></div></div>
<p><strong>列出当前通话</strong></p>
<p>要列出当前通话，请从 <code>ofono/test</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./list-calls</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ./list-calls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/voicecall01 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        State = incoming</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LineIdentification = +917123456789</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Name =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Multiparty = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RemoteHeld = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RemoteMultiparty = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Emergency = 0</span><br></span></code></pre></div></div>
<p><strong>拒绝或挂断电话</strong></p>
<p>要拒绝或断开呼叫，请从 <code>ofono/test</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./hangup-call &lt;call_path&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;call_path&gt;</code> 是当前呼叫的呼叫路径。</p>
<p>示例</p>
<p>要挂断路径 <code>/hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/voicecall01</code> 的呼叫，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./hangup-call /hfp/org/bluez/hci0/dev_F8_7D_76_9D_9B_6B/voicecall01</span><br></span></code></pre></div></div>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要断开与 <code>&lt;bt_address&gt;</code> <code>F8:7D:76:9D:9B:6B</code> 配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect F8:7D:76:9D:9B:6B</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyDeviceA]# disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to disconnect from F8:7D:76:9D:9B:6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device F8:7D:76:9D:9B:6B ServicesResolved: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successful disconnected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device F8:7D:76:9D:9B:6B Connected: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[bluetooth]#</span><br></span></code></pre></div></div>
<ol start="3">
<li><strong>执行蓝牙 HFP 音频网关功能</strong></li>
</ol>
<a id="performHFPgtw"></a>
<p>用户可以使用 <code>bluetoothctl</code> 菜单和 <code>paplay</code> 命令执行 HFP 音频网关功能。</p>
<p>开始之前，请<a href="/linux120.github.io/docs/peripherals-and-interfaces#HFPinit">设置您的设备</a>，并且<a href="/linux120.github.io/docs/peripherals-and-interfaces#ConfigHFPgtw">配置 DUT 以实现 HFP 音频网关功能</a>。</p>
<p><strong>连接远程设备</strong></p>
<p>要连接远程设备，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>20:19:D8:36:90:40</code> 连接到已配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 20:19:D8:36:90:40</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Test]# connect 20:19:D8:36:90:40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 20:19:D8:36:90:40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 Connected: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 UUIDs: 00001108-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 UUIDs: 0000110b-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 UUIDs: 0000110c-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 UUIDs: 0000110e-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 UUIDs: 0000111e-0000-1000-8000-00805f9b34fb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 ServicesResolved: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 Bonded: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 Paired: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Endpoint /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transport /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1/fd1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1/fdl State: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1/fd1 Volume: 0x0068 (104)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transport /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1/fd1 State: idle</span><br></span></code></pre></div></div>
<p><strong>验证音频网关功能</strong></p>
<p>要验证音频网关功能，请执行以下操作：</p>
<ol>
<li>创建一个虚拟 SCO，如下所示：<!-- -->
<ol>
<li>运行 SSH。</li>
<li>通过运行以下命令播放 WAV 文件：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay &lt;file.wav&gt; -v</span><br></span></code></pre></div></div>
</li>
</ol>
<p>示例</p>
<p>要播放 <em>AG_playback.wav</em> 文件，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">paplay AG_playback.wav -v</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# paplay AG_playback.wav -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opening a playback stream with sample specification &#x27;s16le 2ch 8000Hz&#x27; and channel map &#x27;front-left,front-right&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream successfully created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Buffer metrics: maxlength=4194304, tlength=64000, prebuf=63364, minreq=640</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using sample spec &#x27;s16le 2ch 8000Hz&#x27;, channel map &#x27;front-left,front-right&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to device bluez_sink.20_19_D8_36_90_40.handsfree_head_unit (index: 7, suspended: no).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stream started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time: 2.003 sec; Latency: 2042009 usec.</span><br></span></code></pre></div></div>
<ol start="2">
<li>通过运行以下命令从远程设备接收麦克风数据：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">parec -v --rate=&lt;rate&gt; --format=&lt;format&gt; --channels=&lt;channel_number&gt; --file-format=&lt;file_format audio_filepath&gt; --device=&lt;device_name&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<table><thead><tr><th>选项</th><th>参数</th><th>说明</th><th>关于</th></tr></thead><tbody><tr><td><code>--rate</code></td><td><code>&lt;rate&gt;</code></td><td>播放音频文件的特定采样率。</td><td><code>16000</code></td></tr><tr><td><code>--format</code></td><td><code>&lt;format&gt;</code></td><td>播放音频文件的特定样本格式。</td><td><code>s16le</code></td></tr><tr><td><code>--channels</code></td><td><code>&lt;channel_number&gt;</code></td><td>播放音频文件的具体通道数。</td><td><code>1</code></td></tr><tr><td><code>--file-format</code></td><td><code>&lt;file_format audio_filepath&gt;</code></td><td>用于播放目录中的音频文件的文件格式。</td><td><code>wav /data/rec1.wav</code></td></tr><tr><td><code>--device</code></td><td><code>&lt;device_name&gt;</code></td><td>播放音频文件的发送端或接收端的设备名称。</td><td><code>bluez_source.20_19_D8_36_90_40.handsfree_head_unit</code></td></tr></tbody></table>
<p>示例</p>
<p>要从远程设备接收表中列出的示例值的麦克风数据，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">parec -v --rate=16000 --format=s16le --channels=1 --file-format=wav /data/rec1.wav --device=bluez_source.20_19_D8_36_90_40.handsfree_head_unit</span><br></span></code></pre></div></div>
<ol start="3">
<li>播放录制的麦克风数据并验证音频是否清晰</li>
</ol>
<p><strong>断开对端设备的连接</strong></p>
<p>要断开远程设备的连接，请从 <code>bluetoothctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect &lt;bt_address&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
<p>示例</p>
<p>要断开与 <code>&lt;bt_address&gt;</code> <code>20:19:D8:36:90:40</code> 配对的远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">disconnect 20:19:D8:36:90:40</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[MyHeadset]# disconnect 20:19:D8:36:90:40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to disconnect from 20:19:D8:36:90:40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transport /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1/fd2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Endpoint /org/bluez/hci0/dev_20_19_D8_36_90_40/sep1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 ServicesResolved: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successful disconnected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Device 20:19:D8:36:90:40 Connected: no</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="对象推送配置文件">对象推送配置文件<a href="#对象推送配置文件" class="hash-link" aria-label="Direct link to 对象推送配置文件" title="Direct link to 对象推送配置文件">​</a></h5>
<p>OPP 定义两个蓝牙设备如何交换对象，例如名片、图像、壁纸、铃声或视频。</p>
<p>要执行蓝牙 OPP 功能，用户必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的蓝牙 OPP 功能</strong></li>
</ol>
<a id="setOPP"></a>
<p>前提条件</p>
<ul>
<li>将 DUT 和远程设备放置在蓝牙附近。</li>
</ul>
<p>通过运行以下命令打开蓝牙测试应用程序：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obexctl</span><br></span></code></pre></div></div>
<p>要查看 OBEX 功能，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">help</span><br></span></code></pre></div></div>
<p>该命令提供 <strong>obexctl</strong> 的主菜单。要执行 OPP 服务器和客户端功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#perOPPclient">执行蓝牙 OPP 服务器功能</a>和<a href="/linux120.github.io/docs/peripherals-and-interfaces#perOPPserv">执行蓝牙 OPP 客户端功能</a>。</p>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# obexctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Client /org/bluez/obex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;dev&gt; [uuid] [channel]                    Connect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disconnect [session]                              Disconnect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [session]                                    Session information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;session&gt;                                  Select default session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info &lt;object&gt;                                     Object information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cancel &lt;transfer&gt;                                 Cancel transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suspend &lt;transfer&gt;                                Suspend transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resume &lt;transfer&gt;                                 Resume transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;file&gt;                                       Send file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pull &lt;file&gt;                                       Pull Vobject &amp; stores in file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;path&gt;                                         Change current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls &lt;options&gt;                                      List current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source file&gt; &lt;destination file&gt;               Copy source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv &lt;source file&gt; &lt;destination file&gt;               Move source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm &lt;file&gt;                                         Delete file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;folder&gt;                                    Create folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]#</span><br></span></code></pre></div></div>
<ul>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perOPPclient">执行蓝牙 OPP 服务器功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 OPP 服务器功能。</p>
</li>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perOPPserv">执行蓝牙 OPP 客户端功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 OPP 客户端功能。</p>
</li>
</ul>
<ol start="2">
<li><strong>执行蓝牙 OPP 服务器功能</strong></li>
</ol>
<a id="perOPPclient"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 OPP 服务器功能。</p>
<p><strong>以服务器角色接收文件</strong></p>
<p>要以服务器角色接收文件，执行以下操作：</p>
<ol>
<li>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</li>
<li>从远程设备启动到 DUT 的连接。</li>
<li>通过蓝牙共享将任何文件从远程设备发送到 DUT。
传输信息出现在 DUT 的 obexctl 屏幕中。文件将传输到 DUT 并存储在 <em>/var/bluetooth</em> 中。</li>
</ol>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Session /org/bluez/obex/server/session6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/server/session6/transfer5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/server/session6/transfer5 Size: 36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/server/session6/transfer5 Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/server/session6/transfer5 Transferred: 36 (@0KB/s 00:00)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/server/session6/transfer5 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/server/session6/transfer5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Session /org/bluez/obex/server/session6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:75:C2:D2:72]#</span><br></span></code></pre></div></div>
<ol start="3">
<li><strong>执行蓝牙 OPP 客户端功能</strong></li>
</ol>
<a id="perOPPserv"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 OPP 客户端功能。</p>
<p><strong>以客户端角色发送文件</strong></p>
<p>开始之前，请按照<a href="/linux120.github.io/docs/peripherals-and-interfaces#setOPP">设置设备的蓝牙 OPP 功能</a>中的说明设置设备。</p>
<p>以客户端角色发送文件，执行以下操作：</p>
<ol>
<li>通过从 obexctl 菜单运行以下命令连接到远程设备：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt; &lt;profile_name&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>bt_address</code> 是远程设备的蓝牙地址。</p>
<p><code>profile_name</code> 是 opp.</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt; 22:22:5A:A5:56:6B</code> 连接到远程设备，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 22:22:5A:A5:56:6B opp</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# connect 22:22:5A:A5:56:6B opp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 22:22:5A:A5:56:6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Session /org/bluez/obex/client/session1 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] ObjectPush /org/bluez/obex/client/session1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:5A:A5:56:6B]#</span><br></span></code></pre></div></div>
<ol start="2">
<li>在 DUT 的本地目录中创建一个文本文件。</li>
<li>通过从 <code>obexctl</code> 菜单：运行以下命令将此文本文件发送至远程设备</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;filepath&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;filepath&gt;</code> 是文本文件的文件路径。</p>
<p>示例</p>
<p>要发送文本文件 temp.txt /local/mnt/workspace/，可运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">send /local/mnt/workspace/temp.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:5A:A5:56:6B]# send /local/mnt/workspace/temp.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to send /local/mnt/workspace/temp.txt to /org/bluez/obex/client/session1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session1/transfer1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer /org/bluez/obex/client/session1/transfer1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: queued</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: temp.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Size: 36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Filename: /local/mnt/workspace/temp.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Session: /org/bluez/obex/client/session1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session1/transfer1 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/client/session1/transfer1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:5A:A5:56:6B]#</span><br></span></code></pre></div></div>
<ol start="4">
<li>在远程设备上，接受提示以接收文件。</li>
</ol>
<p>文件已成功发送至远程设备。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="文件传输协议">文件传输协议<a href="#文件传输协议" class="hash-link" aria-label="Direct link to 文件传输协议" title="Direct link to 文件传输协议">​</a></h5>
<p>FTP 定义了两个蓝牙设备之间交换文件的要求。</p>
<p>要执行蓝牙 FTP 功能，用户必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的蓝牙 FTP 功能</strong></li>
</ol>
<a id="setFTP"></a>
<p>前提条件</p>
<ul>
<li>确保 DUT 和远程设备支持 BlueZ 堆栈。一台设备充当服务器，另一台设备充当客户端。</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要测试或验证 FTP 服务器功能，无需测试应用程序。通过客户端连接来执行FTP功能。</p>
</blockquote></div></div>
<ul>
<li>
<p>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</p>
</li>
<li>
<p>将 DUT 和远程设备放置在蓝牙附近。</p>
</li>
</ul>
<p>步骤</p>
<ol>
<li>通过运行以下命令打开蓝牙测试应用程序：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obexctl</span><br></span></code></pre></div></div>
<p>要查看 OBEX 功能，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">help</span><br></span></code></pre></div></div>
<p>该命令提供 <strong>obexctl</strong> 的主菜单。</p>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# obexctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Client /org/bluez/obex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;dev&gt; [uuid] [channel]                    Connect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disconnect [session]                              Disconnect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [session]                                    Session information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;session&gt;                                  Select default session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info &lt;object&gt;                                     Object information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cancel &lt;transfer&gt;                                 Cancel transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suspend &lt;transfer&gt;                                Suspend transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resume &lt;transfer&gt;                                 Resume transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;file&gt;                                       Send file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pull &lt;file&gt;                                       Pull Vobject &amp; stores in file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;path&gt;                                         Change current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls &lt;options&gt;                                      List current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source file&gt; &lt;destination file&gt;               Copy source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv &lt;source file&gt; &lt;destination file&gt;               Move source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm &lt;file&gt;                                         Delete file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;folder&gt;                                    Create folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]#</span><br></span></code></pre></div></div>
<ol start="2">
<li>通过从 <code>obexctl</code> 菜单运行以下命令连接到远程设备：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt; &lt;profile_name&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>bt_address</code> 是远程设备的蓝牙地址。</p>
<p><code>profile_name</code> 是 ftp.</p>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt; E8:48:B8:C8:20:00</code> 连接到远程设备，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect E8:48:B8:C8:20:00 ftp</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[E8:48:B8:C8:20:00]# connect E8:48:B8:C8:20:00 ftp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to E8:48:B8:C8:20:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Session /org/bluez/obex/client/session7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] FileTransfer /org/bluez/obex/client/session7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span></code></pre></div></div>
<p>要执行 FTP 客户端功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#perFTP">执行蓝牙 FTP 客户端功能</a>。</p>
<ol start="2">
<li><strong>执行蓝牙 FTP 客户端功能</strong></li>
</ol>
<a id="perFTP"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 FTP 客户端功能。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要测试或验证 FTP 服务器功能，无需测试应用程序。通过客户端连接来执行 FTP 功能。</p>
</blockquote></div></div>
<p>开始之前，请按照<a href="/linux120.github.io/docs/peripherals-and-interfaces#setFTP">设置设备的蓝牙 FTP 功能</a>中的说明设置设备。</p>
<p><strong>创建文件夹</strong></p>
<p>要在远程设备上创建文件夹，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;folder_name&gt;</span><br></span></code></pre></div></div>
<p>用户可以验证服务器上 <em>/var/bluetooth</em> 目录中的文件夹创建情况。</p>
<p>参数</p>
<p><code>&lt;folder_name&gt;</code> 是新文件夹名称。</p>
<p>示例</p>
<p>请运行以下命令，以便创建名为 <em>new_dir</em> 的文件夹：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir new_dir</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#mkdir new_dir</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to CreateFolder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CreateFolder successful</span><br></span></code></pre></div></div>
<p><strong>更改当前文件夹</strong></p>
<a id="changefolder"></a>
<p>要更改远程设备的当前文件夹，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;folder_path&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;folder_path&gt;</code> 是您打算切换至的文件夹。</p>
<p>示例</p>
<p>要将当前文件夹更改为 <em>new_dir</em>，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd new_dir</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#cd new_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to ChangeFolder to new_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ChangeFolder successful</span><br></span></code></pre></div></div>
<p><strong>获取当前文件夹信息</strong></p>
<p>要获取有关当前文件夹的信息，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls .</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ls .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to ListFolder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">NEW</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Transfer /org/bluez/obex/client/session7/transfer4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Transfer /org/bluez/obex/client/session7/transfer4 Size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">611</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">CHG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Transfer /org/bluez/obex/client/session7/transfer4 Status</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> My_folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">User-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RWD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Group-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Other-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Accessed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231214T123503Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Modified</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231214T123502Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Created</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231214T123502Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> new_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">User-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RWD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Group-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Other-perm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Accessed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231215T093311Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Modified</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231215T093245Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Created</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20231215T093245Z</span><br></span></code></pre></div></div>
<p><strong>将文件复制至远程设备</strong></p>
<p>要将本地文件复制到远程设备，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp :&lt;source_file&gt; &lt;destination_file&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;source_file&gt;</code> 是本地文件。</p>
</li>
<li>
<p><code>&lt;destination_file&gt;</code> 是远程设备上的目标文件。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <em>Documents/ftp_client.txt</em> 处的本地文件复制到远程设备上的 <em>ftp_client.txt</em>，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp :Documents/ftp_client.txt ftp_client.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cp :Documents/ftp_client.txt ftp_client.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to PutFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session7/transfer5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer /org/bluez/obex/client/session7/transfer5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Status: queued</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Name: ftp_client.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Size: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Filename: Documents/ftp_client.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Session: /org/bluez/obex/client/session7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session7/transfer5 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/client/session7/transfer5</span><br></span></code></pre></div></div>
<p><strong>从远程设备复制文件</strong></p>
<p>开始之前，<a href="/linux120.github.io/docs/peripherals-and-interfaces#changefolder">将当前文件夹</a>更改为所需文件的文件夹。</p>
<p>要将文件从远程设备复制到本地目录，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;destination_file&gt; :&lt;source_file&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;source_file&gt;</code> 是远程设备上的文件。</p>
</li>
<li>
<p><code>&lt;destination_file&gt;</code> 是本地设备上的目标文件。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <em>ftp_client_2.txt</em> 文件从远程设备复制到本地设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp ftp_client_2.txt :ftp_client_2.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cp ftp_client_2.txt :ftp_client_2.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to GetFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session7/transfer21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer /org/bluez/obex/client/session7/transfer21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Status: queued</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Name: ftp_client_2.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Size: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Filename: ftp_client_2.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Session: /org/bluez/obex/client/session7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session7/transfer21 Size: 13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session7/transfer21 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/client/session7/transfer21</span><br></span></code></pre></div></div>
<p><strong>在远程设备中复制文件</strong></p>
<p>要将文件从远程设备上的一个目录复制到另一个目录，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source_file&gt; &lt;destination_file&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;source_file&gt;</code> 是待复制的文件。</p>
</li>
<li>
<p><code>&lt;destination_file&gt;</code> 为目标位置。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <em>ftp_client.txt</em> 复制到 <em>/new_dir_2/</em>，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp ftp_client.txt ../new_dir_2/ftp_client.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cp ftp_client.txt ../new_dir_2/ftp_client.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to CopyFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CopyFile successful</span><br></span></code></pre></div></div>
<p><strong>移动文件</strong></p>
<p>要将文件从一个文件夹移动到另一个文件夹，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mv &lt;source_file&gt; &lt;destination_file&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;source_file&gt;</code> 是待移动的文件。</p>
</li>
<li>
<p><code>&lt;destination_file&gt;</code> 为目标位置。</p>
</li>
</ul>
<p>示例</p>
<p>要将 <em>ftp_client_2.txt</em> 文件移动到 <em>/new_dir_2/</em>，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mv ftp_client_2.txt ../new_dir_2/ftp_client_2.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#mv ftp_client_2.txt ../new_dir_2/ftp_client_2.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to MoveFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MoveFile successful</span><br></span></code></pre></div></div>
<p><strong>删除文件</strong></p>
<p>要删除文件，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm &lt;filename&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;filename&gt;</code> 是待删除的文件。</p>
<p>示例</p>
<p>要删除 <code>ftp_client.txt</code> 文件，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm ftp_client.txt</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rm ftp_client.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to Delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delete successful</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="电话薄访问配置文件">电话薄访问配置文件<a href="#电话薄访问配置文件" class="hash-link" aria-label="Direct link to 电话薄访问配置文件" title="Direct link to 电话薄访问配置文件">​</a></h5>
<p>PBAP 是一种蓝牙配置文件，支持在远程设备和本地设备之间交换电话簿对象。</p>
<p>要执行蓝牙 PBAP 功能，用户必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的蓝牙 PBAP 功能</strong></li>
</ol>
<a id="setPBAP"></a>
<p>前提条件</p>
<ul>
<li>
<p>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</p>
</li>
<li>
<p>将 DUT 和远程设备放置在蓝牙附近。</p>
</li>
</ul>
<p>通过运行以下命令打开蓝牙测试应用程序：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obexctl</span><br></span></code></pre></div></div>
<p>要查看 OBEX 功能，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">help</span><br></span></code></pre></div></div>
<p>该命令提供 <strong>obexctl</strong> 的主菜单。要执行 PBAP 服务器和客户端功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#perPBAPserv">执行蓝牙 PBAP 服务器功能</a>和<a href="/linux120.github.io/docs/peripherals-and-interfaces#perPBAPclient">执行蓝牙 PBAP 客户端功能</a>。</p>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# obexctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Client /org/bluez/obex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;dev&gt; [uuid] [channel]                    Connect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disconnect [session]                              Disconnect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [session]                                    Session information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;session&gt;                                  Select default session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info &lt;object&gt;                                     Object information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cancel &lt;transfer&gt;                                 Cancel transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suspend &lt;transfer&gt;                                Suspend transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resume &lt;transfer&gt;                                 Resume transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;file&gt;                                       Send file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pull &lt;file&gt;                                       Pull Vobject &amp; stores in file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;path&gt;                                         Change current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls &lt;options&gt;                                      List current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source file&gt; &lt;destination file&gt;               Copy source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv &lt;source file&gt; &lt;destination file&gt;               Move source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm &lt;file&gt;                                         Delete file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;folder&gt;                                    Create folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]#</span><br></span></code></pre></div></div>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perPBAPserv">执行蓝牙 PBAP 服务器功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 PBAP 服务器功能。</p>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perPBAPclient">执行蓝牙 PBAP 客户端功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 PBAP 客户端功能。</p>
<ol start="2">
<li><strong>执行蓝牙 PBAP 服务功能</strong></li>
</ol>
<a id="perPBAPserv"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 PBAP 服务器功能。</p>
<p><strong>从服务器拉取联系人</strong></p>
<p>在开始之前，请执行以下操作：</p>
<ul>
<li>
<p>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</p>
</li>
<li>
<p>在服务器上创建 PBAP 目录。</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>在 BlueZ 堆栈中，无法直接测试或验证 PBAP 服务器功能，因为您无法在服务器上创建联系人。因此，您必须在 DUT 上创建 PBAP 目录。关于创建 PBAP 目录的更多信息，请参阅 <a href="/linux120.github.io/docs/peripherals-and-interfaces#PBAPdir">PBAP 目录示例</a>。</p>
</blockquote></div></div>
<p>要从服务器中提取联系人，请执行以下操作：</p>
<ol>
<li>
<p>从远程设备启动到 DUT 的连接。</p>
</li>
<li>
<p>接受 DUT 上的连接请求，如下所示：</p>
<ol>
<li>在 DUT 上运行 SSH。</li>
<li>通过运行以下命令打开 bluetoothctl 应用程序：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<ol start="3">
<li>验证连接请求。</li>
</ol>
</li>
<li>
<p>将预期联系人从服务器拉取至客户端。</p>
</li>
<li>
<p>在客户端上打开并验证检索到的联系人。</p>
</li>
</ol>
<p><strong>PBAP 目录示例</strong></p>
<a id="PBAPdir"></a>
<p>用户可以创建示例 PBAP 目录来验证 PBAP 服务器功能，如下所示：</p>
<ol>
<li>运行 SSH。</li>
<li>通过运行以下命令，在 telecom 处为每个电话簿存储库创建一个 <em>root</em> 文件夹：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir telecom</span><br></span></code></pre></div></div>
<ol start="3">
<li>通过运行以下命令将当前目录更改为 telecom：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd telecom</span><br></span></code></pre></div></div>
<ol start="4">
<li>在 telecom 目录中，为不同的电话簿对象创建子文件夹。
请运行以下命令，以便在 telecom 处创建子文件夹：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;subfolder&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p>subfolder 是子文件夹的名称。例如， pb。</p>
<p>对电话簿对象使用以下文件夹名称：</p>
<table><thead><tr><th>电话簿对象</th><th>文件夹名称</th></tr></thead><tbody><tr><td>主电话簿</td><td>pb</td></tr><tr><td>来电历史记录</td><td>ich</td></tr><tr><td>拨出电话历史记录</td><td>och</td></tr><tr><td>未接来电记录</td><td>mch</td></tr><tr><td>合并通话记录</td><td>cch</td></tr><tr><td>快速拨号联系人</td><td>spd</td></tr><tr><td>收藏的联系人</td><td>fav</td></tr></tbody></table>
<ol start="5">
<li>在每个子文件夹中，创建示例 VCF 文件。</li>
</ol>
<p>下图展示了一个 PBAP 目录示例。它包含两个电话簿存储库的 <em>telecom</em> 目录。在 <em>telecom</em> 目录中，有不同电话簿对象的子文件夹。VCF 文件包含在这些子文件夹中。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-135-be4a0a3445cb30d57fcacdc068899a10.jpg" width="977" height="1000" class="img_ev3q"></p>
<ol start="3">
<li><strong>执行蓝牙 PBAP 客户端功能</strong></li>
</ol>
<a id="perPBAPclient"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 PBAP 客户端功能。</p>
<p>开始之前，请按照<a href="/linux120.github.io/docs/peripherals-and-interfaces#setPBAP">设置设备的蓝牙 PBAP 功能</a>中的说明设置设备。</p>
<p><strong>连接远程设备</strong></p>
<a id="PBAPRMT"></a>
<p>要在 PBAP 中连接远程设备，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt; &lt;profile_name&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
</li>
<li>
<p><code>&lt;profile_name&gt;</code> 是 <code>pbap</code>.</p>
</li>
</ul>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>F8:7D:76:9D:9B:6B</code> 连接到远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect F8:7D:76:9D:9B:6B pbap</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# connect F8:7D:76:9D:9B:6B pbap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to F8:7D:76:9D:9B:6B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Session /org/bluez/obex/client/session1 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] PhonebookAccess /org/bluez/obex/client/session1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[F8:7D:76:9D:9B:6B]#</span><br></span></code></pre></div></div>
<p><strong>选择电话簿对象</strong></p>
<a id="selectobj"></a>
<p>要选择电话簿对象，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;phonebook_object&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>&lt;phonebook_object&gt;</code> 可以是：</p>
<ul>
<li>
<p><code>pb</code> 用于电话簿。</p>
</li>
<li>
<p><code>ich</code> 是来电历史记录。</p>
</li>
<li>
<p><code>och</code> 是去电历史记录。</p>
</li>
<li>
<p><code>mch</code> 是未接来电历史记录。</p>
</li>
<li>
<p><code>cch</code> 是来电、去电和未接来电历史记录。</p>
</li>
<li>
<p><code>spd</code> 用于快速拨号联系人。</p>
</li>
<li>
<p><code>fav</code> 用于收藏的联系人。</p>
</li>
</ul>
<p>示例</p>
<p>要选择整个电话簿，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd pb</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[F8:7D:76:9D:9B:6B]# cd pb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to Select to pb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Select successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[F8:7D:76:9D:9B:6B]#</span><br></span></code></pre></div></div>
<p><strong>提取电话簿</strong></p>
<p>要提取电话簿，请执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#PBAPRMT">连接 DUT 和远程设备</a>。</li>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectobj">选择所需的电话簿</a>。</li>
<li>通过运行以下命令来提取所需的电话簿：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source file&gt; &lt;destination file&gt;</span><br></span></code></pre></div></div>
<p>该文件存储在根目录或 <em>/var/bluetooth/</em> 目录中。</p>
<p>参数</p>
<ul>
<li>
<p><code>source file</code> 是被拉入的电话簿。</p>
</li>
<li>
<p><code>destination file</code> 是必须将电话簿拉入其中的文件。</p>
</li>
</ul>
<p>示例</p>
<p>要将 *<em>.vcf</em> 拉至 <em>contact.vcf</em>，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp *.vcf contact.vcf</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[F8:7D:76:9D:9B:6B]# cp *. vcf contact.vcf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to PullAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session2/transfer22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PullAll successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 23976 (@23KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 79920 (@55KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 130536 (@50KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 175824 (@45KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 229184 (@53KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 281052 (@51KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 336330 (@55KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 382284 (@45KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 478188 (095KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 615384 (@137KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 691974 (@76KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 740592 (@48KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 786546 (@45KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 829836 (@43KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 877122 (047KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 925074 (047KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 972360 (@47KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 1082250 (@109KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 1206126 (@123KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 1337328 (@131KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Transferred: 1347984 (@10KB/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session2/transfer22 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/client/session2/transfer22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[F8:7D:76:9D:9B:6B]#</span><br></span></code></pre></div></div>
<ol start="4">
<li>打开并验证电话簿。</li>
</ol>
<p><strong>获取电话簿大小</strong></p>
<p>要获取电话簿的大小，请执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#PBAPRMT">连接 DUT 和远程设备</a>。</li>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectobj">选择所需的电话簿</a>。</li>
<li>通过运行以下命令获取所需电话簿的大小：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to GetSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [NEW] Transfer /org/bluez/obex/client/session1/transfer4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [CHG] Transfer /org/bluez/obex/client/session1/transfer4 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 Size: 0x0006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Attempting to List</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [DEL] Transfer /org/bluez/obex/client/session1/transfer4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [NEW] Transfer /org/bluez/obex/client/session1/transfer5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          [CHG] Transfer /org/bluez/obex/client/session1/transfer5 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           0.vcf: MyContact1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          1.vcf: MyContact2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          2.vcf: MyContact3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          3.vcf: MyContact4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          4.vcf: MyContact5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          5.vcf: MyContact6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [DEL] Transfer /org/bluez/obex/client/session1/transfer5</span><br></span></code></pre></div></div>
<p><strong>搜索联系人</strong></p>
<p>要按姓名或电话号码搜索联系人，请执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#PBAPRMT">连接 DUT 和远程设备</a>。</li>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#selectobj">选择所需的电话簿</a>。</li>
<li>通过运行以下命令搜索联系人：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls &lt;name_or_number&gt;</span><br></span></code></pre></div></div>
<p>出现联系人文件。</p>
<p>参数</p>
<p><code>&lt;name_or_number&gt;</code> 是联系人姓名或电话号码。</p>
<p>示例</p>
<p>要在电话簿中搜索名为 BT 的联系人，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls BT</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ls BT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Attempting to Search</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [NEW] Transfer /org/bluez/obex/client/session1/transfer7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [CHG] Transfer /org/bluez/obex/client/session1/transfer7 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       4.vcf: MyContact5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [DEL] Transfer /org/bluez/obex/client/session1/transfer7</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="消息访问配置文件">消息访问配置文件<a href="#消息访问配置文件" class="hash-link" aria-label="Direct link to 消息访问配置文件" title="Direct link to 消息访问配置文件">​</a></h5>
<p>MAP 定义了交换消息对象的设备所使用的功能和过程。</p>
<p>要执行蓝牙 MAP 功能，用户必须首先完成以下过程中的步骤。</p>
<ol>
<li><strong>设置设备的蓝牙 MAP 功能</strong></li>
</ol>
<a id="setBTMAP"></a>
<p>前提条件</p>
<ul>
<li>
<p>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</p>
</li>
<li>
<p>将 DUT 和远程设备放置在蓝牙附近。</p>
</li>
</ul>
<p>通过运行以下命令打开蓝牙测试应用程序：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obexctl</span><br></span></code></pre></div></div>
<p>要查看 OBEX 功能，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">help</span><br></span></code></pre></div></div>
<p>该命令提供 <strong>obexctl</strong> 的主菜单。要执行 MAP 服务器和客户端功能，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#perMAPserv">执行蓝牙 MAP 服务器功能</a>和<a href="/linux120.github.io/docs/peripherals-and-interfaces#perMAPclient">执行蓝牙 MAP 客户端功能</a>。</p>
<p>示例输出</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# obexctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Client /org/bluez/obex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]# help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Menu main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;dev&gt; [uuid] [channel]                    Connect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disconnect [session]                              Disconnect session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">list                                              List available sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show [session]                                    Session information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select &lt;session&gt;                                  Select default session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info &lt;object&gt;                                     Object information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cancel &lt;transfer&gt;                                 Cancel transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">suspend &lt;transfer&gt;                                Suspend transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resume &lt;transfer&gt;                                 Resume transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;file&gt;                                       Send file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pull &lt;file&gt;                                       Pull Vobject &amp; stores in file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &lt;path&gt;                                         Change current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls &lt;options&gt;                                      List current folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp &lt;source file&gt; &lt;destination file&gt;               Copy source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv &lt;source file&gt; &lt;destination file&gt;               Move source file to destination file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm &lt;file&gt;                                         Delete file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;folder&gt;                                    Create folder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version                                           Display version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit                                              Quit program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">help                                              Display help about this program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export                                            Print environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[obex]#</span><br></span></code></pre></div></div>
<ul>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perMAPserv">执行蓝牙 MAP 服务器功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 MAP 服务器功能。</p>
</li>
<li>
<p><a href="/linux120.github.io/docs/peripherals-and-interfaces#perMAPclient">执行蓝牙 MAP 客户端功能</a>
用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 MAP 客户端功能。</p>
</li>
</ul>
<ol start="2">
<li><strong>执行蓝牙 MAP 服务器功能</strong></li>
</ol>
<a id="perMAPserv"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令验证蓝牙 MAP 服务器功能。</p>
<p><strong>拉取并阅读消息</strong></p>
<p>在开始之前，请执行以下操作：</p>
<ul>
<li>
<p>配对 DUT 和远程设备。相关说明，可参见<a href="/linux120.github.io/docs/peripherals-and-interfaces#pairRMT">与远程蓝牙设备配对</a>。</p>
</li>
<li>
<p>在服务器上创建 MAP 目录。</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>在 BlueZ 堆栈中，无法直接测试或验证 MAP 服务器功能，因为您无法在设备上发送或接收蜂窝消息。因此，您必须在 DUT 上创建一个 MAP 目录。关于创建 MAP 目录的更多信息，请参阅<a href="/linux120.github.io/docs/peripherals-and-interfaces#sampleMAPdir">示例 MAP 目录</a>。</p>
</blockquote></div></div>
<p>要从服务器拉取并读取消息，请执行以下操作：</p>
<ol>
<li>从远程设备启动到 DUT 的连接。</li>
<li>接受 DUT 上的连接请求，如下所示：<!-- -->
<ol>
<li>在 DUT 上运行 SSH。</li>
<li>通过运行以下命令打开 bluetoothctl 应用程序：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bluetoothctl</span><br></span></code></pre></div></div>
<ol start="3">
<li>验证连接请求。</li>
</ol>
</li>
<li>将预期的消息从服务器拉取至客户端。</li>
<li>在客户端打开并验证检索到的消息。</li>
</ol>
<p><strong>示例 MAP 目录</strong></p>
<a id="sampleMAPdir"></a>
<p>用户可以创建示例 MAP 目录来验证 MAP 服务器功能，如下所示：</p>
<ol>
<li>运行 SSH。</li>
<li>通过按顺序运行以下命令创建消息目录 <em>map-messages/telecom/msg</em>：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir map-messages</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd map-messages</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir telecom</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd map-messages/telecom</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir msg</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd telecom/msg</span><br></span></code></pre></div></div>
<ol start="3">
<li>在 msg 目录中，创建以下子文件夹：</li>
</ol>
<ul>
<li>inbox</li>
<li>outbox</li>
<li>sent</li>
<li>deleted</li>
<li>draft
要在 msg 处创建子文件夹，请运行以下命令：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir &lt;subfolder&gt;</span><br></span></code></pre></div></div>
<p><code>subfolder</code> 是子文件夹的名称。例如， inbox。</p>
<ol start="4">
<li>在每个子文件夹中，创建消息文件。
下图展示了一个示例 MAP 目录。在 <em>/map-messages/telecom/msg/</em> 目录中，有用于不同类型消息的子文件夹。消息包含在这些子文件夹中。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-130-da8e7ee0d99fe0ad9d35a240db7661a2.jpg" width="1000" height="530" class="img_ev3q"></p>
<ol start="3">
<li><strong>执行蓝牙 MAP 客户端功能</strong></li>
</ol>
<a id="perMAPclient"></a>
<p>用户可以使用 <strong>obexctl</strong> 主菜单中提供的命令来验证蓝牙 MAP 客户端功能。</p>
<p>开始之前，请按照<a href="/linux120.github.io/docs/peripherals-and-interfaces#setBTMAP">设置设备的蓝牙 MAP 功能</a>中的说明设置设备。</p>
<p><strong>连接远程设备</strong></p>
<a id="conrmt"></a>
<p>要在 MAP 中连接远程设备，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect &lt;bt_address&gt; &lt;profile_name&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<ul>
<li>
<p><code>&lt;bt_address&gt;</code> 是远程设备的蓝牙地址。</p>
</li>
<li>
<p><code>&lt;profile_name&gt;</code> 是 <code>map</code>.</p>
</li>
</ul>
<p>示例</p>
<p>要使用 <code>&lt;bt_address&gt;</code> <code>22:22:23:DB:F2:4A</code> 连接到远程设备，请运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">connect 22:22:23:DB:F2:4A map</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#connect 22:22:23:DB:F2:4A map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to connect to 22:22:23:DB:F2:4A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Session /org/bluez/obex/client/session23 [default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] MessageAccess /org/bluez/obex/client/session23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session23/transfer149</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection successful</span><br></span></code></pre></div></div>
<p><strong>列出文件夹中的邮件</strong></p>
<p>要列出文件夹中的消息，请执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#conrmt">连接 DUT 和远程设备</a>。</li>
<li>将当前目录更改为预期目录。</li>
</ol>
<p>示例</p>
<p>如果消息文件夹位于 <em>telecom/msg</em>，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> cd telecom/msg</span><br></span></code></pre></div></div>
<ol start="3">
<li>通过运行以下命令列出目标文件夹中的消息：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ls &lt;folder_name&gt;</span><br></span></code></pre></div></div>
<p>示例
要列出 inbox 消息，请运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ls inbox</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:23:DB:F2:4A]# ls inbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to ListMessages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session22/transfer141</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session22/transfer141 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Message /org/bluez/obex/client/session22/message288230376151711846</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Message /org/bluez/obex/client/session22/message288230376151711844</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Message /org/bluez/obex/client/session22/message288230376151711842</span><br></span></code></pre></div></div>
<p><strong>发送消息</strong></p>
<p>要发送消息，请执行以下操作：</p>
<ol>
<li><a href="/linux120.github.io/docs/peripherals-and-interfaces#conrmt">连接 DUT 和远程设备</a>。</li>
<li>将当前目录更改为发件箱目录。</li>
</ol>
<p>示例</p>
<p>要将目录更改为 <em>outbox</em>，请从 <code>obexctl</code> 菜单运行以下命令：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd outbox</span><br></span></code></pre></div></div>
<ol start="3">
<li>确保该消息存在于 <em>outbox</em> 文件夹中。如果该消息不存在，请创建一条消息。</li>
</ol>
<p>示例</p>
<p>可以创建一个名为 <em>map_file.msg</em> 的 BMSG 文件，其中包含以下内容：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:BMSG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VERSION:1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STATUS:UNREAD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TYPE:SMS_GSM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FOLDER:outbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTIFICATION:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:VCARD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VERSION:2.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N:QCOM-BTD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:VCARD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:BENV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:VCARD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VERSION:2.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N:null;;;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEL:123-456-7890</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:VCARD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:BBODY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CHARSET:UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LENGTH:50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN:MSG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello from client side</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:MSG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:BBODY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:BENV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END:BMSG</span><br></span></code></pre></div></div>
<ol start="4">
<li>通过从 obexctl 菜单运行以下命令来发送消息：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">send &lt;message_filename&gt;</span><br></span></code></pre></div></div>
<p>参数</p>
<p><code>message_filename</code> 是待发送消息的文件名。</p>
<p>示例
请运行以下命令，以便发送 <em>map_file.msg</em>：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">send map_file.msg</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[22:22:23:DB:F2:4A]# send map_file.msg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to send map_file.msg to /org/bluez/obex/client/session22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[NEW] Transfer /org/bluez/obex/client/session22/transfer147</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer /org/bluez/obex/client/session22/transfer147</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status: queued</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Size: 322</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Filename: map_file.msg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Session: /org/bluez/obex/client/session22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CHG] Transfer /org/bluez/obex/client/session22/transfer147 Status: complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[DEL] Transfer /org/bluez/obex/client/session22/transfer147</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bsa-协议栈">BSA 协议栈<a href="#bsa-协议栈" class="hash-link" aria-label="Direct link to BSA 协议栈" title="Direct link to BSA 协议栈">​</a></h4>
<ul>
<li>
<p>运行 app_manager 程序进行配对：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_manager</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-133-378eb3f2605da3e518fa93fe18edd91b.jpg" width="650" height="660" class="img_ev3q"></p>
<ol>
<li>
<p>在终端输入 2 回车后等待蓝牙扫描结果。</p>
</li>
<li>
<p>在终端输入 4 回车后输入要配对的蓝牙设备 Dev 编号再次回车。</p>
</li>
<li>
<p>根据提示在终端输入 13 回车接受配对， 对端蓝牙设备同时也要接受配对请求。</p>
</li>
</ol>
<p>app_manager 需要一直运行，下面步骤使用 <code>adb shell</code> 命令创建新终端进行。</p>
</li>
<li>
<p>蓝牙发送</p>
<p>以发送文件为例：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch ./test_file.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo RUBIKPi &gt; test_file.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_opc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输入4回车</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输入0回车</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输入设备编号回车</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 手机接收文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输入9回车退出</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="421" height="155" class="img_ev3q"></p>
</li>
<li>
<p>蓝牙接收：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输入1回车</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 手机蓝牙发送文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 传输完成后，输入9回车退出， 在./push 文件夹中查看传输的文件</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="355" height="89" class="img_ev3q"></p>
</li>
<li>
<p>其他 Demo</p>
<p>在 RUBIK Pi 3 的 <em>/usr/src/rubikpi-bt-demo/3rdparty/3rdparty/embedded/bsa_examples/linux</em> 目录下，存放了所有 蓝牙 相关的源码，可以按需要进行编译和查看，编译方法如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-bt-demo/3rdparty/3rdparty/embedded/bsa_examples/linux/&lt;测试demo&gt;/build/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ARMGCC=gcc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make CPU=arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp arm64/&lt;demo可执行文件&gt;  /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 运行demo程序</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="音频">音频<a href="#音频" class="hash-link" aria-label="Direct link to 音频" title="Direct link to 音频">​</a></h2>
<p>RUBIK Pi 3 目前支持的音接口为：</p>
<ul>
<li>
<p>3.5mm 耳机，下图4。</p>
</li>
<li>
<p>HDMI OUT， 下图9。</p>
</li>
<li>
<p>蓝牙</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-149-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看声卡信息">查看声卡信息<a href="#查看声卡信息" class="hash-link" aria-label="Direct link to 查看声卡信息" title="Direct link to 查看声卡信息">​</a></h3>
<ul>
<li>
<p>在 RUBIK Pi 3 中输入下面命令，查看声卡挂载情况：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/asound/cards</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="data:image/jpeg;base64,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" width="509" height="70" class="img_ev3q"></p>
<ul>
<li>
<p>在 RUBIK Pi 3 中输入下面命令，查看已分配的 PCM 流列表：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/asound/pcm</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-148-5725fc9ac8359461984ad503b49ea217.jpg" width="655" height="217" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="设置输出源">设置输出源<a href="#设置输出源" class="hash-link" aria-label="Direct link to 设置输出源" title="Direct link to 设置输出源">​</a></h3>
<p>在 RUBIK Pi 3 中输入下面命令，改变 gstreamer、paplay 等命令的音频输出源头：</p>
<ul>
<li>
<p>设置输出接口为 3.5mm Headset</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config audio output headset</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pactl set-sink-port low-latency0 headset</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置输出接口为 HDMI OUT</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config audio output hdmi</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pactl set-sink-port low-latency0 hdmi</span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="播放">播放<a href="#播放" class="hash-link" aria-label="Direct link to 播放" title="Direct link to 播放">​</a></h3>
<ul>
<li>
<p>在 RUBIK Pi 3 中输入下面命令测试耳机播放。 </p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>运行命令前，务必将 MP3 测试文件 (<code>&lt;FileName&gt;.mp3</code>) 推送到 <code>/opt/</code> 目录下。</p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 filesrc location=/opt/&lt;FileName&gt;.mp3 ! mpegaudioparse ! mpg123audiodec ! pulsesink</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中输入下面命令测试 HDMI OUT 播放。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>运行命令前，务必将 PCM 测试文件 (<code>&lt;FileName&gt;.wav</code>) 推送到 <code>/opt/</code> 目录下。</p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop pulseaudio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agmplay /opt/&lt;FileName&gt;.wav -D 100 -d 100 -r 48000 -b 16 -c 2 -i MI2S-LPAIF_RXTX-RX-PRIMARY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pulseaudio</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中输入下面命令测试蓝牙设备播放，测试需要开启多个终端。</p>
</li>
</ul>
<ol>
<li>终端一:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_manager</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-150-36e82e24bd36e38b46b8916dd50e5cab.jpg" width="714" height="962" class="img_ev3q"></p>
<ol start="2">
<li>终端二:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_av</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-146-6b5db0df36f08aff72c4735d7e76b332.jpg" width="602" height="567" class="img_ev3q"></p>
<p>a. 输入 2 回车，等待发现蓝牙设备。</p>
<p>b. 输入 6 回车，开始建立连接。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-242-899c0d660d1e1b4993805834a07f3105.jpg" width="650" height="610" class="img_ev3q"></p>
<p>c. 输入 1 回车，从最近的扫描结果中连接。</p>
<p>d. 输入要连接蓝牙设备的 Dev 号。</p>
<ol start="3">
<li>
<p>返回终端一，输入 13 回车，接受配对。</p>
</li>
<li>
<p>返回终端二，输入 11 回车后选择要播放的音频编号回车播放。</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="录制">录制<a href="#录制" class="hash-link" aria-label="Direct link to 录制" title="Direct link to 录制">​</a></h3>
<p>在 RUBIK Pi 3 中输入下面命令测试录音功能</p>
<ul>
<li>
<p>耳机录制:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -v pulsesrc volume=10 ! audioconvert ! wavenc ! filesink location=/opt/test.wav</span><br></span></code></pre></div></div>
</li>
<li>
<p>蓝牙耳机录制，测试需要开启多个终端：</p>
<ol>
<li>终端一:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_manager</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-147-36e82e24bd36e38b46b8916dd50e5cab.jpg" width="714" height="962" class="img_ev3q"></p>
<ol start="2">
<li>终端二:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/src/rubikpi-btapp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./app_ag</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-145-6b5db0df36f08aff72c4735d7e76b332.jpg" width="602" height="567" class="img_ev3q"></p>
<p>a. 输入 1 回车，等待发现蓝牙耳机。</p>
<p>b. 输入 6 回车，连接蓝牙耳机。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-142-899c0d660d1e1b4993805834a07f3105.jpg" width="650" height="610" class="img_ev3q"></p>
<p>c. 输入 1 回车，从最近的扫描结果中连接。</p>
<p>d. 输入要连接蓝牙设备的Dev号。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-144-b027b8d00245f4d6a6870568c657b34f.jpg" width="396" height="362" class="img_ev3q"></p>
<p>e. 返回终端一，输入13 回车，接受配对。</p>
<p>f. 返回终端二，输入 8 回车，打开 SCO 链路。</p>
<ol start="3">
<li>终端三:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop pulseaudio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#开始录制蓝牙耳机麦克风音频</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agmcap /home/root/my.wav -D 100 -d 101 -r 16000 -b 16 -c 1 -i MI2S-LPAIF_VA-TX-PRIMARY -dkv 0xA3000003 -p 120 -n 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ctrl+c结束录制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start pulseaudio</span><br></span></code></pre></div></div>
<p>录制音频的保存路径为 <em> /home/root/my.wav</em>。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="调节音量">调节音量<a href="#调节音量" class="hash-link" aria-label="Direct link to 调节音量" title="Direct link to 调节音量">​</a></h3>
<ul>
<li>
<p>耳机调节音量</p>
<p>可通过下面命令获取和设置音量:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tinymix get &quot;DAC Playback Volume&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tinymix set &quot;DAC Playback Volume&quot; 192 192</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-141-d3518da41c52daba5691a26c6625891d.jpg" width="483" height="96" class="img_ev3q"></p>
<ul>
<li>
<p>蓝牙调节音量</p>
<p>在播放蓝牙音频时，可在终端二进行音量控制</p>
<ol>
<li>
<p>输入 20</p>
</li>
<li>
<p>输入 0</p>
</li>
<li>
<p>输入音量（音量范围0到100）</p>
</li>
</ol>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-140-352b36e8f0efae716f268fc2639e8e1f.jpg" width="498" height="167" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="抓取日志">抓取日志<a href="#抓取日志" class="hash-link" aria-label="Direct link to 抓取日志" title="Direct link to 抓取日志">​</a></h3>
<ul>
<li>
<p>用户空间日志</p>
<p>要抓取用户空间日志，请执行以下操作：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /var/log/user.log</span><br></span></code></pre></div></div>
</li>
<li>
<p>内核音频驱动程序日志</p>
<p>要抓取内核日志，请执行以下操作：</p>
<ul>
<li>
<p> 内核日志</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg</span><br></span></code></pre></div></div>
</li>
<li>
<p>禁用特定文件中的内核日志：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo –n “file &lt;filename&gt; -p” &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>动态内核日志</p>
<p>默认情况下，动态日志处于禁用状态。要将其启用，请添加 <code>CONFIG_DYNAMIC_DEBUG</code> 内核配置，重新编译并重新刷写设备。</p>
<p>要启用音频动态内核日志，请执行以下操作：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@ip-addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -o rw,remount /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo –n “file &lt;filename&gt; +p” &gt; /sys/kernel/debug/dynamic_debug/control</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="分析抓取的日志">分析抓取的日志<a href="#分析抓取的日志" class="hash-link" aria-label="Direct link to 分析抓取的日志" title="Direct link to 分析抓取的日志">​</a></h3>
<p>查看用户空间日志和内核音频驱动程序日志，了解播放和录制用例。</p>
<ul>
<li>
<p>播放</p>
<p>以下日志片段描述了为播放用例收集的信息。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//Open Low latency Playback stream. Details of each stream type can be found at sources/audio/opensource/arpal-lx/inc/PalDefs.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.748280+00:00 pulseaudio: pal_stream_open: 224: Enter, stream type:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Verify the backend device, sample rate, bitwidth, channels etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.748627+00:00 pulseaudio: setDeviceMediaConfig: 1056: CODEC_DMA-LPAIF_WSA-RX-0 rate ch fmt data_fmt 48000 2 2 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Start playback stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.751947+00:00 pulseaudio: pal_stream_start: 338: Enter. Stream handle 0xffff94001040K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Map the metadata with kvh2xml.h file for playback usecase details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.853157+00:00 pulseaudio: metadata_print: 82 key:0xa1000000, value:0xa100000e//PCM_LL_PLAYBACK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.853395+00:00 pulseaudio: metadata_print: 82 key:0xab000000, value:0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.853660+00:00 pulseaudio: metadata_print: 82 key:0xa2000000, value:0xa2000001//Speaker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.853881+00:00 pulseaudio: metadata_print: 82 key:0xac000000, value:0xac000002//DEVICEPP_RX_AUDIO_MBDRC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Verify the graph opened for playback usecase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.856934+00:00 pulseaudio: print_graph_alias: 2334 GKV Alias 142 | StreamRX_PCM_LL_Playback_DeviceRX_Speaker_Instance_Instance_1_DevicePP_Rx_Audio_MBDRC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_open called</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.859509+00:00 pulseaudio: graph_open: 709 graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Configure hardware endpoint module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.864386+00:00 pulseaudio: configure_hw_ep_media_config: 636 entry mod tag c0000004 miid 43b1 mid 7001023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.864495+00:00 pulseaudio: configure_hw_ep_media_config: 664 rate 48000 bw 16 ch 2, data_fmt 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.864603+00:00 pulseaudio: configure_hw_ep_media_config: 676 exit, ret 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_start entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.867234+00:00 pulseaudio: graph_start: 899 entry graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Stream started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:08.867864+00:00 pulseaudio: pal_stream_start: 387: Exit. status 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_stop entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:25.037338+00:00 pulseaudio: graph_stop: 928 entry graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Stop the PAL stream once playback completes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:25.039923+00:00 pulseaudio: pal_stream_stop: 441: Exit. status 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_close entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:25.050944+00:00 pulseaudio: graph_close: 762 entry handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Close the PAL stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-04-28T18:02:25.054510+00:00 pulseaudio: pal_stream_close: 322: Exit. status 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>录制</p>
<p>以下日志片段描述了为录制用例收集的信息。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//Open Recording stream for PAL_STREAM_RAW. Details of stream type can be found at sources/audio/opensource/arpal-lx/inc/PalDefs.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: pal_stream_open: 224: Enter, stream type:9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Verify the backend device, sample rate, bitwidth, channels etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: setDeviceMediaConfig: 1056: CODEC_DMA-LPAIF_VA-TX-0 rate ch fmt data_fmt 48000 1 2 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Start recording stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: pal_stream_start: 338: Enter. Stream handle 0xffff6c001040K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_open entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: graph_open: 709 graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Metadata details to identify the usecase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: metadata_print: 82 key:0xb1000000, value:0xb1000009//RAW_RECORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: metadata_print: 82 key:0xa3000000, value:0xa3000004//HANDSETMIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Verify the graph opened for recording usecase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: print_graph_alias: 2334 GKV Alias 29 | DeviceTX_Handset_Mic_StreamTX_RAW_Record</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Configure hardware endpoint module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: configure_hw_ep_media_config: 636 entry mod tag c0000005 miid 43af mid 7001024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: configure_hw_ep_media_config: 664 rate 48000 bw 16 ch 1, data_fmt 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: configure_hw_ep_media_config: 676 exit, ret 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_start entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: graph_start: 899 entry graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Stream recording started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:11 pulseaudio[862]: pal_stream_start: 387: Exit. status 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_stop entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:26 pulseaudio[862]: graph_stop: 928 entry graph_handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Stop the PAL stream once user stops recording</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:26 pulseaudio[862]: D: [regular2] pal-source.c: pal_stream_stop returned 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Close the PAL stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:26 pulseaudio[862]: pal_stream_close: 284: Enter. Stream handle :0xffff6c001040K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//graph_close entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:26 pulseaudio[862]: graph_close: 762 entry handle 0x47534c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Close the PAL stream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Apr 29 09:23:26 pulseaudio[862]: pal_stream_close: 322: Exit. status 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="风扇">风扇<a href="#风扇" class="hash-link" aria-label="Direct link to 风扇" title="Direct link to 风扇">​</a></h2>
<p>与RUBIK Pi 3兼容的风扇请参考<a href="https://www.thundercomm.com/rubik-pi-3/cn/docs/peripheral-compatibility-list" target="_blank" rel="noopener noreferrer">外设兼容列表</a>。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>在一些高负载或高性能的场景下使用 RUBIK Pi 3 ，需要使用散热措施来保证设备性能稳定，否则会因为 CPU 温度过高而带来降频等性能影响。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇安装">风扇安装<a href="#风扇安装" class="hash-link" aria-label="Direct link to 风扇安装" title="Direct link to 风扇安装">​</a></h3>
<ol>
<li><strong>将散热器背面所有导热硅脂移除</strong>，将下图标记的两块硅脂按 RUBIK Pi 3 的 SoC 及 uMCP 的形状裁下。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-143-366fe97a31d0a20eba5925bf3fd8a015.jpg" width="977" height="778" class="img_ev3q"></p>
<p>两块的表面尺寸约为14*12mm和13*11.5mm。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-152-533ec0709f7bd6e4b194e4a41c48176e.jpg" width="1000" height="795" class="img_ev3q"></p>
<ol start="2">
<li>将裁剪好的两块导热硅脂贴在 RUBIK Pi 3 上对应位置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250220-095205-8f289f5e09ad63efa16dff87f75dc053.jpg" width="1000" height="648" class="img_ev3q"></p>
<ol start="3">
<li>安装散热器，连接风扇排线。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155449-340c821500d37988d4fbd77f50f87fce.jpg" width="1000" height="750" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>建议将风扇安装到 RUBIK Pi 3 上后不要将其取下。拆卸会导致风扇的推针和散热垫退化，并可能导致产品损坏。如果推针损坏或变形，或无法牢固夹住，请停止使用风扇。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇控制方法">风扇控制方法<a href="#风扇控制方法" class="hash-link" aria-label="Direct link to 风扇控制方法" title="Direct link to 风扇控制方法">​</a></h3>
<p>RUBIK Pi 3 风扇会根据当前的 CPU 温度自动调整转速，同时也可在 RUBIK Pi 3 中使用下面命令进行手动控制转速，0 和 255 分别表示风扇的最低和最高速度。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config fan speed 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config fan speed 255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config fan speed 0</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/hwmon/hwmon29/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 255 &gt;  /sys/class/hwmon/hwmon29/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt;  /sys/class/hwmon/hwmon29/pwm1</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>在将风扇转速设置为一个固定值前时，需要使用 <code>rubikpi_config thermal disable</code> 命令将 CPU 热管理关掉。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="led">LED<a href="#led" class="hash-link" aria-label="Direct link to LED" title="Direct link to LED">​</a></h2>
<p>RUBIK Pi 3 上有一个由 PMIC (Power Management IC) 驱动的 RGB 的三色灯，默认情况下其中的绿色灯被设置为了心跳灯用来反馈系统的运行情况和 CPU 负载情况）。</p>
<p>如下是 LED 灯不同状态时，所指示的状态：</p>
<ul>
<li>
<p>蓝灯长亮：fastboot 模式</p>
</li>
<li>
<p>绿色心跳：正常工作</p>
</li>
<li>
<p>红色心跳：低功耗电源插入（小于 12V  2.25A）</p>
</li>
<li>
<p>快速心跳： CPU 高负荷工作</p>
</li>
<li>
<p>停止心跳：</p>
<ul>
<li>
<p>系统死机</p>
</li>
<li>
<p>进入睡眠</p>
</li>
<li>
<p>正在开机中</p>
</li>
</ul>
</li>
</ul>
<p>可使用如下命令，操作 LED 灯：</p>
<ul>
<li>
<p>关闭心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config led heartbeat off</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo none &gt; /sys/class/leds/green/trigger </span><br></span></code></pre></div></div>
</li>
<li>
<p>开启心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config led heartbeat on</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo heartbeat &gt; /sys/class/leds/green/trigger</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置绿灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config led green 100</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/green/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置红灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config led red 100</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/red/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置蓝灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi_config led blue 100</span><br></span></code></pre></div></div>
<p>或</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/blue/brightness</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="以太网">以太网<a href="#以太网" class="hash-link" aria-label="Direct link to 以太网" title="Direct link to 以太网">​</a></h2>
<p>以太网技术旨在使用有线技术以不同的链路速度传输数据。它使用线缆在网络模型（例如局域网 (LAN) 和广域网 (WAN)）中传输数据，实现可靠、安全和更出色的网络连接。</p>
<p>以太网连接集成到 IoT 设备和传感器，使它们能够将数据传输到网络。它根据 IEEE 802.3 标准定义，可为这些设备提供用于与网关通信的标准化接口。</p>
<p>以太网接口为下图 8， RUBIK Pi 3 支持千兆以太网：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-163-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>接入网线，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155445-c2fa574a6fee2fb6734b5b5d02b9c32e.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>可在 RUBIK Pi 3 中使用下面命令查看网络连接情况，如下图所示，已经成功分配 IP，说明网络连接成功：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-162-2a3221748336f03037e755514a5a95f2.jpg" width="659" height="487" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="调试以太网">调试以太网<a href="#调试以太网" class="hash-link" aria-label="Direct link to 调试以太网" title="Direct link to 调试以太网">​</a></h3>
<p>可以使用以下日志类型来记录和调试与以太网有关的问题。</p>
<ul>
<li>
<p><code>dmesg</code>：调试与内核驱动程序相关的问题</p>
</li>
<li>
<p><code>tcpdump</code>： 验证数据包传输</p>
</li>
</ul>
<p>要调试在以太网调通期间可能出现的问题，请执行以下操作：</p>
<ol>
<li>
<p>要收集 <code>dmesg</code> 日志并调试与内核驱动程序有关的问题，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg &gt; /var/log/dmesg_logs.txt</span><br></span></code></pre></div></div>
</li>
<li>
<p>要收集 <code>tcpdump</code> 日志并验证数据包传输，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump -i any -s 0 -w /var/log/tcpdump.pcap</span><br></span></code></pre></div></div>
</li>
<li>
<p>收集来自 <code>ethtool</code>、<code>ifconfig</code>、<code>netstat</code> 和 IP 路由表的输出以进行调试。</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rtc-电池接口">RTC 电池接口<a href="#rtc-电池接口" class="hash-link" aria-label="Direct link to RTC 电池接口" title="Direct link to RTC 电池接口">​</a></h2>
<p>RTC (Real-time Clock) 电池接口为下图 1。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-159-7c0b00df38ceac4a7cff4d470bca3cbd.jpg" width="924" height="730" class="img_ev3q"></p>
<p>接入 RTC 电池， 如下图所示，并将时间写入 RUBIK Pi 3 的系统硬件时钟，可在 RUBIK Pi 3 完全断电后，仍对 RUBIK Pi 3 的系统时间进行保存。</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/20250314-155435-93ad3034de03ade5b7e1dec6b9a778f1.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>在 RUBIK Pi 3 中将系统时间写入系统硬件时钟方法如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">date -s &quot;08:00:00 20241201&quot; # 将系统时间设置为2024年12月1日8时0分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hwclock -w # 将系统时间写入系统硬件时钟</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="m2-key-m-接口">M.2 Key M 接口<a href="#m2-key-m-接口" class="hash-link" aria-label="Direct link to M.2 Key M 接口" title="Direct link to M.2 Key M 接口">​</a></h2>
<p>RUBIK Pi 3 提供一个标准 M.2 插槽，用于连接 NVMe 存储，可安装 2280 规格（22*80mm）M.2 SSD 硬盘。M.2 插槽最大支持 PCIe Gen 3 x 2。M.2 接口最大对外输出能力为 3.3V 2A，可单独控制开关。</p>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0</em></p>
<p>M.2 Key M 接口为下图 18：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-161-3c4ed5110077f3ade90d5272242520aa.jpg" width="1000" height="416" class="img_ev3q"></p>
<p>M.2 Key M 接口可以接入规格为2280的固态硬盘，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/img_v3_02h3_2bbba98e-82ca-47ed-9b20-cf96deb8e13g-ed2375f85ca402baaec1c50fa146ae76.jpg" width="1000" height="750" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/img_v3_02h3_f64471dd-11fb-46bd-ae8a-72fdf86cc65g-05587f56bfe89be7041aa84fd8324981.jpg" width="1000" height="750" class="img_ev3q"></p>
<p>目前 RUBIK Pi 3 暂未支持固态硬盘的自动挂载，可在 RUBIK Pi 3 中执行下面命令对固态硬盘手动挂载：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /opt/ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/nvme0n1 /opt/ssd</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/linux120.github.io/assets/images/image-160-b60a4f27998e9627a835dc19613609e0.jpg" width="688" height="343" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-功耗优化">PCIe 功耗优化<a href="#pcie-功耗优化" class="hash-link" aria-label="Direct link to PCIe 功耗优化" title="Direct link to PCIe 功耗优化">​</a></h3>
<p>PCIe 定义了两种功耗管理方法。</p>
<ul>
<li>
<p>功耗管理软件，用于确定每个设备的功耗管理功能并分别对各个设备进行管理</p>
</li>
<li>
<p>不需要软件干预的系统，例如主动状态功耗管理 (ASPM)</p>
</li>
</ul>
<p>当链路上未传输任何数据包时，设备会将链路置于节能状态。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-l0-链路状态">PCIe L0 链路状态<a href="#pcie-l0-链路状态" class="hash-link" aria-label="Direct link to PCIe L0 链路状态" title="Direct link to PCIe L0 链路状态">​</a></h4>
<p>PCIe 功耗管理定义下了 L0 链路状态：</p>
<ul>
<li>
<p>L0：工作状态</p>
</li>
<li>
<p>L0s：具有低恢复延迟的 ASPM 状态（节能待机状态）</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-设备状态">PCIe 设备状态<a href="#pcie-设备状态" class="hash-link" aria-label="Direct link to PCIe 设备状态" title="Direct link to PCIe 设备状态">​</a></h4>
<p>PCIe 功耗管理定义了以下设备状态：</p>
<ul>
<li>
<p>D0（必选）: 设备处于完全 ON 状态，此时存在两个子状态</p>
<ul>
<li>
<p>D0(uninitialized)：当设备退出复位状态后等待枚举和配置时，该功能处于 D0(uninitialized) 状态</p>
</li>
<li>
<p>D0(active)</p>
<ul>
<li>
<p>当完成枚举和配置过程后，该功能处于 D0(active) 状态</p>
</li>
<li>
<p>当系统软件启用一个或多个（任意组合）功能参数（如内存空间启用、I/O 空间启用、总线主启用（BME）位）时，该功能进入 D0(active) 状态</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>D1（可选）：轻度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D1 状态</p>
</li>
</ul>
</li>
<li>
<p>D2（可选）：深度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D2 状态</p>
</li>
</ul>
</li>
<li>
<p>D3（必选）：设备处于最低功耗状态，此时该功能必须支持两种 D3 状态</p>
</li>
<li>
<p>D3(hot)</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过设定功耗状态位域发出软件命令来进入 D3(hot) 状态</p>
</li>
</ul>
</li>
<li>
<p>D3(cold)：设备进入 D3(cold) 状态并断电；当恢复供电时，设备进入 D0(uninitialized) 状态</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-调试">PCIe 调试<a href="#pcie-调试" class="hash-link" aria-label="Direct link to PCIe 调试" title="Direct link to PCIe 调试">​</a></h3>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0。</em></p>
<p><code>lspci</code> 和 <code>setpci</code> 命令为 Linux 发行版的本机命令。这两条命令提供多种级别的输出，并且还可用于在某个时间点查看 PCI 总线上训练的不同组件的功能和状态。这些功能大多反映的是 PCIe 基本规范所需的配置空间寄存器。更多详细信息，可访问 <a href="https://pcisig.com/specifications" target="_blank" rel="noopener noreferrer">https://pcisig.com/specifications</a>
如需查看使用说明，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci --help</span><br></span></code></pre></div></div>
<p>以下功能有助于解决 PCIe 问题。</p>
<ul>
<li>
<p>显示设备信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0000:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000:01:00.0 USB controller: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller (rev 03)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0001:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span></code></pre></div></div>
</li>
<li>
<p>显示设备控制寄存器中的 PCIe 设备和厂商 ID。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci -nvmm</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        01:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0c03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        1912</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        0014</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rev:        03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProgIf:        30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        0001:00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTNode:        /sys/firmware/devicetree/base/soc@0/pci@1c08000/pcie@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/2.peripherals-and-interfaces.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/linux120.github.io/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tutorial Intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/linux120.github.io/docs/linux-kernel"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Linux 内核</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#硬件资源图" class="table-of-contents__link toc-highlight">硬件资源图</a></li><li><a href="#40-pin-连接器" class="table-of-contents__link toc-highlight">40 pin 连接器</a><ul><li><a href="#gpio" class="table-of-contents__link toc-highlight">GPIO</a><ul><li><a href="#引脚分布" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令控制" class="table-of-contents__link toc-highlight">使用 shell 命令控制</a></li><li><a href="#使用-wiringrp-c-控制" class="table-of-contents__link toc-highlight">使用 WiringRP (C) 控制</a></li><li><a href="#使用-wiringrp-python-控制" class="table-of-contents__link toc-highlight">使用 WiringRP-Python 控制</a></li><li><a href="#使用-python-程序控制" class="table-of-contents__link toc-highlight">使用 Python 程序控制</a></li><li><a href="#使用-c-语言程序控制" class="table-of-contents__link toc-highlight">使用 C 语言程序控制</a></li></ul></li><li><a href="#i2c" class="table-of-contents__link toc-highlight">I2C</a><ul><li><a href="#引脚分布-1" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令测试" class="table-of-contents__link toc-highlight">使用 shell 命令测试</a></li><li><a href="#使用-wiringrp-c-i2c-通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) I2C 通信</a></li><li><a href="#使用-wiringrp-python-i2c-通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python I2C 通信</a></li><li><a href="#使用-python-程序-i2c-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 I2C 通信</a></li><li><a href="#使用-c-语言程序-i2c-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 I2C 通信</a></li></ul></li><li><a href="#spi" class="table-of-contents__link toc-highlight">SPI</a><ul><li><a href="#引脚分布-2" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-wiringrp-c-spi-通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) SPI 通信</a></li><li><a href="#使用-wiringrp-python-spi通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python SPI通信</a></li><li><a href="#使用-python-程序-spi-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 SPI 通信</a></li><li><a href="#使用-c-语言程序-spi-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 SPI 通信</a></li></ul></li><li><a href="#uart" class="table-of-contents__link toc-highlight">UART</a><ul><li><a href="#引脚分布-3" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令测试-1" class="table-of-contents__link toc-highlight">使用 shell 命令测试</a></li><li><a href="#使用-wiringrp-c-uart通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) UART通信</a></li><li><a href="#使用-wiringrp-python-uart-通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python UART 通信</a></li><li><a href="#使用-python-程序-uart-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 UART 通信</a></li><li><a href="#使用-c-语言程序-uart-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 UART 通信</a></li></ul></li></ul></li><li><a href="#usb" class="table-of-contents__link toc-highlight">USB</a><ul><li><a href="#usb-20-type-a-接口" class="table-of-contents__link toc-highlight">USB 2.0 Type-A 接口</a></li><li><a href="#usb-31-type-c-接口" class="table-of-contents__link toc-highlight">USB 3.1 Type-C 接口</a></li><li><a href="#usb-调试" class="table-of-contents__link toc-highlight">USB 调试</a><ul><li><a href="#usb-跟踪" class="table-of-contents__link toc-highlight">USB 跟踪</a></li><li><a href="#usb-寄存器打印" class="table-of-contents__link toc-highlight">USB 寄存器打印</a></li><li><a href="#主机-sysfs-查询" class="table-of-contents__link toc-highlight">主机 sysfs 查询</a></li></ul></li></ul></li><li><a href="#相机串行接口csi" class="table-of-contents__link toc-highlight">相机串行接口（CSI）</a><ul><li><a href="#摄像头排线安装" class="table-of-contents__link toc-highlight">摄像头排线安装</a></li><li><a href="#摄像头使用方法" class="table-of-contents__link toc-highlight">摄像头使用方法</a></li><li><a href="#摄像头故障排除" class="table-of-contents__link toc-highlight">摄像头故障排除</a></li></ul></li><li><a href="#hdmi-out" class="table-of-contents__link toc-highlight">HDMI OUT</a><ul><li><a href="#cec" class="table-of-contents__link toc-highlight">CEC</a></li><li><a href="#hdmi-out-触摸屏" class="table-of-contents__link toc-highlight">HDMI OUT 触摸屏</a></li><li><a href="#hdmi-out-调试" class="table-of-contents__link toc-highlight">HDMI OUT 调试</a><ul><li><a href="#获取-lt9611-日志" class="table-of-contents__link toc-highlight">获取 LT9611 日志</a></li><li><a href="#获取-dsi-日志" class="table-of-contents__link toc-highlight">获取 DSI 日志</a></li><li><a href="#获取显示面板信息" class="table-of-contents__link toc-highlight">获取显示面板信息</a></li><li><a href="#获取-dsi-时钟信息" class="table-of-contents__link toc-highlight">获取 DSI 时钟信息</a></li><li><a href="#获取调压器信息" class="table-of-contents__link toc-highlight">获取调压器信息</a></li><li><a href="#获取接口信息" class="table-of-contents__link toc-highlight">获取接口信息</a></li><li><a href="#获取常规-dpu-调试信息" class="table-of-contents__link toc-highlight">获取常规 DPU 调试信息</a></li></ul></li></ul></li><li><a href="#displayport" class="table-of-contents__link toc-highlight">DisplayPort</a><ul><li><a href="#dp-调试" class="table-of-contents__link toc-highlight">DP 调试</a><ul><li><a href="#获取-dp-日志" class="table-of-contents__link toc-highlight">获取 DP 日志</a></li></ul></li></ul></li><li><a href="#wi-fi--蓝牙" class="table-of-contents__link toc-highlight">Wi-Fi &amp; 蓝牙</a><ul><li><a href="#wi-fi" class="table-of-contents__link toc-highlight">Wi-Fi</a><ul><li><a href="#工作频段" class="table-of-contents__link toc-highlight">工作频段</a></li><li><a href="#工作模式" class="table-of-contents__link toc-highlight">工作模式</a></li></ul></li><li><a href="#蓝牙" class="table-of-contents__link toc-highlight">蓝牙</a><ul><li><a href="#bluez-协议栈" class="table-of-contents__link toc-highlight">BlueZ 协议栈</a></li><li><a href="#bsa-协议栈" class="table-of-contents__link toc-highlight">BSA 协议栈</a></li></ul></li></ul></li><li><a href="#音频" class="table-of-contents__link toc-highlight">音频</a><ul><li><a href="#查看声卡信息" class="table-of-contents__link toc-highlight">查看声卡信息</a></li><li><a href="#设置输出源" class="table-of-contents__link toc-highlight">设置输出源</a></li><li><a href="#播放" class="table-of-contents__link toc-highlight">播放</a></li><li><a href="#录制" class="table-of-contents__link toc-highlight">录制</a></li><li><a href="#调节音量" class="table-of-contents__link toc-highlight">调节音量</a></li><li><a href="#抓取日志" class="table-of-contents__link toc-highlight">抓取日志</a></li><li><a href="#分析抓取的日志" class="table-of-contents__link toc-highlight">分析抓取的日志</a></li></ul></li><li><a href="#风扇" class="table-of-contents__link toc-highlight">风扇</a><ul><li><a href="#风扇安装" class="table-of-contents__link toc-highlight">风扇安装</a></li><li><a href="#风扇控制方法" class="table-of-contents__link toc-highlight">风扇控制方法</a></li></ul></li><li><a href="#led" class="table-of-contents__link toc-highlight">LED</a></li><li><a href="#以太网" class="table-of-contents__link toc-highlight">以太网</a><ul><li><a href="#调试以太网" class="table-of-contents__link toc-highlight">调试以太网</a></li></ul></li><li><a href="#rtc-电池接口" class="table-of-contents__link toc-highlight">RTC 电池接口</a></li><li><a href="#m2-key-m-接口" class="table-of-contents__link toc-highlight">M.2 Key M 接口</a><ul><li><a href="#pcie-功耗优化" class="table-of-contents__link toc-highlight">PCIe 功耗优化</a><ul><li><a href="#pcie-l0-链路状态" class="table-of-contents__link toc-highlight">PCIe L0 链路状态</a></li><li><a href="#pcie-设备状态" class="table-of-contents__link toc-highlight">PCIe 设备状态</a></li></ul></li><li><a href="#pcie-调试" class="table-of-contents__link toc-highlight">PCIe 调试</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/linux120.github.io/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/linux120.github.io/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>